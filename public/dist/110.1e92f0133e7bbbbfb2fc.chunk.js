webpackJsonp([110,213],{1650:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(239),o=n(i),r=a(601),s=n(r);e.default={name:"rebatePromotion-list",components:{orderTable:s.default},data:function(){var t=this;return{beginDate:"",endDate:"",promotionCode:"",status:"",title:"",barCode:"",code79:"",itemName:"",cityList:[{value:"",label:"请选择"},{value:"1",label:"未生效"},{value:"2",label:"生效中"},{value:"3",label:"已失效"},{value:"4",label:"已下架"}],loading:!1,tableRef:"",columnsList:[{type:"selection",width:60,align:"center",fixed:"left"},{title:"序号",type:"index",align:"center",width:62},{title:"促销编码",key:"promotionCode",align:"center"},{title:"促销名称",key:"title",align:"center"},{title:"促销类型",key:"type",align:"center",render:function(t,e){return t("div",{},"返利")}},{title:"开始时间",key:"beginDate",align:"center",width:155,render:function(e,a){return e("div",{},t.timestampToTime(a.row.beginDate))}},{title:"结束时间",key:"endDate",align:"center",width:155,render:function(e,a){return e("div",{},t.timestampToTime(a.row.endDate))}},{title:"促销状态",key:"status",align:"center",render:function(e,a){return e("div",t.cityList[a.row.status].label)}},{title:"操作",key:"handel",width:180,align:"center",render:function(e,a){var n=[e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.$router.push({path:"rebatePromotion-detail",query:{id:a.row.id}})}}},"查看")],i="";return 4==a.row.status?i="上架":2==a.row.status&&(i="下架"),4!=a.row.status&&2!=a.row.status||n.unshift(e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){2==a.row.status?t.changeType="下架":4==a.row.status&&(t.changeType="上架"),t.currentId=a.row.id,t.getStatus=a.row.status,t.MoadlShow(a.row.status)}}},i)),1==a.row.status&&n.unshift(e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.$router.push({path:"rebatePromotion-edit",query:{id:a.row.id,editPage:t.current}})}}},"编辑"),e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.changeType="删除",t.currentId=a.row.id,t.getStatus=a.row.status,t.getSelectId=[],t.getSelectId=[a.row.id],t.MoadlShow(a.row.status)}}},"删除")),e("div",n)}}],thisTableData:[],totalCount:0,current:1,changeModal:!1,changeType:"",currentId:"",getStatus:"",createDateOptions:{disabledDate:function(e){return e&&e.valueOf()+864e5-1<new Date(t.beginDate)}},getSelectId:[],tableShow:!0}},methods:{initNumber:function(t,e){var a=t.target.value;/^[A-Z|a-z|_|0-9]*$/.test(a)?(this[e]=a,setTimeout(function(e){return t.target.value=a})):(this[e]="",setTimeout(function(e){return t.target.value=""}))},query:function(t){var e=this;this.current=t;var a=""==this.beginDate?this.beginDate:this.beginDate+" 00:00:00",n=""==this.endDate?this.endDate:this.endDate+" 00:00:00",i={page:t,beginDate:a,endDate:n,promotionCode:this.promotionCode,status:this.status,code79:this.code79,barCode:this.barCode,itemName:this.itemName,title:this.title};e.loading=!0,this.$util.ajax({method:"post",url:e.$util.apiConfig.promotionManage.warProgramme.rebatePromotion.listUrl,data:o.default.stringify(i)}).then(function(t){if(e.loading=!1,e.thisTableData=[],e.getSelectId=[],e.tableShow=!1,setTimeout(function(t){e.tableShow=!0}),null!=t.data.result.pager.records){var a=t.data.result.pager.records;for(var n in a)1!=a[n].status&&(a[n]._disabled=!0),e.thisTableData.push(a[n]);e.totalCount=t.data.result.pager.totalCount}}).catch(function(t){e.loading=!1,console.log("失败信息：",t)})},MoadlShow:function(t){this.changeModal=!0},checkId:function(){var t=this;this.$util.ajax({method:"post",url:t.$util.apiConfig.promotionManage.warProgramme.checkGoodsList,data:{promotionInfoDTO:{id:t.currentId}}}).then(function(e){200==e.data.code?t.changeModal=!0:t.$Modal.error({title:"提示",content:e.data.message})}).catch(function(t){console.log("失败信息：",t)})},handelStatus:function(){var t=this;if(1==t.getStatus)return void this.delData();var e="";4==t.getStatus&&(e=2),2==t.getStatus&&(e=4),this.$util.ajax({method:"post",url:t.$util.apiConfig.promotionManage.warProgramme.updatePromotionStatus,data:o.default.stringify({id:t.currentId,status:e})}).then(function(e){200==e.data.code?(t.query(t.current),t.$Modal.success({title:"提示",content:"修改成功"})):t.$Modal.error({title:"提示",content:""|e.data.message})}).catch(function(t){console.log("失败信息：",t)})},startTime:function(t){this.beginDate=t+" 00:00:00"},endTime:function(t){this.endDate=t+" 00:00:00"},newPage:function(){delete window.sessionStorage.rebatePromotionEditParams,this.$router.push({path:"rebatePromotion-edit",query:{isFromCreate:"1"}})},timestampToTime:function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},createSTimeChangeHandle:function(t){this.beginDate=t,this.beginDate>this.endDate&&(this.endDate="")},createETimeChangeHandle:function(t){this.endDate=t},delData:function(){var t=this;this.$util.ajax({method:"post",url:t.$util.apiConfig.promotionManage.warProgramme.delDataUrl,data:this.getSelectId}).then(function(e){"200"==e.data.code?(t.query(t.current),t.$Modal.success({title:"提示",content:"删除成功"})):t.$Modal.error({title:"提示",content:e.data.message})}).catch(function(t){console.log(t)})},getSelection:function(t){this.getSelectId=[];for(var e in t)this.getSelectId.push(t[e].id)},batchDel:function(){if(0==this.getSelectId.length)return void this.$Modal.error({title:"提示",content:"请先勾选数据！"});this.getStatus=1,this.changeType="删除",this.MoadlShow()},reset:function(){this.beginDate="",this.endDate="",this.promotionCode="",this.status="",this.title="",this.current=1,this.barCode="",this.code79="",this.itemName="",this.query(1)}},mounted:function(){this.query(1)},beforeRouteEnter:function(t,e,a){a(function(t){"rebatePromotion-detail"==e.name&&(t.$route.query.isFromCreate&&t.reset(),t.$route.query.editPage&&t.query(t.$route.query.editPage))})},beforeRouteLeave:function(t,e,a){(this.$util.cache.fromArr.includes(t.name)&&this.$util.cache.fromArr.includes(e.name)||!this.$util.cache.toArr.includes(t.name)&&this.$util.cache.fromArr.includes(e.name))&&this.reset(),a()}}},2215:function(t,e,a){var n=a(2216);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(43)("a6ab64c6",n,!1,{})},2216:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.ListName[data-v-df3db7ba]{\n    text-align: right;\n    line-height: 32px;\n    color: #747474;\n    font-size: 12px;\n    margin-right:8px;\n}\n",""])},2217:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"auto",background:"#fff"}},[a("Row",{staticStyle:{padding:"20px","border-bottom":"1px dashed #e5e5e5"}},[a("row",{staticStyle:{"margin-bottom":"14px"}},[a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("促销编码 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{value:t.promotionCode,clearable:""},on:{"on-change":function(e){return t.initNumber(e,"promotionCode")}}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("促销名称 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("促销状态 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Select",{staticStyle:{width:"100%"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.cityList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)],1)],1),t._v(" "),a("row",{staticStyle:{"margin-bottom":"14px"}},[a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("销售编码 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{value:t.code79,maxlength:18,clearable:""},on:{"on-change":function(e){return t.initNumber(e,"code79")}}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("条形码 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{clearable:"",maxlength:18},on:{"on-change":function(e){return t.initNumber(e,"barCode")}},model:{value:t.barCode,callback:function(e){t.barCode=e},expression:"barCode"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("商品名称 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{maxlength:18,clearable:""},model:{value:t.itemName,callback:function(e){t.itemName=e},expression:"itemName"}})],1)],1)],1),t._v(" "),a("row",{staticStyle:{"margin-bottom":"14px"}},[a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("开始时间 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",value:t.beginDate,placeholder:"请选择时间"},on:{"on-change":t.createSTimeChangeHandle}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("结束时间 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",value:t.endDate,options:t.createDateOptions,placeholder:"请选择时间"},on:{"on-change":t.createETimeChangeHandle}})],1)],1)],1),t._v(" "),a("row",{staticStyle:{"margin-bottom":"12px"}},[a("Col",{attrs:{span:"24"}},[a("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){t.query(1)}}},[t._v("查询")])],1)],1)],1),t._v(" "),a("row",{staticStyle:{padding:"20px"}},[a("row",{staticStyle:{"margin-bottom":"12px"}},[a("Col",{attrs:{span:"24"}},[a("Button",{staticStyle:{float:"right","margin-left":"20px"},attrs:{type:"primary"},on:{click:function(e){t.batchDel()}}},[t._v("删除")]),t._v(" "),a("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.newPage}},[t._v("新建")])],1)],1),t._v(" "),t.tableShow?a("order-table",{attrs:{refs:t.tableRef,columnsList:t.columnsList,thisTableData:t.thisTableData,loading:t.loading},on:{listenCheckbox:t.getSelection}}):t._e()],1),t._v(" "),a("div",{staticStyle:{padding:"20px",overflow:"hidden"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:t.totalCount,"page-size":10,current:t.current,"show-total":"","show-elevator":""},on:{"on-change":t.query}})],1),t._v(" "),a("Modal",{attrs:{title:"提示"},on:{"on-ok":t.handelStatus},model:{value:t.changeModal,callback:function(e){t.changeModal=e},expression:"changeModal"}},[a("p",[t._v("您确定要"+t._s(t.changeType)+"吗？")])])],1)},i=[];n._withStripped=!0;var o={render:n,staticRenderFns:i};e.default=o},601:function(t,e,a){"use strict";function n(t){u||a(900)}Object.defineProperty(e,"__esModule",{value:!0});var i=a(891),o=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);var s=a(902),l=a.n(s),u=!1,c=a(13),d=n,h=c(o.a,l.a,!1,d,null,null);h.options.__file="src/views/tables/components/orderTable.vue",e.default=h.exports},767:function(t,e,a){"use strict";function n(t){u||a(2215)}Object.defineProperty(e,"__esModule",{value:!0});var i=a(1650),o=a.n(i);for(var r in i)"default"!==r&&function(t){a.d(e,t,function(){return i[t]})}(r);var s=a(2217),l=a.n(s),u=!1,c=a(13),d=n,h=c(o.a,l.a,!1,d,"data-v-df3db7ba",null);h.options.__file="src/views/promotion-manage/war-programme/rebate-promotion/rebatePromotion-list.vue",e.default=h.exports},891:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"orderTable",props:{columnsList:Array,thisTableData:Array,getHeight:Number,loading:{type:Boolean,default:!0}},data:function(){return{}},created:function(){this.init()},methods:{init:function(){var t=this;this.columnsList.forEach(function(e){"address1"==e.key&&(e.render=function(e,a){return e("Row",{props:{type:"flex",align:"middle",justify:"center"}},[e("Col",{props:{span:"22"}},a.row.name),e("Col",{props:{span:"2"}},[e("Button",{props:{type:"text",icon:"edit"},on:{click:function(e){t.$emit("showLayer","true")}}})])])})})},a:function(t){this.$emit("listenCheckbox",t)}},watch:{}}},900:function(t,e,a){var n=a(901);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(43)("296919d0",n,!1,{})},901:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.show-edit-btn {\n  display: none;\n  margin-left: -10px;\n}\n.ivu-table-cell:hover .show-edit-btn {\n  display: inline-block;\n}\n",""])},902:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Table",{attrs:{height:t.getHeight,columns:t.columnsList,data:t.thisTableData,stripe:"",border:"",loading:t.loading},on:{"on-selection-change":t.a}})],1)},i=[];n._withStripped=!0;var o={render:n,staticRenderFns:i};e.default=o}});