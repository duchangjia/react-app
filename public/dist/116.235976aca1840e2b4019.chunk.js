webpackJsonp([116,213],{1623:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(101),o=r(n),i=a(239),s=r(i),l=a(601),u=r(l);e.default={name:"groupBuy-list",components:{orderTable:u.default},data:function(){var t=this;return{queryArry:{beginTimeStr:"",endTimeStr:"",groupCode:"",status:"",groupName:"",page:1,spuCode:"",code69:"",itemName:""},cityList:[{value:"",label:"请选择"},{value:"0",label:"生效中"},{value:"1",label:"已下架"},{value:"2",label:"未生效"},{value:"3",label:"已失效"}],modal:!1,tableRef:"",tableRef2:"",loading:!1,columnsList:[{type:"selection",width:60,align:"center",fixed:"left"},{title:"序号",type:"index",align:"center",width:70},{title:"促销编码",key:"groupCode",align:"center",width:136},{title:"促销名称",key:"groupName",align:"center"},{title:"销售价(EA)",key:"marketPrice",align:"center",width:120,render:function(t,e){return t("div",e.row.marketPrice?e.row.marketPrice.toFixed(2):"0.00")}},{title:"开始时间",key:"beginTime",align:"center",width:155,render:function(e,a){return e("div",{},t.formatDateTime(a.row.beginTime,"lalala"))}},{title:"结束时间",key:"endTime",align:"center",width:155,render:function(e,a){return e("div",{},t.formatDateTime(a.row.endTime,"lalala"))}},{title:"促销状态",key:"status",align:"center",width:100,render:function(e,a){return e("div",t.cityList[a.row.status+1].label)}},{title:"操作",key:"handel",width:180,align:"center",render:function(e,a){var r=[e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){sessionStorage.removeItem("groupPromotionEditParams"),t.$router.push({path:"groupGoods-detail",query:{id:a.row.id}})}}},"查看")],n="";return 0==a.row.status?n="下架":1==a.row.status&&(n="上架"),0!=a.row.status&&1!=a.row.status||r.unshift(e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){0==a.row.status?t.changeType="下架":1==a.row.status&&(t.changeType="上架"),t.currentId=a.row.id,t.MoadlShow(a.row.status)}}},n)),2==a.row.status&&r.unshift(e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){sessionStorage.removeItem("groupPromotionEditParams"),t.$router.push({path:"groupGoods-edit",query:{id:a.row.id}})}}},"编辑"),e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.changeType="删除",t.currentId=a.row.id,t.getSelectId=[],t.getSelectId.push(a.row.id),t.MoadlShow(a.row.status)}}},"删除")),e("div",r)}}],thisTableData:[],totalCount:0,changeModal:!1,changeType:"",currentId:"",createDateOptions:{disabledDate:function(e){return e&&e.valueOf()+864e5-1<new Date(t.queryArry.beginTimeStr)}},getSelectId:[],tableShow:!0}},methods:{initNumber:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"queryArray",r=t.target.value,n=/^[A-Z|a-z|_|0-9]*$/;console.log(!n.test(r)),n.test(r)?(this[a][e]=r,setTimeout(function(e){return t.target.value=r})):(this[a][e]="",setTimeout(function(e){return t.target.value=""}))},goBuild:function(){sessionStorage.removeItem("groupPromotionEditParams"),this.$router.push({path:"groupGoods-edit"})},onQuery:function(){this.query(1)},query:function(t){var e=this;e.loading=!0,this.queryArry.page=t,this.$util.ajax({method:"post",url:e.$util.apiConfig.promotionManage.warProgramme.groupGoods.listUrl,data:s.default.stringify(this.queryArry)}).then(function(t){if(e.loading=!1,"200"==t.data.code){e.getSelectId=[],e.tableShow=!1,setTimeout(function(t){e.tableShow=!0}),e.thisTableData=[],""==t.data.result.pager.records&&(t.data.result.pager.records=[]);var a=t.data.result.pager.records;for(var r in a)2!=a[r].status&&(a[r]._disabled=!0),e.thisTableData.push(a[r]);e.totalCount=t.data.result.pager.totalCount}else e.$Modal.error({title:"提示",content:t.data.message})}).catch(function(t){e.loading=!1,console.log(t)})},formatDateTime:function(t,e){if(!t)return"";var a=new Date(t),r=a.getFullYear(),n=a.getMonth()+1;n=n<10?"0"+n:n;var o=a.getDate();o=o<10?"0"+o:o;var i=a.getHours();if(i=i<10?"0"+i:i,e){var s=a.getMinutes(),l=a.getSeconds();return s=s<10?"0"+s:s,l=l<10?"0"+l:l,r+"-"+n+"-"+o+" "+i+":"+s+":"+l}return r+"-"+n+"-"+o},MoadlShow:function(t){this.changeModal=!0},checkId:function(){var t=this;this.$util.ajax({method:"post",url:t.$util.apiConfig.promotionManage.warProgramme.groupGoods.checkGroupGoodsList,data:{id:t.currentId}}).then(function(e){200==e.data.code?t.changeModal=!0:t.$Modal.error({title:"提示",content:e.data.message})}).catch(function(t){console.log("失败信息：",t)})},handelStatus:function(){var t=this;if("删除"==t.changeType)return void t.delData();var e="";"上架"==t.changeType?e=t.$util.apiConfig.promotionManage.warProgramme.groupGoods.changeStatus:"下架"==t.changeType&&(e=t.$util.apiConfig.promotionManage.warProgramme.groupGoods.changeStatus1),this.$util.ajax({method:"get",url:e+"?id="+t.currentId,data:""}).then(function(e){200==e.data.code?(t.query(t.queryArry.page),t.$Modal.success({title:"提示",content:"修改成功"})):t.$Modal.error({title:"提示",content:e.data.message})}).catch(function(t){console.log("失败信息：",t)})},createSTimeChangeHandle:function(t){this.queryArry.beginTimeStr=t,this.queryArry.beginTimeStr>this.queryArry.endTimeStr&&(this.queryArry.endTimeStr="")},createETimeChangeHandle:function(t){this.queryArry.endTimeStr=t},delData:function(){var t=this;this.$util.ajax({method:"post",url:t.$util.apiConfig.promotionManage.warProgramme.groupGoods.delUrl,data:this.getSelectId}).then(function(e){"200"==e.data.code?(t.query(t.queryArry.page),t.$Modal.success({title:"提示",content:"删除成功"})):t.$Modal.error({title:"提示",content:e.data.message})}).catch(function(t){console.log(t)})},getSelection:function(t){this.getSelectId=[];for(var e in t)this.getSelectId.push(t[e].id)},batchDel:function(){if(0==this.getSelectId.length)return void this.$Modal.error({title:"提示",content:"请先勾选数据！"});this.changeType="删除",this.MoadlShow()},reset:function(){this.queryArry=(0,o.default)(this.queryArry,{beginTimeStr:"",endTimeStr:"",groupCode:"",status:"",groupName:"",page:1,spuCode:"",code69:"",itemName:""}),this.query(1)}},mounted:function(){this.query(1)},beforeRouteEnter:function(t,e,a){a(function(t){"groupGoods-detail"!=e.name||e.query.id||t.reset()})},beforeRouteLeave:function(t,e,a){(this.$util.cache.fromArr.includes(t.name)&&this.$util.cache.fromArr.includes(e.name)||!this.$util.cache.toArr.includes(t.name)&&this.$util.cache.fromArr.includes(e.name))&&this.reset(),a()}}},2126:function(t,e,a){var r=a(2127);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(43)("2d2eef98",r,!1,{})},2127:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.ListName[data-v-71620e4f]{\n    text-align: right;\n    line-height: 32px;\n    color: #747474;\n    font-size: 12px;\n    margin-right:8px;\n}\n.listmb[data-v-71620e4f]{\n    margin-bottom: 20px;\n}\n",""])},2128:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"auto",background:"#fff"}},[a("Row",{staticStyle:{padding:"40px 20px 20px","border-bottom":"1px dashed #e5e5e5"}},[a("row",{staticStyle:{"margin-bottom":"14px"}},[a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("组合商品编码 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{value:t.queryArry.groupCode,placeholder:"",clearable:""},on:{"on-change":function(e){return t.initNumber(e,"groupCode","queryArry")}}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("组合商品名称 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"",clearable:""},model:{value:t.queryArry.groupName,callback:function(e){t.$set(t.queryArry,"groupName",e)},expression:"queryArry.groupName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("组合商品状态 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:t.queryArry.status,callback:function(e){t.$set(t.queryArry,"status",e)},expression:"queryArry.status"}},t._l(t.cityList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)],1)],1),t._v(" "),a("row",{staticStyle:{"margin-bottom":"14px"}},[a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("销售编码 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{value:t.queryArry.spuCode,clearable:""},on:{"on-change":function(e){return t.initNumber(e,"spuCode","queryArry")}}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("条形码 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{clearable:""},on:{"on-change":function(e){return t.initNumber(e,"code69","queryArry")}},model:{value:t.queryArry.code69,callback:function(e){t.$set(t.queryArry,"code69",e)},expression:"queryArry.code69"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("商品名称 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("Input",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:t.queryArry.itemName,callback:function(e){t.$set(t.queryArry,"itemName",e)},expression:"queryArry.itemName"}})],1)],1)],1),t._v(" "),a("row",{staticStyle:{"margin-bottom":"14px"}},[a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("开始时间 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",value:t.queryArry.beginTimeStr,placeholder:"请选择时间"},on:{"on-change":t.createSTimeChangeHandle}})],1)],1),t._v(" "),a("Col",{attrs:{span:"7"}},[a("Col",{staticClass:"ListName",attrs:{span:"8"}},[t._v("结束时间 :")]),t._v(" "),a("Col",{attrs:{span:"15"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",value:t.queryArry.endTimeStr,options:t.createDateOptions,placeholder:"请选择时间"},on:{"on-change":t.createETimeChangeHandle}})],1)],1)],1),t._v(" "),a("row",{staticStyle:{"margin-bottom":"12px"}},[a("Col",{attrs:{span:"24"}},[a("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.onQuery}},[t._v("查询")])],1)],1)],1),t._v(" "),a("row",{staticStyle:{padding:"20px"}},[a("row",{staticStyle:{"margin-bottom":"12px"}},[a("Col",{attrs:{span:"24"}},[a("Button",{staticStyle:{float:"right","margin-left":"20px"},attrs:{type:"primary"},on:{click:function(e){t.batchDel()}}},[t._v("删除")]),t._v(" "),a("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){t.goBuild()}}},[t._v("新建")])],1)],1),t._v(" "),t.tableShow?a("order-table",{attrs:{refs:t.tableRef,columnsList:t.columnsList,thisTableData:t.thisTableData,loading:t.loading},on:{listenCheckbox:t.getSelection}}):t._e()],1),t._v(" "),a("div",{staticStyle:{padding:"20px",overflow:"hidden"}},[a("Page",{staticStyle:{float:"right"},attrs:{total:t.totalCount,"page-size":10,current:t.queryArry.page,"show-total":"","show-elevator":""},on:{"on-change":t.query}})],1),t._v(" "),a("Modal",{attrs:{title:"提示"},on:{"on-ok":t.handelStatus},model:{value:t.changeModal,callback:function(e){t.changeModal=e},expression:"changeModal"}},[a("p",[t._v("您确定要"+t._s(t.changeType)+"吗？")])])],1)},n=[];r._withStripped=!0;var o={render:r,staticRenderFns:n};e.default=o},601:function(t,e,a){"use strict";function r(t){u||a(900)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(891),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);var s=a(902),l=a.n(s),u=!1,c=a(13),d=r,p=c(o.a,l.a,!1,d,null,null);p.options.__file="src/views/tables/components/orderTable.vue",e.default=p.exports},741:function(t,e,a){"use strict";function r(t){u||a(2126)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(1623),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);var s=a(2128),l=a.n(s),u=!1,c=a(13),d=r,p=c(o.a,l.a,!1,d,"data-v-71620e4f",null);p.options.__file="src/views/promotion-manage/war-programme/group-goods/groupGoods-list.vue",e.default=p.exports},891:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"orderTable",props:{columnsList:Array,thisTableData:Array,getHeight:Number,loading:{type:Boolean,default:!0}},data:function(){return{}},created:function(){this.init()},methods:{init:function(){var t=this;this.columnsList.forEach(function(e){"address1"==e.key&&(e.render=function(e,a){return e("Row",{props:{type:"flex",align:"middle",justify:"center"}},[e("Col",{props:{span:"22"}},a.row.name),e("Col",{props:{span:"2"}},[e("Button",{props:{type:"text",icon:"edit"},on:{click:function(e){t.$emit("showLayer","true")}}})])])})})},a:function(t){this.$emit("listenCheckbox",t)}},watch:{}}},900:function(t,e,a){var r=a(901);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(43)("296919d0",r,!1,{})},901:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.show-edit-btn {\n  display: none;\n  margin-left: -10px;\n}\n.ivu-table-cell:hover .show-edit-btn {\n  display: inline-block;\n}\n",""])},902:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Table",{attrs:{height:t.getHeight,columns:t.columnsList,data:t.thisTableData,stripe:"",border:"",loading:t.loading},on:{"on-selection-change":t.a}})],1)},n=[];r._withStripped=!0;var o={render:r,staticRenderFns:n};e.default=o}});