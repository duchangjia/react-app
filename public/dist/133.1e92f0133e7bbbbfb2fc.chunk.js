webpackJsonp([133,215],{1010:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e(65),a=function(t){return t&&t.__esModule?t:{default:t}}(i),o=function(t,n,e,i){return n("Button",{props:{type:e.editting?"success":"primary",loading:e.saving,size:"small"},on:{click:function(){if(e.editting){t.edittingStore[i].saving=!0,t.thisTableData=JSON.parse((0,a.default)(t.edittingStore));var n=t.edittingStore[i];n.editting=!1,n.saving=!1,t.thisTableData=JSON.parse((0,a.default)(t.edittingStore)),t.$emit("input",t.handleBackdata(t.thisTableData)),t.$emit("on-change",t.handleBackdata(t.thisTableData),i)}else{if(e.edittingCell)for(var o in e.edittingCell)e.edittingCell[o]=!1,t.edittingStore[i].edittingCell[o]=!1;t.edittingStore[i].editting=!0,t.thisTableData=JSON.parse((0,a.default)(t.edittingStore))}}}},e.editting?"保存":"编辑")},r=function(t,n,e,i){return n("Poptip",{props:{confirm:!0,title:"您确定要删除这条数据吗?",transfer:!0},style:{marginBottom:"5px"},on:{"on-ok":function(){t.thisTableData.splice(i,1),t.$emit("input",t.handleBackdata(t.thisTableData)),t.$emit("on-delete",t.handleBackdata(t.thisTableData),i)}}},[n("Button",{style:{margin:"0 5px"},props:{type:"error",placement:"top",size:"small"}},"删除")])},l=function(t,n,e){return t.hoverShow?n("div",{class:{"show-edit-btn":t.hoverShow}},[n("Button",{props:{type:"text",icon:"edit"},on:{click:function(n){t.edittingStore[e.index].edittingCell[e.column.key]=!0,t.thisTableData=JSON.parse((0,a.default)(t.edittingStore))}}})]):n("Button",{props:{type:"text",icon:"edit"},on:{click:function(n){t.edittingStore[e.index].edittingCell[e.column.key]=!0,t.thisTableData=JSON.parse((0,a.default)(t.edittingStore))}}})},d=function(t,n,e){return n("Button",{props:{type:"text",icon:"checkmark"},on:{click:function(n){t.edittingStore[e.index].edittingCell[e.column.key]=!1,t.thisTableData=JSON.parse((0,a.default)(t.edittingStore)),t.$emit("input",t.handleBackdata(t.thisTableData)),t.$emit("on-cell-change",t.handleBackdata(t.thisTableData),e.index,e.column.key)}}})},s=function(t,n,e,i){return n("Input",{props:{type:"text",value:t.edittingStore[e.index][i.key]},on:{"on-change":function(n){var a=i.key;t.edittingStore[e.index][a]=n.target.value}}})};n.default={name:"canEditTable",props:{refs:String,columnsList:Array,value:Array,url:String,editIncell:{type:Boolean,default:!1},hoverShow:{type:Boolean,default:!1}},data:function(){return{columns:[],thisTableData:[],edittingStore:[]}},created:function(){this.init()},methods:{init:function(){var t=this,n=this,e=this.columnsList.filter(function(t){if(t.editable&&!0===t.editable)return t}),i=JSON.parse((0,a.default)(this.value)),c=[];c=i.map(function(n,i){var a=!1;if(t.thisTableData[i])if(t.thisTableData[i].editting)a=!0;else for(var o in t.thisTableData[i].edittingCell)!0===t.thisTableData[i].edittingCell[o]&&(a=!0);if(a)return t.thisTableData[i];t.$set(n,"editting",!1);var r={};return e.forEach(function(t){r[t.key]=!1}),t.$set(n,"edittingCell",r),n}),this.thisTableData=c,this.edittingStore=JSON.parse((0,a.default)(this.thisTableData)),this.columnsList.forEach(function(e){e.editable&&(e.render=function(i,a){var o=t.thisTableData[a.index];return o.editting?i("Input",{props:{type:"text",value:o[e.key]},on:{"on-change":function(t){var e=a.column.key;n.edittingStore[a.index][e]=t.target.value}}}):t.editIncell?i("Row",{props:{type:"flex",align:"middle",justify:"center"}},[i("Col",{props:{span:"22"}},[o.edittingCell[a.column.key]?s(t,i,a,e):i("span",o[e.key])]),i("Col",{props:{span:"2"}},[o.edittingCell[a.column.key]?d(t,i,a):l(t,i,a)])]):i("span",o[e.key])}),e.handle&&(e.render=function(n,i){var a=t.thisTableData[i.index],l=[];return e.handle.forEach(function(e){"edit"===e?l.push(o(t,n,a,i.index)):"delete"===e&&l.push(r(t,n,0,i.index))}),n("div",l)})})},handleBackdata:function(t){var n=JSON.parse((0,a.default)(t));return n.forEach(function(t){delete t.editting,delete t.edittingCell,delete t.saving}),n}},watch:{value:function(t){this.init()}}}},1104:function(t,n,e){var i=e(1105);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e(43)("9fdc95ae",i,!1,{})},1105:function(t,n,e){n=t.exports=e(42)(!1),n.push([t.i,"\n.show-edit-btn {\n  display: none;\n  margin-left: -10px;\n}\n.ivu-table-cell:hover .show-edit-btn {\n  display: inline-block;\n}\n",""])},1106:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("Table",{ref:t.refs,attrs:{columns:t.columnsList,data:t.thisTableData}})],1)},a=[];i._withStripped=!0;var o={render:i,staticRenderFns:a};n.default=o},1592:function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var a=e(38),o=(i(a),e(606)),r=i(o);n.default={data:function(){return{loading:!1,editInlineColumns:[{title:"业务员编号",key:"userid",align:"center"},{title:"业务员",align:"center",key:"user"},{title:"月度",align:"center",key:"month"},{title:"目标总销量",align:"center",key:"targetSales",editable:!0},{title:"操作",align:"center",key:"handle",handle:["edit","delete"]}],editInlineData:[],data:[],value:{}}},mounted:function(){},methods:{bindEvent:function(t,n){this.value=t[n]},save:function(){var t=this,n=[];this.editInlineData.map(function(t){var e={};e.detailDTO={id:t.detailDTO.id,saleTarget:t.targetSales},e.salesmanId=t.userid+"",e.salesmanName=t.user,e.type=t.type,e.month=t.month,n.push(e)}),this.$ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.targetConfig.updateTargetMonth,data:n}).then(function(n){t.loading=!1,t.$Message.info("保存成功！")}).catch(function(n){t.$Message.info("保存失败！"),console.log("失败信息：",n)})},getData:function(){var t=this;this.editInlineData=[];var n=this.$route.query.id,e={};e.id=n,this.loading=!0,this.$util.ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.targetConfig.editMonthTarget,data:e,transformRequest:[function(t){var n="";for(var e in t)n+=encodeURIComponent(e)+"="+encodeURIComponent(t[e])+"&";return n}],headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(n){t.loading=!1,console.log(n.data),n.data.result.salesmanTargetInfoDTOListM.map(function(n){var e={userid:n.salesmanId,user:n.salesmanName,month:n.month,targetSales:n.detailDTO.saleTarget,detailDTO:n.detailDTO,type:n.type};t.editInlineData.push(e),t.data.push(e)})}).catch(function(t){console.log("失败信息：",t)})},del:function(t,n){var e=this.data[n],i=this.$route.query.id,a={};a.id=1*i,a.type=e.type,a.detailDTO={id:e.detailDTO.id,saleTarget:1*e.detailDTO.saleTarget},this.$ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.targetConfig.deleteTargetMonth,data:a}).then(function(t){console.log(t)}).catch(function(t){console.log("失败信息：",t)})},fan:function(){this.$router.push({name:"month-target-list"})}},components:{canEditTable:r.default},created:function(){this.getData()}}},2033:function(t,n,e){var i=e(2034);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e(43)("e726c2a8",i,!1,{})},2034:function(t,n,e){n=t.exports=e(42)(!1),n.push([t.i,"\n.width-100 {\n  width: 100%;\n}\n.lb-left {\n  float: left;\n}\n.lb-right {\n  float: right;\n}\n.lb-center {\n  text-align: center;\n}\n.lb-promotion-main {\n  height: auto;\n  background-color: #fff;\n}\n.lb-promotion-main .lb-promotion-search {\n  border-bottom: 1px dashed #e5e5e5;\n}\n.lb-promotion-main .lb-promotion-search .lb-promotion-row {\n  margin-bottom: 14px;\n}\n.lb-promotion-main .lb-promotion-search .lb-promotion-row .ListName {\n  text-align: right;\n  line-height: 32px;\n  color: #747474;\n  font-size: 12px;\n  margin-right: 8px;\n}\n.promotion-page {\n  margin: 1rem 0 0 0;\n}\n.container {\n  background: #fff;\n  color: #747474;\n  border: 1px solid #E8E8E8;\n  padding: 1% 1% 3%;\n}\n.margin-top-8 {\n  margin-top: 8px;\n}\n.margin-top-10 {\n  margin-top: 10px;\n}\n.margin-top-20 {\n  margin-top: 20px;\n}\n.margin-left-10 {\n  margin-left: 10px;\n}\n.margin-bottom-10 {\n  margin-bottom: 10px;\n}\n.margin-bottom-12 {\n  margin-bottom: 12px;\n}\n.margin-bottom-14 {\n  margin-bottom: 14px;\n}\n.margin-bottom-100 {\n  margin-bottom: 100px;\n}\n.margin-right-10 {\n  margin-right: 10px;\n}\n.padding-left-6 {\n  padding-left: 6px;\n}\n.padding-left-8 {\n  padding-left: 5px;\n}\n.padding-left-10 {\n  padding-left: 10px;\n}\n.padding-left-20 {\n  padding-left: 20px;\n}\n.height-100 {\n  height: 100%;\n}\n.height-120px {\n  height: 100px;\n}\n.height-200px {\n  height: 200px;\n}\n.height-492px {\n  height: 492px;\n}\n.height-460px {\n  height: 460px;\n}\n.line-gray {\n  height: 0;\n  border-bottom: 2px solid #dcdcdc;\n}\n.notwrap {\n  word-break: keep-all;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.padding-left-5 {\n  padding-left: 10px;\n}\n[v-cloak] {\n  display: none;\n}\n.mb--12 {\n  margin-bottom: 12px;\n}\n.mb--14 {\n  margin-bottom: 14px;\n}\n.border-b--dashed {\n  border-bottom: 1px dashed #e5e5e5;\n}\n.pd--20 {\n  padding: 20px;\n}\n.ml--50 {\n  margin-left: 50px;\n}\n.fr {\n  float: right;\n}\n.fl {\n  float: left;\n}\n.bg--white {\n  background: #fff;\n}\n.clearfix:after {\n  content: '';\n  display: block;\n  height: 0;\n  clear: both;\n}\n.text-center {\n  text-align: center;\n}\n.white {\n  background-color: white;\n}\n.select_box {\n  padding: 20px;\n  border-bottom: 1px dashed #E8E8E8;\n}\n.ling_height {\n  padding-top: 15px;\n}\n.text_align_right {\n  text-align: right;\n}\n.text_align_center {\n  text-align: center;\n}\n.operation_box {\n  padding: 10px 20px;\n  text-align: right;\n}\n.page_right {\n  text-align: right;\n  padding: 10px 20px;\n}\n.input_width {\n  width: 120px;\n}\n.search_btn {\n  width: 100px;\n}\n.margin_bottom_0 {\n  margin-bottom: 0;\n}\n.ivu-breadcrumb a {\n  color: #999;\n}\n.ivu-breadcrumb {\n  font-size: 12px;\n}\n.ivu-breadcrumb > span:last-child {\n  color: #426196;\n}\n.box_shadow {\n  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);\n  border-color: #eee;\n}\n.border_bottom_dashed {\n  border-bottom: 1px dashed #E8E8E8;\n}\n.problem_table .ivu-checkbox-wrapper {\n  margin-right: 0px;\n}\n.month-target-edit {\n  width: 100%;\n  height: 500px;\n  background: #fff;\n  color: #747474;\n  border: 1px solid #E8E8E8;\n  text-align: center;\n  padding: 10px 1%;\n}\n.month-target-edit .tables {\n  margin-bottom: 15px;\n}\n.month-target-edit .save {\n  margin: 10px 0;\n  background: #05a1e9;\n  color: #fff;\n}\n",""])},2035:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"month-target-edit"},[e("can-edit-table",{staticClass:"tables",attrs:{loading:t.loading,"columns-list":t.editInlineColumns},on:{"on-delete":t.del,"on-change":t.bindEvent},model:{value:t.editInlineData,callback:function(n){t.editInlineData=n},expression:"editInlineData"}}),t._v(" "),e("Button",{staticStyle:{"margin-right":"30px"},on:{click:t.fan}},[t._v("返回")]),t._v(" "),e("Button",{on:{click:t.save}},[t._v("保存")])],1)},a=[];i._withStripped=!0;var o={render:i,staticRenderFns:a};n.default=o},606:function(t,n,e){"use strict";function i(t){s||e(1104)}Object.defineProperty(n,"__esModule",{value:!0});var a=e(1010),o=e.n(a);for(var r in a)"default"!==r&&function(t){e.d(n,t,function(){return a[t]})}(r);var l=e(1106),d=e.n(l),s=!1,c=e(13),p=i,u=c(o.a,d.a,!1,p,null,null);u.options.__file="src/views/tables/components/canEditTable.vue",n.default=u.exports},710:function(t,n,e){"use strict";function i(t){s||e(2033)}Object.defineProperty(n,"__esModule",{value:!0});var a=e(1592),o=e.n(a);for(var r in a)"default"!==r&&function(t){e.d(n,t,function(){return a[t]})}(r);var l=e(2035),d=e.n(l),s=!1,c=e(13),p=i,u=c(o.a,d.a,!1,p,null,null);u.options.__file="src/views/promotion-manage/war-adviser/target-config/month-target/month-target-edit/month-target-edit.vue",n.default=u.exports}});