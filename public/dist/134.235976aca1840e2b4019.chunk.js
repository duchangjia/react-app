webpackJsonp([134,259],{1009:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"BreadCrumb",props:{Breadcrumb:{type:Object}},data:function(){return{list:[]}},mounted:function(){},filters:{statePague:function(e,t){return e===t?"进行中":e<t?"待开始":"已完成"}},methods:{generType:function(e){var t=this;this.list=[],"0"===e?this.$nextTick(function(){t.list=["新建代金券","使用规则"]}):"1"===e?this.$nextTick(function(){t.list=["新建代金券","定向规划","发放规则","发放细则","使用规则"]}):this.$nextTick(function(){t.list=["新建代金券","定向规划","使用规则"]})}}}},1101:function(e,t,o){var a=o(1102);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o(43)("492815ce",a,!1,{})},1102:function(e,t,o){t=e.exports=o(42)(!1),t.push([e.i,"\n.demo-breadcrumb-separator {\n  color: #ff5500;\n  padding: 0 5px;\n}\n",""])},1103:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"white select_box"},[o("Steps",{attrs:{current:e.Breadcrumb.current}},e._l(e.list,function(t,a){return o("Step",{key:t,attrs:{title:e._f("statePague")(e.Breadcrumb.current,a),content:t}})}))],1)},n=[];a._withStripped=!0;var r={render:a,staticRenderFns:n};t.default=r},1570:function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(65),r=a(n),i=o(605),s=a(i);t.default={name:"o2oReportCouponUseRule",data:function(){var e=this;return{loading:!1,modalBrand:!1,modalInformation:{enjoy:"",contain:""},Breadcrumb:{current:4,data:["新建代金券","定向规划","发放规则","发放细则","使用规则"]},formValidate:{type:"测试",enjoyConditions:{select:"1",Array:[{code:"1",text:"品牌"},{code:"2",text:"指定产品"},{code:"5",text:"订单EA数量"},{code:"6",text:"订单金额"}]},contain:{select:"in",Array:[{code:"in",text:"包含"},{code:"not in",text:"不包含"}]},numberValue:"",numberText:""},ruleValidate:{},enjoyAdd:"品牌信息",selectEnjor:[],columns:[{title:"序号",type:"index",width:65,align:"center"},{title:"享受条件",key:"releaseType",align:"center",render:function(t,o){for(var a=e.formValidate.enjoyConditions.Array,n=0;n<a.length;n++)if(o.row.releaseType.toString()===a[n].code)return t("div",a[n].text)}},{title:"类型条件",align:"center",key:"typeCondition",render:function(e,t){return e("div","in"===t.row.typeCondition?"包含":"not in"===t.row.typeCondition?"不包含":"大于")}},{title:"类型的值",align:"center",key:"typeValue"},{title:"操作",align:"center",key:"handle",render:function(t,o){return t("div",[t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.removeEnjoyList(o.row,o.index)}}},"删除")])}}],data:[],modify:!1}},components:{BreadCrumb:s.default},mounted:function(){this.getModify(),this.recodeData(),this.addTable()},methods:{getModify:function(){var e=JSON.parse(window.localStorage.getItem("paramsCreateVoucher"));if(!e)return this.$router.push({path:"o2oReportCouponType-index"}),!1;if(this.$refs.Breadcrumb.generType(e.generationType),"0"===e.generationType?this.Breadcrumb.current=1:"2"===e.generationType&&(this.Breadcrumb.current=2),this.$route.query.type){var t=JSON.parse(window.localStorage.getItem("voucherDetail"));return this.modify=!0,this.columns.splice(this.columns.length-1,1),this.data=t.voucherUseRuleList,!1}this.formValidate.enjoyConditions.select="1",this.formValidate.contain.select="in",this.data=[],e.voucherUseRuleList&&(this.data=e.voucherUseRuleList)},goPrevPage:function(){this.$router.back(-1)},okBrand:function(){for(var e=this.formValidate.enjoyConditions.select,t=0;t<this.data.length;t++)e===this.data[t].releaseType.toString()&&this.data.splice(t,1);this.chooseUserStorage(),"1"===e?this.$router.push({path:"brand-information",query:{a:"2"}}):"2"===e?this.$router.push({path:"goods-list",query:{a:"2"}}):this.addTableInput()},updataVoucher:function(e){var t=this,o=JSON.parse(window.localStorage.getItem("paramsCreateVoucher"));if(o.voucherUseRuleList=this.data,this.loading=!0,this.$route.query.type)return o.persistenceCache=1,this.$util.ajax.post(this.$util.apiConfig.promotionManage.warProgramme.o2oVoucher.update,o).then(function(e){200===e.data.code?(t.$Message.success("修改成功"),window.localStorage.removeItem("voucherDetail"),t.$router.push({path:"o2o-report-coupon-type-index"})):t.$Message.error(e.data.message)}),!1;this.$util.ajax.post(this.$util.apiConfig.promotionManage.warProgramme.o2oVoucher.insert,o).then(function(e){200===e.data.code?(t.$Message.success("保存成功"),t.data=[],window.localStorage.removeItem("paramsCreateVoucher"),t.$router.push({path:"o2o-report-coupon-type-index"})):t.$Message.error(e.data.message)})},addTable:function(){var e=JSON.parse(window.sessionStorage.getItem("brandSelectedUseRule"));if(null===e)return!1;var t={releaseType:this.formValidate.enjoyConditions.select,typeCondition:this.formValidate.contain.select,typeValue:"",typeId:""};e[0].itemId?e.map(function(e){t.typeValue+=e.itemName+",",t.typeId+=e.itemId+","}):e.map(function(e){t.typeValue+=e.cName+",",t.typeId+=e.cid+","}),this.data.push(t),window.sessionStorage.removeItem("brandSelectedUseRule")},recodeData:function(){var e=JSON.parse(window.localStorage.getItem("recodeData"));e&&(this.formValidate.enjoyConditions.select=e.enjoyConditions,this.formValidate.contain.select=e.contain,this.enjoyAdd=e.enjoyAdd,this.data=e.data,window.localStorage.removeItem("recodeData"))},chooseUserStorage:function(){var e={enjoyConditions:this.formValidate.enjoyConditions.select,contain:this.formValidate.contain.select,enjoyAdd:this.enjoyAdd,data:this.data};window.localStorage.setItem("recodeData",(0,r.default)(e))},addTableInput:function(){var e=this.formValidate.enjoyConditions.select;if(""===this.formValidate.numberValue&&"5"===e||""===this.formValidate.numberValue&&"6"===e)return this.$Message.warning("输入框不能为空"),!1;if("5"===e){if(!/^([1-9][0-9]*){1,3}$/.test(this.formValidate.numberValue))return this.$Message.warning("订单EA数量必须是正整数"),!1}else if("6"===e){var t=/^(?!(0[0-9]{0,}$))[0-9]{1,}[.]{0,}[0-9]{0,}$/;if(!t.test(this.formValidate.numberValue))return this.$Message.warning("订单金额必须是正数"),!1}if(!this.pupulRequire(e,"2"))return!1;var o={releaseType:this.formValidate.enjoyConditions.select,typeCondition:">",typeValue:this.formValidate.numberValue,typeId:this.formValidate.numberValue};this.data.push(o),this.formValidate.numberValue=""},removeEnjoyList:function(e,t){this.data.splice(t,1)},selectEnjoy:function(){var e=this.formValidate.enjoyConditions.Array,t=this.formValidate.enjoyConditions.select;if("6"===t)return this.formValidate.numberText="请输入订单金额",!1;if("5"===t)return this.formValidate.numberText="请输入订单EA数量",!1;for(var o=0;o<e.length;o++)e[o].code===t&&(this.enjoyAdd=e[o].text+"信息")},openEnjoy:function(){var e=this.formValidate.enjoyConditions.select;if(!this.pupulRequire(e,"1"))return!1;this.chooseUserStorage(),"1"===e?this.$router.push({path:"brand-information",query:{a:"2"}}):"2"===e&&this.$router.push({path:"goods-list",query:{a:"2"}})},pupulRequire:function(e,t){var o=this.formValidate.enjoyConditions.Array,a=this.data;if(a.length>0)if("1"===t){for(var n=0;n<a.length;n++)if(a[n].releaseType.toString()===e)return this.modalInformation.enjoy=this.pupulText(o,e),this.modalBrand=!0,!1}else for(var r=0;r<a.length;r++)if(a[r].releaseType===e)return this.modalInformation.enjoy=this.pupulText(o,e),this.modalInformation.contain="大于",this.modalBrand=!0,!1;return!0},pupulText:function(e,t){for(var o=0;o<e.length;o++)if(e[o].code===t)return e[o].text}}}},1965:function(e,t,o){var a=o(1966);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o(43)("2992bbc4",a,!1,{})},1966:function(e,t,o){t=e.exports=o(42)(!1),t.push([e.i,"\n.select_rule[data-v-2f01e098]{\n  border: #e5e5e5 solid 1px;\n  margin-top: 8px;\n  padding: 5px 10px;\n}\n",""])},1967:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("bread-crumb",{ref:"Breadcrumb",attrs:{Breadcrumb:e.Breadcrumb}}),e._v(" "),o("Card",{staticClass:"white create_active margin-top-8",attrs:{bordered:!1}},[o("p",{attrs:{slot:"title"},slot:"title"},[e._v("使用规则")]),e._v(" "),o("div",[o("Form",{attrs:{action:"",model:e.formValidate,rules:e.ruleValidate,"label-position":"left","label-width":90}},[o("div",{staticClass:"select_box"},[e.modify?o("div",{staticClass:"margin-top-10"},[o("Table",{attrs:{columns:e.columns,data:e.data}})],1):o("FormItem",{staticClass:"margin_n",attrs:{label:"享受条件",prop:"numberText"}},[o("Select",{staticClass:"input_width",on:{"on-change":e.selectEnjoy},model:{value:e.formValidate.enjoyConditions.select,callback:function(t){e.$set(e.formValidate.enjoyConditions,"select",t)},expression:"formValidate.enjoyConditions.select"}},e._l(e.formValidate.enjoyConditions.Array,function(t,a){return o("Option",{key:a,attrs:{value:t.code}},[e._v(e._s(t.text))])})),e._v(" "),"1"===e.formValidate.enjoyConditions.select||"2"===e.formValidate.enjoyConditions.select?o("span",[o("i-select",{staticClass:"input_width",model:{value:e.formValidate.contain.select,callback:function(t){e.$set(e.formValidate.contain,"select",t)},expression:"formValidate.contain.select"}},e._l(e.formValidate.contain.Array,function(t,a){return o("i-option",{key:a,attrs:{value:t.code}},[e._v(e._s(t.text))])})),e._v(" "),o("ButtonGroup",[""!==e.enjoyAdd?o("Button",{attrs:{type:"primary"},on:{click:e.openEnjoy}},[e._v("选择"+e._s(e.enjoyAdd))]):e._e()],1)],1):o("span",[o("Input",{staticClass:"input_width",attrs:{placeholder:e.formValidate.numberText},model:{value:e.formValidate.numberValue,callback:function(t){e.$set(e.formValidate,"numberValue",t)},expression:"formValidate.numberValue"}}),e._v(" "),o("ButtonGroup",[o("Button",{attrs:{type:"primary"},on:{click:e.addTableInput}},[e._v("添加")])],1)],1),e._v(" "),o("div",{staticClass:"margin-top-10"},[o("Table",{attrs:{columns:e.columns,data:e.data}})],1)],1)],1)])],1),e._v(" "),o("div",{staticClass:"add_btn text_align_center"},[o("Button",{on:{click:e.goPrevPage}},[e._v("返    回")]),e._v(" "),o("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.updataVoucher}},[e._v(e._s(e.loading?"加载中...":"完成"))])],1)]),e._v(" "),o("Modal",{attrs:{title:"提示"},on:{"on-ok":e.okBrand},model:{value:e.modalBrand,callback:function(t){e.modalBrand=t},expression:"modalBrand"}},[o("p",[e._v("列表中已经添加了["+e._s(e.modalInformation.enjoy)+"]，是否删除添加")])])],1)},n=[];a._withStripped=!0;var r={render:a,staticRenderFns:n};t.default=r},605:function(e,t,o){"use strict";function a(e){d||o(1101)}Object.defineProperty(t,"__esModule",{value:!0});var n=o(1009),r=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);var s=o(1103),l=o.n(s),d=!1,u=o(13),c=a,p=u(r.a,l.a,!1,c,null,null);p.options.__file="src/views/promotion-manage/o2oVoucher/components/Breadcrumb.vue",t.default=p.exports},688:function(e,t,o){"use strict";function a(e){d||o(1965)}Object.defineProperty(t,"__esModule",{value:!0});var n=o(1570),r=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);var s=o(1967),l=o.n(s),d=!1,u=o(13),c=a,p=u(r.a,l.a,!1,c,"data-v-2f01e098",null);p.options.__file="src/views/promotion-manage/o2oVoucher/o2oReportAdd/o2oReportCouponUseRule.vue",t.default=p.exports}});