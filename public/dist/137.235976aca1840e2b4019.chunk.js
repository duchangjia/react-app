webpackJsonp([137,259],{1009:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"BreadCrumb",props:{Breadcrumb:{type:Object}},data:function(){return{list:[]}},mounted:function(){},filters:{statePague:function(e,t){return e===t?"进行中":e<t?"待开始":"已完成"}},methods:{generType:function(e){var t=this;this.list=[],"0"===e?this.$nextTick(function(){t.list=["新建代金券","使用规则"]}):"1"===e?this.$nextTick(function(){t.list=["新建代金券","定向规划","发放规则","发放细则","使用规则"]}):this.$nextTick(function(){t.list=["新建代金券","定向规划","使用规则"]})}}}},1101:function(e,t,a){var r=a(1102);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(43)("492815ce",r,!1,{})},1102:function(e,t,a){t=e.exports=a(42)(!1),t.push([e.i,"\n.demo-breadcrumb-separator {\n  color: #ff5500;\n  padding: 0 5px;\n}\n",""])},1103:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"white select_box"},[a("Steps",{attrs:{current:e.Breadcrumb.current}},e._l(e.list,function(t,r){return a("Step",{key:t,attrs:{title:e._f("statePague")(e.Breadcrumb.current,r),content:t}})}))],1)},o=[];r._withStripped=!0;var s={render:r,staticRenderFns:o};t.default=s},1567:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(65),s=r(o),i=a(239),n=r(i),l=a(605),c=r(l);t.default={name:"Orienteering",data:function(){var e=this;return{removeStoreShow:!1,Breadcrumb:{current:1},goodsListSelect:[],formValidate:{promotionCode:"",title:"",name:"",beginDate:"",endDate:"",gender:"0",storeCode:null,storeName:null},ruleValidate:{name:[{required:!0,message:"不能为空",trigger:"blur"}],beginDate:[{required:!0,type:"date",message:"请选择开始日期",trigger:"change"}],endDate:[{required:!0,type:"date",message:"请选择结束日期",trigger:"change"}]},columnsPupol:[{type:"selection",align:"center",width:58},{title:"序号",type:"index",width:68,align:"center"},{title:"门店编号",align:"left",width:120,key:"storeCode"},{title:"门店名称",align:"left",key:"storeName"}],dataPupol:[],columnsSeeAdd:[{title:"序号",type:"index",width:68,align:"center"},{title:"门店编号",align:"left",width:120,key:"scopeCode"},{title:"门店名称",align:"left",key:"scopeName"},{title:"操作",align:"center",width:68,key:"handle",render:function(t,a){return t("div",[t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.removeGoodsList(a.row,a.index)}}},"删除")])}}],dataSeeAdd:[],loadingStore:!1,columns:[{title:"序号",type:"index",width:68,align:"center"},{title:"门店编码",width:120,align:"center",key:"storeCode"},{title:"门店名称",align:"left",key:"storeName"},{title:"操作",align:"center",width:68,key:"handle",render:function(t,a){return t("div",[t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.removeStoryList(a.row,a.index)}}},"删除")])}}],pageParameter:{totalCount:0,currentPage:1,pageSize:10},data:[],salePeople:{select:[],Array:[{id:1,text:"业务员01"},{id:2,text:"业务员02"},{id:3,text:"业务员03"}]},storeGroup:{select:[],Array:[{id:1,text:"业务员01"},{id:2,text:"业务员02"},{id:3,text:"业务员03"}]},storeDataType:{indeterminate:!1,checkAll:!0,checkAllGroup:["A","B","C","D","E"]},storeDataTypeArray:["A","B","C","D","E"],loading:!1,storeGroupBoolean:!1}},components:{BreadCrumb:c.default},computed:{gender:function(){return"2"===this.formValidate.gender?2:"1"===this.formValidate.gender?1:0},storeDataTypeLength:function(){return this.storeDataType.checkAllGroup.length}},watch:{storeDataTypeLength:function(e){this.storeDataTypeArray.length===e?this.storeGroupBoolean=!1:this.storeGroupBoolean=!0}},mounted:function(){this.storetypeData(),this.querySalesmanData(),this.listSeparationData(1),this.storeGroupData(),this.getModify(),this.recodeData(),this.removeStoreGetTable()},methods:{genderChange:function(e){this.storeDataType.checkAllGroup=[],this.storeDataType.checkAllGroup=this.storeDataTypeArray,this.salePeople.select=[],this.data=[],this.dataSeeAdd=[]},removeStore:function(){var e={checkAllGroup:this.storeDataType.checkAllGroup,select:this.salePeople.select,storeGroup:this.storeGroup.select,data:this.data,gender:this.formValidate.gender};window.localStorage.setItem("recodeData",(0,s.default)(e)),this.$router.push({path:"goods-list",query:{a:"3"}})},removeStoryList:function(e,t){this.data.splice(t,1)},recodeData:function(){var e=JSON.parse(window.localStorage.getItem("recodeData"));e&&(this.storeDataType.checkAllGroup=e.checkAllGroup,this.salePeople.select=e.select,this.data=e.data,this.storeGroup.select=e.storeGroup,this.formValidate.gender=e.gender,window.localStorage.removeItem("recodeData"))},removeStoreGetTable:function(){var e=this,t=JSON.parse(window.sessionStorage.getItem("removeBrand")),a=[];if(!t)return!1;for(var r=0;r<t.length;r++)for(var o=0;o<this.data.length;o++)t[r].storeCode===this.data[o].storeCode&&a.push(t[r]);for(var s=0;s<a.length;s++)for(var i=0;i<t.length;i++)t[i].storeCode===a[s].storeCode&&t.splice(i,1);t.length>0?(t.map(function(t){e.data.unshift({storeCode:t.storeCode,storeId:t.id,storeName:t.storeName,voucherTypeId:2})}),this.$Message.success("添加成功")):this.$Message.error("添加失败,所选门店已在列表中"),window.sessionStorage.removeItem("removeBrand")},getModify:function(){var e=JSON.parse(window.localStorage.getItem("paramsCreateVoucher"));if(!e)return this.$router.push({path:"o2o-report-coupon-create"}),!1;if(this.$refs.Breadcrumb.generType(e.generationType),this.$route.query.type&&e.voucherOrientationRuleList.length<1){var t=JSON.parse(window.localStorage.getItem("voucherDetail"));return t.voucherOrientationRuleList?this.differentStates(t):this.removeOrienteerData(),!1}this.differentStates(e)},differentStates:function(e){var t=e.voucherOrientationRuleList,a=e.salesmanList;if(t.length<1)return this.removeOrienteerData(),!1;var r=t[0].scopeType;if(1===r)this.storeDataType.checkAllGroup=[],this.storeDataType.checkAllGroup=this.storeDataTypeArray,this.formValidate.gender="0",this.salePeopleLoad(a,e.voucherExcludeRuleList),this.dataSeeAdd=[];else if(3===r){this.storeDataType.checkAllGroup=[],this.formValidate.gender="1";for(var o=0;o<e.voucherOrientationRuleList.length;o++)e.voucherOrientationRuleList[o].scopeCode?this.storeDataType.checkAllGroup.push(e.voucherOrientationRuleList[o].scopeName):this.storeGroup.select.push(t[o].storeGroupName+","+t[o].storeGroupId);this.salePeopleLoad(a,e.voucherExcludeRuleList),this.dataSeeAdd=[]}else this.formValidate.gender="2",this.dataSeeAdd=e.voucherOrientationRuleList},storeGroupLoad:function(e){for(var t=0;t<e.length;t++)this.storeGroup.select.push(e[t].storeGroupName+","+e[t].storeGroupId)},salePeopleLoad:function(e,t){if(this.data=t,e.length<1)return!1;for(var a=0;a<e.length;a++)this.salePeople.select.push(e[a].salesmanCode+","+e[a].salesmanName+","+e[a].salesmanId)},removeOrienteerData:function(){this.storeDataType.checkAllGroup=[],this.storeDataType.checkAllGroup=this.storeDataTypeArray,this.formValidate.gender="0",this.salePeople.select=[],this.data=[],this.dataSeeAdd=[]},goPrevPage:function(){this.$router.back(-1)},storetypeData:function(){this.$util.ajax.get(this.$util.apiConfig.promotionManage.warProgramme.o2oVoucher.storetype).then(function(e){200===e.data.code&&console.log(e)})},querySalesmanData:function(){var e=this;this.$util.ajax.post(this.$util.apiConfig.promotionManage.warProgramme.o2oVoucher.querySalesman).then(function(t){200===t.data.code&&(e.salePeople.Array=t.data.result)})},storeGroupData:function(){var e=this;this.$util.ajax.post(this.$util.apiConfig.promotionManage.warProgramme.o2oVoucher.getList).then(function(t){200===t.data.code&&(e.storeGroup.Array=t.data.result.storeGroupList)})},listSeparationData:function(e){var t=this;this.loading=!0,this.pageParameter.currentPage=e;var a={page:this.pageParameter.currentPage,storeCodeLike:this.formValidate.storeCode,storeNameLike:this.formValidate.storeName};this.$util.ajax.post(this.$util.apiConfig.promotionManage.warProgramme.o2oVoucher.listSeparation,n.default.stringify(a),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){200===e.data.code&&(t.loading=!1,t.pageParameter.totalCount=e.data.result.pager.totalCount,t.dataPupol=e.data.result.pager.records)})},handleCheckAllType:function(){this.storeDataType.indeterminate?this.storeDataType.checkAll=!1:this.storeDataType.checkAll=!this.storeDataType.checkAll,this.storeDataType.indeterminate=!1,this.storeDataType.checkAll?this.storeDataType.checkAllGroup=this.storeDataTypeArray:this.storeDataType.checkAllGroup=[]},checkAllGroupChangeType:function(e){e.length===this.storeDataTypeArray.length?(this.storeDataType.indeterminate=!1,this.storeDataType.checkAll=!0):e.length>0?(this.storeDataType.indeterminate=!0,this.storeDataType.checkAll=!1):(this.storeDataType.indeterminate=!1,this.storeDataType.checkAll=!1)},linkCreate:function(){var e=this.storeDataType.checkAllGroup,t=this.storeGroup.select,a=JSON.parse(window.localStorage.getItem("paramsCreateVoucher"));if(0===this.dataSeeAdd.length&&"2"===this.formValidate.gender)return this.$Message.warning("至少选择一个门店"),!1;if(0===e.length&&"1"===this.formValidate.gender)return this.$Message.warning("至少选择一个类型的门店"),!1;if(a.voucherOrientationRuleList=[],a.voucherExcludeRuleList=[],a.salesmanList=[],"0"===this.formValidate.gender)a.voucherOrientationRuleList.push({scopeCode:"ALL",scopeName:"全部门店",scopeType:1}),a.voucherExcludeRuleList=this.data;else if("1"===this.formValidate.gender){if(t.length>0){for(var r=0;r<e.length;r++)a.voucherOrientationRuleList.push({scopeCode:e[r],scopeName:e[r],scopeType:3});for(var o=0;o<t.length;o++)a.voucherOrientationRuleList.push({scopeType:3,storeGroupName:t[o].split(",")[0],storeGroupId:t[o].split(",")[1]})}else for(var i=0;i<e.length;i++)a.voucherOrientationRuleList.push({scopeCode:e[i],scopeName:e[i],scopeType:3});a.voucherExcludeRuleList=this.data}else a.voucherOrientationRuleList=this.dataSeeAdd;var n=a.voucherOrientationRuleList[0].scopeType,l=this.salePeople.select;if(1===n&&0!==l.length||3===n&&0!==l.length)for(var c=0;c<l.length;c++)a.salesmanList.push({salesmanName:l[c].split(",")[1],salesmanCode:l[c].split(",")[0],salesmanId:l[c].split(",")[2]});return this.salePeople.select=[],window.localStorage.setItem("paramsCreateVoucher",(0,s.default)(a)),this.$route.query.generationType?this.$route.query.type?(this.$router.push({path:"o2o-report-coupon-use-rule",query:{type:"Modify"}}),!1):(this.$router.push({path:"o2o-report-coupon-use-rule"}),!1):this.$route.query.type?(this.$router.push({path:"o2o-report-coupon-rule",query:{type:"Modify"}}),!1):void this.$router.push({path:"o2o-report-coupon-rule"})},handleRowChange:function(e,t){this.goodsListSelect=e},removeGoodsList:function(e,t){this.dataSeeAdd.splice(t,1)},addTable:function(){var e=this;if(0!==this.dataSeeAdd.length)for(var t=this.dataSeeAdd,a=this.goodsListSelect,r=0;r<t.length;r++)for(var o=0;o<a.length;o++)if(t[r].id===a[o].id)return this.$Message.warning("添加失败，有已勾选重复的商品"),!1;this.goodsListSelect.map(function(t){e.dataSeeAdd.unshift({scopeCode:t.storeCode,scopeId:t.id,scopeName:t.storeName,scopeType:2})}),this.$refs.selection.selectAll(!1)}}}},1956:function(e,t,a){var r=a(1957);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(43)("4767c1bf",r,!1,{})},1957:function(e,t,a){t=e.exports=a(42)(!1),t.push([e.i,"\n.margin_n {\n  margin-bottom: 0px;\n}\n.title_bold > .ivu-form-item-label {\n  font-weight: bold;\n}\n.title_right > .ivu-form-item-label {\n  text-align: right;\n}\n.store_right label {\n  text-align: right !important;\n}\n.add_btn {\n  padding: 15px 0px;\n  text-align: center;\n}\n",""])},1958:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("bread-crumb",{ref:"Breadcrumb",attrs:{Breadcrumb:e.Breadcrumb}}),e._v(" "),a("Card",{staticClass:"white create_active margin-top-8",attrs:{bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("定向规划")]),e._v(" "),a("div",[a("Form",{attrs:{action:"",model:e.formValidate,rules:e.ruleValidate,"label-position":"left","label-width":90}},[a("div",{staticClass:"select_box"},[a("FormItem",{staticClass:"margin_n title_bold",attrs:{label:"匹配规则模式",prop:"gender"}},[a("RadioGroup",{on:{"on-change":e.genderChange},model:{value:e.formValidate.gender,callback:function(t){e.$set(e.formValidate,"gender",t)},expression:"formValidate.gender"}},[a("Radio",{attrs:{label:"0"}},[e._v("全部门店")]),e._v(" "),a("Radio",{attrs:{label:"2"}},[e._v("指定门店")]),e._v(" "),a("Radio",{attrs:{label:"1"}},[e._v("指定门店类型")])],1)],1)],1),e._v(" "),1===e.gender?a("div",{staticClass:"select_box"},[a("FormItem",{staticClass:"margin_n title_right",attrs:{label:"门店类型",prop:"checkAllGroup"}},[a("Checkbox",{attrs:{indeterminate:e.storeDataType.indeterminate,value:e.storeDataType.checkAll},nativeOn:{click:function(t){return t.preventDefault(),e.handleCheckAllType(t)}}},[e._v("全选")]),e._v(" "),a("CheckboxGroup",{on:{"on-change":e.checkAllGroupChangeType},model:{value:e.storeDataType.checkAllGroup,callback:function(t){e.$set(e.storeDataType,"checkAllGroup",t)},expression:"storeDataType.checkAllGroup"}},e._l(e.storeDataTypeArray,function(e,t){return a("Checkbox",{key:t,attrs:{label:e}})}))],1)],1):e._e(),e._v(" "),1===e.gender?a("div",{staticClass:"select_box"},[a("FormItem",{staticClass:"margin_n title_right",attrs:{label:"门店分组",prop:"select"}},[a("Row",[a("CheckboxGroup",{model:{value:e.storeGroup.select,callback:function(t){e.$set(e.storeGroup,"select",t)},expression:"storeGroup.select"}},e._l(e.storeGroup.Array,function(t,r){return a("Checkbox",{key:r,attrs:{label:t.groupName+","+t.id}},[e._v(e._s(t.groupName))])}))],1)],1)],1):e._e(),e._v(" "),2!==e.gender?a("div",{staticClass:"select_box"},[a("FormItem",{staticClass:"margin_n title_bold",attrs:{label:"业务员",prop:"select"}},[a("Row",[a("CheckboxGroup",{model:{value:e.salePeople.select,callback:function(t){e.$set(e.salePeople,"select",t)},expression:"salePeople.select"}},e._l(e.salePeople.Array,function(t,r){return a("Checkbox",{key:r,attrs:{label:t.empCode+","+t.empName+","+t.empId}},[e._v(e._s(t.empName))])}))],1)],1)],1):e._e(),e._v(" "),2===e.gender?a("div",{staticClass:"select_box"},[a("Row",[a("Col",{attrs:{span:8}},[a("FormItem",{staticClass:"store_right",attrs:{label:"门店编号:",prop:"storeCode"}},[a("Input",{attrs:{placeholder:"请输入门店编号"},model:{value:e.formValidate.storeCode,callback:function(t){e.$set(e.formValidate,"storeCode",t)},expression:"formValidate.storeCode"}})],1)],1),e._v(" "),a("Col",{attrs:{span:8}},[a("FormItem",{staticClass:"store_right",attrs:{label:"门店名称:",prop:"storeName"}},[a("Input",{attrs:{placeholder:"请输入门店名称"},model:{value:e.formValidate.storeName,callback:function(t){e.$set(e.formValidate,"storeName",t)},expression:"formValidate.storeName"}})],1)],1),e._v(" "),a("Col",{staticClass:"text_align_right",attrs:{span:8}},[a("Button",{staticClass:"search_btn",attrs:{type:"primary"},on:{click:function(t){e.listSeparationData(1)}}},[e._v("搜索 ")])],1)],1),e._v(" "),a("Table",{ref:"selection",staticClass:"problem_table",attrs:{loading:e.loading,stripe:"",border:"",height:"400",columns:e.columnsPupol,data:e.dataPupol},on:{"on-select-all":e.handleRowChange,"on-select":e.handleRowChange,"on-select-cancel":e.handleRowChange}}),e._v(" "),a("div",[a("Row",[a("Col",{attrs:{span:12}},[a("Button",{staticClass:"margin-top-10",attrs:{type:"primary"},on:{click:e.addTable}},[e._v("添加")])],1),e._v(" "),a("Col",{attrs:{span:12}},[a("Page",{attrs:{total:e.pageParameter.totalCount,"show-total":"","show-elevator":"","class-name":"page_right"},on:{"on-change":e.listSeparationData}})],1)],1)],1),e._v(" "),a("Table",{attrs:{stripe:"",border:"",height:"200",columns:e.columnsSeeAdd,data:e.dataSeeAdd}})],1):e._e(),e._v(" "),2!==e.gender?a("div",[a("div",[a("Row",{staticClass:"operation_box"},[a("Button",{attrs:{type:"success"},on:{click:e.removeStore}},[e._v("排除门店")])],1),e._v(" "),a("Table",{staticClass:"table",attrs:{border:"",columns:e.columns,data:e.data,height:"300"}}),e._v(" "),a("div",{staticClass:"operation_box"},[e._v("总共 "+e._s(e.data.length)+" 条记录")])],1)]):e._e(),e._v(" "),a("div",{staticClass:"add_btn"},[a("Button",{on:{click:e.goPrevPage}},[e._v("返    回")]),e._v(" "),a("Button",{attrs:{type:"primary"},on:{click:e.linkCreate}},[e._v("下一步")])],1)])],1)])],1)},o=[];r._withStripped=!0;var s={render:r,staticRenderFns:o};t.default=s},605:function(e,t,a){"use strict";function r(e){c||a(1101)}Object.defineProperty(t,"__esModule",{value:!0});var o=a(1009),s=a.n(o);for(var i in o)"default"!==i&&function(e){a.d(t,e,function(){return o[e]})}(i);var n=a(1103),l=a.n(n),c=!1,u=a(13),d=r,p=u(s.a,l.a,!1,d,null,null);p.options.__file="src/views/promotion-manage/o2oVoucher/components/Breadcrumb.vue",t.default=p.exports},685:function(e,t,a){"use strict";function r(e){c||a(1956)}Object.defineProperty(t,"__esModule",{value:!0});var o=a(1567),s=a.n(o);for(var i in o)"default"!==i&&function(e){a.d(t,e,function(){return o[e]})}(i);var n=a(1958),l=a.n(n),c=!1,u=a(13),d=r,p=u(s.a,l.a,!1,d,null,null);p.options.__file="src/views/promotion-manage/o2oVoucher/o2oReportAdd/o2oReportCouponOrienteering.vue",t.default=p.exports}});