webpackJsonp([177],{1752:function(e,s,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(s,"__esModule",{value:!0});var a=t(241),o=r(a),i=t(242),n=r(i),d=(t(898),t(239)),l=r(d);s.default={data:function(){return{apiGroup:this.$util.apiConfig.traderManage.infoManage.securitySetting,showNewPasswordTips:!1,showNewPasswordErr:!1,showNewPasswordPass:!1,oldPassword:"",newPassword:"",level:0,errInfo:"",reNewPassword:"",showReNewPasswordPass:!1,showReNewPasswordErr:!1,errInfo1:"",smsType:"",email:"",phone:"",loginname:"",verifyCode:"",getVerifyBtnText:"发送验证码",getVerifyLimit:!1,timer:"",oldPasswordErr:"",keyCode:"",verifyCodeErr:"",verifyCodeSending:!1}},created:function(){var e=this;this.timer=setInterval(function(){if(localStorage.modifyPwdGetVerifyCodeTimestamp){var s=(new Date).getTime(),t=s-localStorage.modifyPwdGetVerifyCodeTimestamp;t<9e4?(e.getVerifyLimit=!0,e.getVerifyBtnText="发送验证码"+Math.ceil((9e4-t)/1e3)+"s"):(e.getVerifyLimit=!1,e.getVerifyBtnText="发送验证码")}else e.getVerifyLimit=!1,e.getVerifyBtnText="发送验证码"},500),this.$util.ajax.post(this.apiGroup.getVerifyUser).then(function(s){console.log("修改密码返回数据：",s);var t=s.data.result.userinfo;200==s.data.code?(e.loginname=t.loginname,e.userType=t.userType,""!=t.userEmail&&void 0!=t.userEmail&&null!=t.userEmail&&(e.smsType="1",e.email=t.userEmail),""!=t.userMobile&&void 0!=t.userMobile&&null!=t.userMobile&&(e.smsType="2",e.phone=t.userMobile)):e.$Modal.error({title:"HTTP请求错误",content:s.data.message})}).catch(function(s){console.log(s),e.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},methods:{getVerify:function(){return""==this.oldPassword?(this.oldPasswordErr="请输入当前密码",!1):""==this.newPassword?(this.errInfo="请输入新密码",this.showNewPasswordErr=!0,!1):this.reNewPassword!=this.newPassword?(this.errInfo1="两次密码不同，请重新输入",this.showReNewPasswordErr=!0,!1):void this.sendCaptcha()},checkVerifyCode:function(e){var s=this;if(6==e.target.value.length){var t=this.keyCode,r={code:this.verifyCode,codeKey:t};this.$util.ajax.post(this.apiGroup.checkkeyCode,l.default.stringify(r)).then(function(e){e.message||(s.verifyCodeErr="验证码不正确")})}},sendCaptcha:function(){function e(){return s.apply(this,arguments)}var s=(0,n.default)(o.default.mark(function e(){var s,t,r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$util.ajax.post(this.apiGroup.checkPwd,l.default.stringify({pwd:this.oldPassword}));case 3:if(s=e.sent,1==s.data.success){e.next=7;break}return this.oldPasswordErr="密码错误",e.abrupt("return");case 7:return t={type:this.smsType,oldpwd:this.oldPassword,which:1},"1"==this.smsType?(t.contact=this.email,t.smsType="EMAIL_UP_LOGIN_PWD"):"2"==this.smsType&&(t.contact=this.phone,t.smsType="UPLOGINPWD"),this.verifyCodeSending=!0,e.next=12,this.$util.ajax.post(this.apiGroup.getkeyCode,l.default.stringify(t));case 12:r=e.sent,this.verifyCodeSending=!1,2==r.data.isOK?(localStorage.modifyPwdGetVerifyCodeTimestamp=(new Date).getTime(),this.getVerifyLimit=!0,this.keyCode=r.data.codeKey):1==r.data.isOK&&this.$Modal.error({title:"验证码发送失败",content:r.data.message}),console.log(r),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0);case 21:case"end":return e.stop()}},e,this,[[0,18]])}));return e}(),checkNewPasswordFocus:function(){this.showNewPasswordTips=!0,this.showNewPasswordPass=!1,this.showNewPasswordErr=!1},checkNewPassword:function(e){this.showNewPasswordTips=!1,this.showNewPasswordPass=!1;var s=e.target.value;if(0==s.length)return this.errInfo="请输入新密码",this.showNewPasswordErr=!0,!1;if(s.length<6)return this.errInfo="密码不得少于六位",this.showNewPasswordErr=!0,!1;var t=/^(\d+[a-zA-Z.,_ !@#$^%&*?`~():"<>\-=_+;',|\/{}\[\]\\]+)|([a-zA-Z]+[0-9.,_ !@#$^%&*?`~():"<>\-=_+;',|\/{}\[\]\\]+)|([.,_ !@#$^%&*?`~():"<>\-=_+;',|\/{}\[\]\\]+[0-9a-zA-Z]+)$/;return t.test(s)?(this.errInfo="",this.showNewPasswordErr=!1,this.showNewPasswordPass=!0,!0):(this.errInfo="至少由数字、字母、符号两个以上组合",this.showNewPasswordErr=!0,!1)},checkNewPasswordlevel:function(e){if(e.target.value.length<6)this.level=0;else{var s=/[.,_ !@#$^%&*?`~():"<>\-=_+;',|\/{}\[\]\\]+/;this.level=1;var t=e.target.value;(/[0-9]+/.test(t)&&/[a-zA-Z]+/.test(t)||/[a-zA-Z]+/.test(t)&&s.test(t)||s.test(t)&&/[0-9]+/.test(t))&&(this.level=2,/[a-zA-Z]+/.test(t)&&/[0-9]+/.test(t)&&s.test(t)&&(this.level=3))}},checkReNewPassword:function(e){var s=e.target.value;return 0==s.length?(this.errInfo1="请输入确认密码",this.showReNewPasswordErr=!0,this.showReNewPasswordPass=!1,!1):s!=this.newPassword?(this.errInfo1="两次密码不同，请重新输入",this.showReNewPasswordErr=!0,this.showReNewPasswordPass=!1,!1):(this.errInfo1="",this.showReNewPasswordErr=!1,this.showReNewPasswordPass=!0,!0)},submitUpdataPassword:function(){function e(){return s.apply(this,arguments)}var s=(0,n.default)(o.default.mark(function e(){var s,t,r,a,i,n=this;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=this.oldPassword){e.next=3;break}return this.oldPasswordErr="请输入当前密码",e.abrupt("return",!1);case 3:if(""!=this.newPassword){e.next=7;break}return this.errInfo="请输入新密码",this.showNewPasswordErr=!0,e.abrupt("return",!1);case 7:if(0!=this.checkReNewPassword.length){e.next=12;break}return this.errInfo1="请输入确认密码",this.showReNewPasswordErr=!0,this.showReNewPasswordPass=!1,e.abrupt("return",!1);case 12:if(this.reNewPassword==this.newPassword){e.next=16;break}return this.errInfo1="两次密码不同，请重新输入",this.showReNewPasswordErr=!0,e.abrupt("return",!1);case 16:return e.prev=16,e.next=19,this.$util.ajax.post(this.apiGroup.checkPwd,l.default.stringify({pwd:this.oldPassword}));case 19:if(s=e.sent,1==s.data.success){e.next=23;break}return this.oldPasswordErr="密码错误",e.abrupt("return");case 23:return t={code:this.verifyCode,codeKey:this.keyCode},e.next=26,this.$util.ajax.post(this.apiGroup.checkkeyCode,l.default.stringify(t));case 26:if(r=e.sent,r.data.message){e.next=30;break}return this.verifyCodeErr="验证码不正确",e.abrupt("return");case 30:return a={logname:this.loginname,userType:this.userType,oldpwd:this.oldPassword,loginpwd:this.newPassword,pwd:this.reNewPassword,captcha:this.verifyCode,codeKey:this.keyCode},e.next=33,this.$util.ajax.post(this.apiGroup.modifyPwd,l.default.stringify(a));case 33:i=e.sent,console.log(i),i.data.result.success?this.$Modal.success({title:"操作成功",content:i.data.result.resultMessage,onOk:function(){n.$router.push({name:"security-setting"})}}):this.$Modal.error({title:"操作失败",content:i.data.result.resultMessage}),e.next=41;break;case 38:e.prev=38,e.t0=e.catch(16),console.log(e.t0);case 41:case"end":return e.stop()}},e,this,[[16,38]])}));return e}()},watch:{newPassword:function(e,s){e!=s&&(console.log(e),this.reNewPassword="",this.showReNewPasswordPass=!1,this.showReNewPasswordErr=!0,this.errInfo1="请输入确认密码")}},beforeDestroy:function(){clearInterval(this.timer)}}},2578:function(e,s,t){var r=t(2579);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t(43)("8dddd9be",r,!1,{})},2579:function(e,s,t){s=e.exports=t(42)(!1),s.push([e.i,'\n.cmain[data-v-c907d5dc] {\n    background-color: white;\n    position: relative;\n    /* min-width: 1020px; */\n}\n.lebalFont[data-v-c907d5dc] {\n    display: inline-block;\n    width: 300px;\n    text-align: right;\n}\n.nessaryIcon[data-v-c907d5dc] {\n    color: #0099ff;\n}\n.red[data-v-c907d5dc] {\n    color: red;\n}\n.blue[data-v-c907d5dc] {\n    color: rgb(0, 153, 255);\n}\n.infoColor[data-v-c907d5dc] {\n    color: rgb(222,222,222)\n}\n.bg_09[data-v-c907d5dc] {\n    background: #caecb6;\n}\n.bg_10[data-v-c907d5dc] {\n    background: #7abd54;\n}\n.bg_11[data-v-c907d5dc] {\n    background: #69a348;\n}\n.green[data-v-c907d5dc] {\n    color: green;\n}\n.font_12[data-v-c907d5dc] {\n    font-size: 12px;\n    font-family: "\\5B8B\\4F53   Std L";\n    width: 30px;\n    height: 13px!important;\n    margin-right: 5px;\n    line-height: 13px!important;\n    color: #fff;\n    text-align: center;\n    display: inline-block;\n}\n\n',""])},2580:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"cmain"},[t("div",{staticStyle:{padding:"20px 50px"}},[t("h3",[e._v("安全信息设置>登录密码修改")]),e._v(" "),t("br"),e._v(" "),t("Card",[t("br"),e._v(" "),t("br"),e._v(" "),t("Row",[t("span",{staticClass:"lebalFont"},[t("i",{staticClass:"nessaryIcon"},[e._v("*")]),e._v("当前密码：")]),e._v(" "),t("Input",{staticStyle:{width:"250px","margin-left":"15px"},attrs:{type:"password"},on:{"on-focus":function(s){e.oldPasswordErr=""}},model:{value:e.oldPassword,callback:function(s){e.oldPassword="string"==typeof s?s.trim():s},expression:"oldPassword"}}),e._v(" "),""!=e.oldPasswordErr?t("Icon",{staticClass:"red",attrs:{type:"close-circled"}}):e._e(),e._v(" "),t("span",{staticClass:"red"},[e._v(e._s(e.oldPasswordErr))])],1),e._v(" "),t("br"),e._v(" "),t("Row",[t("span",{staticClass:"lebalFont"},[t("i",{staticClass:"nessaryIcon"},[e._v("*")]),e._v("新密码：")]),e._v(" "),t("Input",{staticStyle:{width:"250px","margin-left":"15px"},attrs:{type:"password"},on:{"on-focus":e.checkNewPasswordFocus,"on-blur":e.checkNewPassword,"on-keyup":e.checkNewPasswordlevel},model:{value:e.newPassword,callback:function(s){e.newPassword="string"==typeof s?s.trim():s},expression:"newPassword"}}),e._v(" "),e.showNewPasswordPass?t("Icon",{staticClass:"green",attrs:{type:"checkmark-circled"}}):e._e(),e._v(" "),e.showNewPasswordErr?t("Icon",{staticClass:"blue",attrs:{type:"information-circled"}}):e._e(),e._v(" "),e.showNewPasswordTips?t("span",{staticClass:"infoColor"},[e._v("6-20位字符，建议由不含空格的字母数据和符号组成")]):e._e(),e._v(" "),e.showNewPasswordErr?t("span",{staticClass:"red"},[e._v(e._s(e.errInfo))]):e._e()],1),e._v(" "),t("Row",[t("div",[t("span",{staticStyle:{display:"inline-block",width:"380px"}}),e._v(" "),e.level>0?t("span",{staticClass:"bg_09 font_12"},[e._v("弱")]):e._e(),e._v(" "),e.level>1?t("span",{staticClass:"bg_10 font_12"},[e._v("中")]):e._e(),e._v(" "),e.level>2?t("span",{staticClass:"bg_11 font_12"},[e._v("强")]):e._e()])]),e._v(" "),t("Row",[t("span",{staticClass:"lebalFont"},[t("i",{staticClass:"nessaryIcon"},[e._v("*")]),e._v("确认密码：")]),e._v(" "),t("Input",{staticStyle:{width:"250px","margin-left":"15px"},attrs:{type:"password"},on:{"on-blur":e.checkReNewPassword},model:{value:e.reNewPassword,callback:function(s){e.reNewPassword="string"==typeof s?s.trim():s},expression:"reNewPassword"}}),e._v(" "),e.showReNewPasswordPass?t("Icon",{staticClass:"green",attrs:{type:"checkmark-circled"}}):e._e(),e._v(" "),e.showReNewPasswordErr?t("Icon",{staticClass:"blue",attrs:{type:"information-circled"}}):e._e(),e._v(" "),e.showReNewPasswordErr?t("span",{staticClass:"red"},[e._v(e._s(e.errInfo1))]):e._e()],1),e._v(" "),t("br"),e._v(" "),t("Row",[t("span",{staticClass:"lebalFont"},[t("i",{staticClass:"nessaryIcon"},[e._v("*")]),e._v("绑定手机/邮箱：")]),e._v(" "),t("i-select",{staticStyle:{width:"250px","margin-left":"15px"},attrs:{disabled:e.verifyCodeSending},model:{value:e.smsType,callback:function(s){e.smsType=s},expression:"smsType"}},[e.email?t("i-option",{attrs:{value:"1"}},[e._v(e._s(e.email))]):e._e(),e._v(" "),e.phone?t("i-option",{attrs:{value:"2"}},[e._v(e._s(e.phone))]):e._e()],1)],1),e._v(" "),t("br"),e._v(" "),t("Row",[t("span",{staticClass:"lebalFont"},[t("i",{staticClass:"nessaryIcon"},[e._v("*")]),e._v("校验码：")]),e._v(" "),t("Input",{staticStyle:{width:"155px","margin-left":"15px"},on:{"on-blur":e.checkVerifyCode},model:{value:e.verifyCode,callback:function(s){e.verifyCode="string"==typeof s?s.trim():s},expression:"verifyCode"}}),e._v(" "),t("i-button",{attrs:{disabled:e.getVerifyLimit},on:{click:e.getVerify}},[e._v(e._s(e.getVerifyBtnText))]),e._v(" "),t("span",{staticClass:"red"},[e._v(e._s(e.verifyCodeErr))])],1),e._v(" "),t("br"),e._v(" "),t("Row",[t("span",{staticClass:"lebalFont"}),e._v(" "),t("i-button",{staticStyle:{width:"160px","margin-left":"15px"},attrs:{type:"warning"},on:{click:e.submitUpdataPassword}},[e._v("提交")])],1),e._v(" "),t("br"),e._v(" "),t("br")],1)],1)])},a=[];r._withStripped=!0;var o={render:r,staticRenderFns:a};s.default=o},863:function(e,s,t){"use strict";function r(e){l||t(2578)}Object.defineProperty(s,"__esModule",{value:!0});var a=t(1752),o=t.n(a);for(var i in a)"default"!==i&&function(e){t.d(s,e,function(){return a[e]})}(i);var n=t(2580),d=t.n(n),l=!1,c=t(13),w=r,h=c(o.a,d.a,!1,w,"data-v-c907d5dc",null);h.options.__file="src/views/trader-manage/information-manage/security-setting/modify-pwd.vue",s.default=h.exports},898:function(e,s,t){"use strict";function r(e,s){if(!s)var s="yyyy-MM-DD hh:mm:ss";var t={"M+":e.getMonth()+1,"D+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};/(y+)/.test(s)&&(s=s.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in t)new RegExp("("+r+")").test(s)&&(s=s.replace(RegExp.$1,1===RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return s}function a(e,s){if(!s)var s="yyyy-MM-dd";(e=Number(e))<1e10&&(e*=1e3);var t=new Date(e),r={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(s)&&(s=s.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in r)new RegExp("("+a+")").test(s)&&(s=s.replace(RegExp.$1,1==RegExp.$1.length?r[a]:("00"+r[a]).substr((""+r[a]).length)));return s}Object.defineProperty(s,"__esModule",{value:!0}),s.formatDate=r,s.timestampToDay=a}});