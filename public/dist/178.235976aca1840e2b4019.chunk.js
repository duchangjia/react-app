webpackJsonp([178],{1751:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(241),r=a(i),s=n(242),o=a(s),l=(n(898),n(239)),c=a(l);t.default={data:function(){return{apiGroup:this.$util.apiConfig.traderManage.infoManage.securitySetting,getVerifyBtnText:"发送验证码",getVerifyLimit:!1,currentStep:0,smsType:"",email:"",phone:"",nickname:"",oldPassword:"",verifyCode:"",timer:"",timer1:"",keyCode:"",verifyCodeErr:"",newPhoneNo:"",verifyNewCode:"",codeNewKey:"",getNewVerifyLimit:!1,getNewVerifyBtnText:"发送验证码",verifyNewCodeErr:"",uid:"",verifyNewPhoneErr:""}},created:function(){var e=this;"New"==this.$route.query.isNew&&(this.currentStep=1),this.timer=setInterval(function(){if(localStorage.modifyPhoneGetVerifyCodeTimestamp){var t=(new Date).getTime(),n=t-localStorage.modifyPhoneGetVerifyCodeTimestamp;n<9e4?(e.getVerifyLimit=!0,e.getVerifyBtnText="发送验证码"+Math.ceil((9e4-n)/1e3)+"s"):(e.getVerifyLimit=!1,e.getVerifyBtnText="发送验证码")}else e.getVerifyLimit=!1,e.getVerifyBtnText="发送验证码"},500),this.timer1=setInterval(function(){if(localStorage.modifyPhoneGetVerifyCodeTimestamp1){var t=(new Date).getTime(),n=t-localStorage.modifyPhoneGetVerifyCodeTimestamp1;n<9e4?(e.getNewVerifyLimit=!0,e.getNewVerifyBtnText="发送验证码"+Math.ceil((9e4-n)/1e3)+"s"):(e.getNewVerifyLimit=!1,e.getNewVerifyBtnText="发送验证码")}else e.getNewVerifyLimit=!1,e.getNewVerifyBtnText="发送验证码"},500),this.$util.ajax.post(this.apiGroup.getSellInfo).then(function(t){console.log("修改绑定电话返回数据：",t);var n=t.data.result;200==t.data.code?(e.userType=n.userType,e.nickname=n.nickname,e.uid=n.uid,""!=n.userEmail&&void 0!=n.userEmail&&null!=n.userEmail&&(e.smsType="1",e.email=n.userEmail),""!=n.umobile&&void 0!=n.umobile&&null!=n.umobile&&(e.smsType="2",e.phone=n.umobile)):e.$Modal.error({title:"HTTP请求错误",content:t.data.message})}).catch(function(t){e.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},methods:{finish:function(){this.$router.push({name:"security-setting"})},checkNewPhoneNo:function(e){return""==e.target.value?(this.verifyNewPhoneErr="输入手机号码为空",!1):11!=e.target.value.length?(this.verifyNewPhoneErr="请输入11位有效手机号码",!1):void(this.verifyNewPhoneErr="")},formatNum:function(e){e.target.value=e.target.value.replace(/[^\d]/g,"")},checkVerifyCode:function(e){var t=this;if(6==e.target.value.length){var n={code:this.verifyCode,codeKey:this.keyCode};this.$util.ajax.post(this.apiGroup.checkkeyCode,c.default.stringify(n)).then(function(e){e.message||(t.verifyCodeErr="验证码不正确")})}},checkVerifyNewCode:function(e){var t=this;if(6==e.target.value.length){var n={code:e.target.value,codeKey:this.codeNewKey};this.$util.ajax.post(this.apiGroup.checkkeyCode,c.default.stringify(n)).then(function(e){e.message||(t.verifyNewCodeErr="验证码不正确")})}},sendCaptcha:function(){function e(){return t.apply(this,arguments)}var t=(0,o.default)(r.default.mark(function e(){var t,n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={type:this.smsType},"1"==this.smsType?(t.address=this.email,t.smsType="EMAIL_UP_BIND_PHONE"):"2"==this.smsType&&(t.address=this.phone,t.smsType="UPBINDPHONE"),e.next=5,this.$util.ajax.post(this.apiGroup.getkeyCode,c.default.stringify(t));case 5:n=e.sent,2==n.data.isOK?(localStorage.modifyPhoneGetVerifyCodeTimestamp=(new Date).getTime(),this.getVerifyLimit=!0,this.keyCode=n.data.codeKey):1==n.data.isOK&&this.$Modal.error({title:"验证码发送失败",content:n.data.message}),console.log(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])}));return e}(),sendNewCaptcha:function(){function e(){return t.apply(this,arguments)}var t=(0,o.default)(r.default.mark(function e(){var t,n,a;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=this.newPhoneNo){e.next=3;break}return this.$Message.error({content:"输入手机号码为空",duration:2}),e.abrupt("return",!1);case 3:if(11==this.newPhoneNo.length){e.next=6;break}return this.$Message.error({content:"请输入11位有效手机号码",duration:2}),e.abrupt("return",!1);case 6:return e.prev=6,e.next=9,this.$util.ajax.post(this.apiGroup.checkNewPhoneNo,c.default.stringify({personalPhoneInput:this.newPhoneNo}));case 9:if(t=e.sent,t.data){e.next=13;break}return this.$Modal.error({title:"输入手机号码有误",content:"输入的手机号码已存在，请输入新的手机号码！"}),e.abrupt("return",!1);case 13:return n={type:4,smsType:"UPBINDPHONE",contact:this.newPhoneNo},e.next=16,this.$util.ajax.post(this.apiGroup.getkeyCode,c.default.stringify(n));case 16:a=e.sent,2==a.data.isOK?(localStorage.modifyPhoneGetVerifyCodeTimestamp1=(new Date).getTime(),this.getNewVerifyLimit=!0,this.codeNewKey=a.data.codeKey):1==a.data.isOK&&this.$Modal.error({title:"验证码发送失败",content:a.data.message}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),console.log(e.t0);case 23:case"end":return e.stop()}},e,this,[[6,20]])}));return e}(),nextStep:function(){function e(){return t.apply(this,arguments)}var t=(0,o.default)(r.default.mark(function e(){var t,n,a;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(6!=this.verifyCode.length){e.next=21;break}return t=this.keyCode,n={code:this.verifyCode,codeKey:t},e.prev=3,e.next=6,this.$util.ajax.post(this.apiGroup.checkkeyCode,c.default.stringify(n));case 6:if(a=e.sent,console.log(a),a.data.message){e.next=13;break}return this.$Modal.error({title:"校验码错误",content:"请填写正确的校验码"}),e.abrupt("return");case 13:this.currentStep=1;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),this.$Modal.error({title:"校验码验证请求失败",content:"校验码验证请求失败"});case 19:e.next=23;break;case 21:return this.$Modal.error({title:"校验码错误",content:"请填写正确的校验码"}),e.abrupt("return");case 23:case"end":return e.stop()}},e,this,[[3,16]])}));return e}(),toStep2:function(){function e(){return t.apply(this,arguments)}var t=(0,o.default)(r.default.mark(function e(){var t,n,a,i,s;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=this.newPhoneNo){e.next=3;break}return this.$Modal.error({content:"输入手机号码为空",duration:2}),e.abrupt("return",!1);case 3:if(11==this.newPhoneNo.length){e.next=6;break}return this.$Modal.error({content:"请输入11位有效手机号码",duration:2}),e.abrupt("return",!1);case 6:return e.prev=6,e.next=9,this.$util.ajax.post(this.apiGroup.checkNewPhoneNo,c.default.stringify({personalPhoneInput:this.newPhoneNo}));case 9:if(t=e.sent,t.data){e.next=13;break}return this.$Modal.error({title:"输入手机号码有误",content:"输入的手机号码已存在，请输入新的手机号码！"}),e.abrupt("return",!1);case 13:return n={code:this.verifyNewCode,codeKey:this.codeNewKey},e.next=16,this.$util.ajax.post(this.apiGroup.checkkeyCode,c.default.stringify(n));case 16:if(a=e.sent,a.data.message){e.next=21;break}return this.verifyNewCodeErr="验证码不正确",this.$Modal.error({title:"验证码不正确",content:"验证码不正确"}),e.abrupt("return",!1);case 21:return i={address:this.newPhoneNo,changeType:"phone",uid:this.uid},e.next=24,this.$util.ajax.post(this.apiGroup.modifyBindPhoneOrMail,c.default.stringify(i));case 24:s=e.sent,console.log(s),s.data.result?this.currentStep=2:this.$Modal.error({title:"修改失败",content:s.data.message}),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(6),console.log(e.t0);case 32:case"end":return e.stop()}},e,this,[[6,29]])}));return e}()},beforeDestroy:function(){clearInterval(this.timer),clearInterval(this.timer1)}}},2575:function(e,t,n){var a=n(2576);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(43)("0a8c5f8a",a,!1,{})},2576:function(e,t,n){t=e.exports=n(42)(!1),t.push([e.i,'\n.cmain[data-v-48a4a383] {\n    background-color: white;\n    position: relative;\n    /* min-width: 1020px; */\n}\n.lebalFont[data-v-48a4a383] {\n    display: inline-block;\n    width: 300px;\n    text-align: right;\n}\n.nessaryIcon[data-v-48a4a383] {\n    color: #0099ff;\n}\n.red[data-v-48a4a383] {\n    color: red;\n}\n.blue[data-v-48a4a383] {\n    color: rgb(0, 153, 255);\n}\n.infoColor[data-v-48a4a383] {\n    color: rgb(222,222,222)\n}\n.bg_09[data-v-48a4a383] {\n    background: #caecb6;\n}\n.bg_10[data-v-48a4a383] {\n    background: #7abd54;\n}\n.bg_11[data-v-48a4a383] {\n    background: #69a348;\n}\n.green[data-v-48a4a383] {\n    color: green;\n}\n.font_12[data-v-48a4a383] {\n    font-size: 12px;\n    font-family: "\\5B8B\\4F53   Std L";\n    width: 30px;\n    height: 13px!important;\n    margin-right: 5px;\n    line-height: 13px!important;\n    color: #fff;\n    text-align: center;\n    display: inline-block;\n}\n.getVerifyTipsNotLimit[data-v-48a4a383] {\n    font-weight: bold;\n    line-height: 40px;\n    font-size: 18px;\n    margin-left: 15px;\n    color: #747474;\n}\n.getVerifyTipsLimit[data-v-48a4a383] {\n    font-weight: bold;\n    line-height: 40px;\n    font-size: 18px;\n    margin-left: 15px;\n    color: #EE6B2B;\n}\n\n',""])},2577:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cmain"},[n("div",{staticStyle:{padding:"20px 50px"}},[n("h3",[e._v("安全信息设置>修改绑定电话")]),e._v(" "),n("br"),e._v(" "),n("Card",[n("br"),e._v(" "),n("br"),e._v(" "),n("Row",[n("Steps",{staticStyle:{"margin-left":"50px"},attrs:{current:e.currentStep}},[n("Step",{attrs:{title:"验证身份"}}),e._v(" "),n("Step",{attrs:{title:"设置绑定信息"}}),e._v(" "),n("Step",{attrs:{title:"完成"}})],1)],1),e._v(" "),n("br"),e._v(" "),n("br"),e._v(" "),0==e.currentStep?n("div",[n("Row",[n("span",{staticClass:"lebalFont"},[e._v("请选择验证身份方式：")]),e._v(" "),n("i-select",{staticStyle:{width:"250px","margin-left":"15px"},attrs:{disabled:e.getVerifyLimit},model:{value:e.smsType,callback:function(t){e.smsType=t},expression:"smsType"}},[e.email?n("i-option",{attrs:{value:"1"}},[e._v(e._s(e.email))]):e._e(),e._v(" "),e.phone?n("i-option",{attrs:{value:"2"}},[e._v(e._s(e.phone))]):e._e()],1)],1),e._v(" "),n("br"),e._v(" "),n("Row",[n("span",{staticClass:"lebalFont"},[e._v("昵称：")]),e._v(" "),n("Input",{staticStyle:{width:"250px","margin-left":"15px"},attrs:{readonly:""},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}})],1),e._v(" "),n("br"),e._v(" "),n("Row",[n("span",{staticClass:"lebalFont"},[n("i",{staticClass:"nessaryIcon"},[e._v("*")]),e._v("校验码：")]),e._v(" "),n("Input",{staticStyle:{width:"155px","margin-left":"15px"},on:{"on-blur":e.checkVerifyCode},model:{value:e.verifyCode,callback:function(t){e.verifyCode="string"==typeof t?t.trim():t},expression:"verifyCode"}}),e._v(" "),n("i-button",{attrs:{disabled:e.getVerifyLimit},on:{click:e.sendCaptcha}},[e._v(e._s(e.getVerifyBtnText))]),e._v(" "),n("span",{staticClass:"red"},[e._v(e._s(e.verifyCodeErr))])],1),e._v(" "),n("br"),e._v(" "),n("Row",[n("span",{staticClass:"lebalFont"}),e._v(" "),e.getVerifyLimit?e._e():n("span",{staticClass:"getVerifyTipsNotLimit"},[n("Icon",{attrs:{type:"paper-airplane"}}),e._v("请发送验证码")],1),e._v(" "),e.getVerifyLimit?n("span",{staticClass:"getVerifyTipsLimit"},[n("Icon",{attrs:{type:"checkmark-circled"}}),e._v("验证码已发送，请查看")],1):e._e()]),e._v(" "),n("br"),e._v(" "),n("Row",[n("span",{staticClass:"lebalFont"}),e._v(" "),n("i-button",{staticStyle:{width:"160px","margin-left":"15px"},attrs:{type:"warning"},on:{click:e.nextStep}},[e._v("下一步")])],1),e._v(" "),n("br"),e._v(" "),n("br")],1):e._e(),e._v(" "),1==e.currentStep?n("div",[n("Row",[n("span",{staticClass:"lebalFont"},[e._v("输入新手机号码：")]),e._v(" "),n("Input",{staticStyle:{width:"250px","margin-left":"15px"},on:{"on-keyup":e.formatNum,"on-blur":e.checkNewPhoneNo},model:{value:e.newPhoneNo,callback:function(t){e.newPhoneNo="string"==typeof t?t.trim():t},expression:"newPhoneNo"}}),e._v(" "),n("span",{staticClass:"red"},[e._v(e._s(e.verifyNewPhoneErr))])],1),e._v(" "),n("br"),e._v(" "),n("Row",[n("span",{staticClass:"lebalFont"},[n("i",{staticClass:"nessaryIcon"},[e._v("*")]),e._v("校验码：")]),e._v(" "),n("Input",{staticStyle:{width:"155px","margin-left":"15px"},on:{"on-blur":e.checkVerifyNewCode},model:{value:e.verifyNewCode,callback:function(t){e.verifyNewCode="string"==typeof t?t.trim():t},expression:"verifyNewCode"}}),e._v(" "),n("i-button",{attrs:{disabled:e.getNewVerifyLimit},on:{click:e.sendNewCaptcha}},[e._v(e._s(e.getNewVerifyBtnText))]),e._v(" "),n("span",{staticClass:"red"},[e._v(e._s(e.verifyNewCodeErr))])],1),e._v(" "),n("br"),e._v(" "),n("Row",[n("span",{staticClass:"lebalFont"}),e._v(" "),e.getNewVerifyLimit?e._e():n("span",{staticClass:"getVerifyTipsNotLimit"},[n("Icon",{attrs:{type:"paper-airplane"}}),e._v("请发送验证码")],1),e._v(" "),e.getNewVerifyLimit?n("span",{staticClass:"getVerifyTipsLimit"},[n("Icon",{attrs:{type:"checkmark-circled"}}),e._v("验证码已发送，请查看")],1):e._e()]),e._v(" "),n("br"),e._v(" "),n("Row",[n("span",{staticClass:"lebalFont"}),e._v(" "),n("i-button",{staticStyle:{width:"160px","margin-left":"15px"},attrs:{type:"warning"},on:{click:e.toStep2}},[e._v("下一步")])],1)],1):e._e(),e._v(" "),2==e.currentStep?n("div",[n("Row",[n("span",{staticClass:"lebalFont"}),e._v(" "),n("span",{staticClass:"getVerifyTipsLimit"},[n("Icon",{attrs:{type:"checkmark-circled"}}),e._v("恭喜您，操作执行成功！")],1)]),e._v(" "),n("br"),e._v(" "),n("Row",[n("span",{staticClass:"lebalFont"}),e._v(" "),n("i-button",{staticStyle:{width:"160px","margin-left":"15px"},attrs:{type:"warning"},on:{click:e.finish}},[e._v("返回")])],1),e._v(" "),n("br")],1):e._e()],1)],1)])},i=[];a._withStripped=!0;var r={render:a,staticRenderFns:i};t.default=r},862:function(e,t,n){"use strict";function a(e){c||n(2575)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1751),r=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,function(){return i[e]})}(s);var o=n(2577),l=n.n(o),c=!1,u=n(13),p=a,d=u(r.a,l.a,!1,p,"data-v-48a4a383",null);d.options.__file="src/views/trader-manage/information-manage/security-setting/modify-phone.vue",t.default=d.exports},898:function(e,t,n){"use strict";function a(e,t){if(!t)var t="yyyy-MM-DD hh:mm:ss";var n={"M+":e.getMonth()+1,"D+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in n)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[a]:("00"+n[a]).substr((""+n[a]).length)));return t}function i(e,t){if(!t)var t="yyyy-MM-dd";(e=Number(e))<1e10&&(e*=1e3);var n=new Date(e),a={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in a)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[i]:("00"+a[i]).substr((""+a[i]).length)));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.formatDate=a,t.timestampToDay=i}});