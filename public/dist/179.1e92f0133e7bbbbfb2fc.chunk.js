webpackJsonp([179],{1750:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=i(241),n=a(r),s=i(242),o=a(s),l=(i(898),i(239)),c=a(l);t.default={data:function(){return{apiGroup:this.$util.apiConfig.traderManage.infoManage.securitySetting,getVerifyBtnText:"发送验证码",getVerifyLimit:!1,currentStep:0,smsType:"",email:"",phone:"",nickname:"",oldPassword:"",verifyCode:"",timer:"",timer1:"",keyCode:"",verifyCodeErr:"",newMailNo:"",verifyNewCode:"",codeNewKey:"",getNewVerifyLimit:!1,getNewVerifyBtnText:"发送验证码",verifyNewCodeErr:"",uid:"",verifyNewMailErr:""}},created:function(){var e=this;"New"==this.$route.query.isNew&&(this.currentStep=1),this.timer=setInterval(function(){if(localStorage.modifyMailGetVerifyCodeTimestamp){var t=(new Date).getTime(),i=t-localStorage.modifyMailGetVerifyCodeTimestamp;i<9e4?(e.getVerifyLimit=!0,e.getVerifyBtnText="发送验证码"+Math.ceil((9e4-i)/1e3)+"s"):(e.getVerifyLimit=!1,e.getVerifyBtnText="发送验证码")}else e.getVerifyLimit=!1,e.getVerifyBtnText="发送验证码"},500),this.timer1=setInterval(function(){if(localStorage.modifyMailGetVerifyCodeTimestamp1){var t=(new Date).getTime(),i=t-localStorage.modifyMailGetVerifyCodeTimestamp1;i<9e4?(e.getNewVerifyLimit=!0,e.getNewVerifyBtnText="发送验证码"+Math.ceil((9e4-i)/1e3)+"s"):(e.getNewVerifyLimit=!1,e.getNewVerifyBtnText="发送验证码")}else e.getNewVerifyLimit=!1,e.getNewVerifyBtnText="发送验证码"},500),this.$util.ajax.post(this.apiGroup.getSellInfo).then(function(t){console.log("修改绑定邮箱返回数据：",t);var i=t.data.result;200==t.data.code?(e.userType=i.userType,e.nickname=i.nickname,e.uid=i.uid,""!=i.umobile&&void 0!=i.umobile&&null!=i.umobile&&(e.smsType="2",e.phone=i.umobile),""!=i.userEmail&&void 0!=i.userEmail&&null!=i.userEmail&&(e.smsType="1",e.email=i.userEmail)):e.$Modal.error({title:"HTTP请求错误",content:t.data.message})}).catch(function(t){e.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},methods:{finish:function(){this.$router.push({name:"security-setting"})},checkNewMailNo:function(e){return""==e.target.value?(this.verifyNewMailErr="请输入电子邮箱！",!1):/^([0-9a-zA-Z_\.-]+)@([0-9a-zA-Z\.-]+)\.([a-z]{2,6})$/.test(e.target.value)?void(this.verifyNewMailErr=""):(this.verifyNewMailErr="无效的电子邮箱",!1)},checkVerifyCode:function(e){var t=this;if(6==e.target.value.length){var i={code:this.verifyCode,codeKey:this.keyCode};this.$util.ajax.post(this.apiGroup.checkkeyCode,c.default.stringify(i)).then(function(e){e.message||(t.verifyCodeErr="验证码不正确")})}},checkVerifyNewCode:function(e){var t=this;if(6==e.target.value.length){var i={code:e.target.value,codeKey:this.codeNewKey};this.$util.ajax.post(this.apiGroup.checkkeyCode,c.default.stringify(i)).then(function(e){e.message||(t.verifyNewCodeErr="验证码不正确")})}},sendCaptcha:function(){function e(){return t.apply(this,arguments)}var t=(0,o.default)(n.default.mark(function e(){var t,i;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={type:this.smsType},"1"==this.smsType?(t.address=this.email,t.smsType="EMAIL_UP_BIND_EMAIL"):"2"==this.smsType&&(t.address=this.phone,t.smsType="UPBINDEMAIL"),e.next=5,this.$util.ajax.post(this.apiGroup.getkeyCode,c.default.stringify(t));case 5:i=e.sent,2==i.data.isOK?(localStorage.modifyMailGetVerifyCodeTimestamp=(new Date).getTime(),this.getVerifyLimit=!0,this.keyCode=i.data.codeKey):1==i.data.isOK&&this.$Modal.error({title:"验证码发送失败",content:i.data.message}),console.log(i),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])}));return e}(),sendNewCaptcha:function(){function e(){return t.apply(this,arguments)}var t=(0,o.default)(n.default.mark(function e(){var t,i,a,r;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=this.newMailNo){e.next=3;break}return this.$Message.error({content:"输入邮箱为空",duration:2}),e.abrupt("return",!1);case 3:if(t=/^([0-9a-zA-Z_\.-]+)@([0-9a-zA-Z\.-]+)\.([a-z]{2,6})$/,t.test(this.newMailNo)){e.next=8;break}return this.verifyNewMailErr="无效的电子邮箱",this.$Message.error({content:"无效的电子邮箱",duration:2}),e.abrupt("return",!1);case 8:return e.prev=8,e.next=11,this.$util.ajax.post(this.apiGroup.checkNewMailNo,c.default.stringify({personalMailInput_div:this.newMailNo}));case 11:if(i=e.sent,i.data){e.next=15;break}return this.$Modal.error({title:"输入邮箱号码有误",content:"输入的邮箱号码已存在，请输入新的邮箱号码！"}),e.abrupt("return",!1);case 15:return a={type:3,smsType:"EMAIL_BIND_EMAIL",contact:this.newMailNo},e.next=18,this.$util.ajax.post(this.apiGroup.getkeyCode,c.default.stringify(a));case 18:r=e.sent,2==r.data.isOK?(localStorage.modifyMailGetVerifyCodeTimestamp1=(new Date).getTime(),this.getNewVerifyLimit=!0,this.codeNewKey=r.data.codeKey):1==r.data.isOK&&this.$Modal.error({title:"验证码发送失败",content:r.data.message}),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(8),console.log(e.t0);case 25:case"end":return e.stop()}},e,this,[[8,22]])}));return e}(),nextStep:function(){function e(){return t.apply(this,arguments)}var t=(0,o.default)(n.default.mark(function e(){var t,i,a;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(6!=this.verifyCode.length){e.next=21;break}return t=this.keyCode,i={code:this.verifyCode,codeKey:t},e.prev=3,e.next=6,this.$util.ajax.post(this.apiGroup.checkkeyCode,c.default.stringify(i));case 6:if(a=e.sent,console.log(a),a.data.message){e.next=13;break}return this.$Modal.error({title:"校验码错误",content:"请填写正确的校验码"}),e.abrupt("return");case 13:this.currentStep=1;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),this.$Modal.error({title:"校验码验证请求失败",content:"校验码验证请求失败"});case 19:e.next=23;break;case 21:return this.$Modal.error({title:"校验码错误",content:"请填写正确的校验码"}),e.abrupt("return");case 23:case"end":return e.stop()}},e,this,[[3,16]])}));return e}(),toStep2:function(){function e(){return t.apply(this,arguments)}var t=(0,o.default)(n.default.mark(function e(){var t,i,a,r,s,o;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=this.newMailNo){e.next=3;break}return this.$Modal.error({title:"输入为空",content:"请输入电子邮箱！"}),e.abrupt("return",!1);case 3:if(t=/^([0-9a-zA-Z_\.-]+)@([0-9a-zA-Z\.-]+)\.([a-z]{2,6})$/,t.test(this.newMailNo)){e.next=8;break}return this.verifyNewMailErr="无效的电子邮箱",this.$Modal.error({title:"输入有误",content:"无效的电子邮箱!"}),e.abrupt("return",!1);case 8:return e.prev=8,e.next=11,this.$util.ajax.post(this.apiGroup.checkNewMailNo,c.default.stringify({personalMailInput_div:this.newMailNo}));case 11:if(i=e.sent,i.data){e.next=15;break}return this.$Modal.error({title:"输入邮箱有误",content:"输入的邮箱已存在，请输入新邮箱！"}),e.abrupt("return",!1);case 15:return a={code:this.verifyNewCode,codeKey:this.codeNewKey},e.next=18,this.$util.ajax.post(this.apiGroup.checkkeyCode,c.default.stringify(a));case 18:if(r=e.sent,r.data.message){e.next=23;break}return this.verifyNewCodeErr="验证码不正确",this.$Modal.error({title:"验证码不正确",content:"验证码不正确"}),e.abrupt("return",!1);case 23:return s={address:this.newMailNo,changeType:"mail",uid:this.uid},e.next=26,this.$util.ajax.post(this.apiGroup.modifyBindPhoneOrMail,c.default.stringify(s));case 26:o=e.sent,console.log(o),o.data.result?this.currentStep=2:this.$Modal.error({title:"修改失败",content:o.data.message}),e.next=34;break;case 31:e.prev=31,e.t0=e.catch(8),console.log(e.t0);case 34:case"end":return e.stop()}},e,this,[[8,31]])}));return e}()},beforeDestroy:function(){clearInterval(this.timer),clearInterval(this.timer1)}}},2572:function(e,t,i){var a=i(2573);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(43)("04be9f1a",a,!1,{})},2573:function(e,t,i){t=e.exports=i(42)(!1),t.push([e.i,'\n.cmain[data-v-1c6b26b2] {\n    background-color: white;\n    position: relative;\n    /* min-width: 1020px; */\n}\n.lebalFont[data-v-1c6b26b2] {\n    display: inline-block;\n    width: 300px;\n    text-align: right;\n}\n.nessaryIcon[data-v-1c6b26b2] {\n    color: #0099ff;\n}\n.red[data-v-1c6b26b2] {\n    color: red;\n}\n.blue[data-v-1c6b26b2] {\n    color: rgb(0, 153, 255);\n}\n.infoColor[data-v-1c6b26b2] {\n    color: rgb(222,222,222)\n}\n.bg_09[data-v-1c6b26b2] {\n    background: #caecb6;\n}\n.bg_10[data-v-1c6b26b2] {\n    background: #7abd54;\n}\n.bg_11[data-v-1c6b26b2] {\n    background: #69a348;\n}\n.green[data-v-1c6b26b2] {\n    color: green;\n}\n.font_12[data-v-1c6b26b2] {\n    font-size: 12px;\n    font-family: "\\5B8B\\4F53   Std L";\n    width: 30px;\n    height: 13px!important;\n    margin-right: 5px;\n    line-height: 13px!important;\n    color: #fff;\n    text-align: center;\n    display: inline-block;\n}\n.getVerifyTipsNotLimit[data-v-1c6b26b2] {\n    font-weight: bold;\n    line-height: 40px;\n    font-size: 18px;\n    margin-left: 15px;\n    color: #747474;\n}\n.getVerifyTipsLimit[data-v-1c6b26b2] {\n    font-weight: bold;\n    line-height: 40px;\n    font-size: 18px;\n    margin-left: 15px;\n    color: #EE6B2B;\n}\n\n',""])},2574:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cmain"},[i("div",{staticStyle:{padding:"20px 50px"}},[i("h3",[e._v("安全信息设置>修改绑定电话")]),e._v(" "),i("br"),e._v(" "),i("Card",[i("br"),e._v(" "),i("br"),e._v(" "),i("Row",[i("Steps",{staticStyle:{"margin-left":"50px"},attrs:{current:e.currentStep}},[i("Step",{attrs:{title:"验证身份"}}),e._v(" "),i("Step",{attrs:{title:"设置绑定信息"}}),e._v(" "),i("Step",{attrs:{title:"完成"}})],1)],1),e._v(" "),i("br"),e._v(" "),i("br"),e._v(" "),0==e.currentStep?i("div",[i("Row",[i("span",{staticClass:"lebalFont"},[e._v("请选择验证身份方式：")]),e._v(" "),i("i-select",{staticStyle:{width:"250px","margin-left":"15px"},attrs:{disabled:e.getVerifyLimit},model:{value:e.smsType,callback:function(t){e.smsType=t},expression:"smsType"}},[e.email?i("i-option",{attrs:{value:"1"}},[e._v(e._s(e.email))]):e._e(),e._v(" "),e.phone?i("i-option",{attrs:{value:"2"}},[e._v(e._s(e.phone))]):e._e()],1)],1),e._v(" "),i("br"),e._v(" "),i("Row",[i("span",{staticClass:"lebalFont"},[e._v("昵称：")]),e._v(" "),i("Input",{staticStyle:{width:"250px","margin-left":"15px"},attrs:{readonly:""},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}})],1),e._v(" "),i("br"),e._v(" "),i("Row",[i("span",{staticClass:"lebalFont"},[i("i",{staticClass:"nessaryIcon"},[e._v("*")]),e._v("校验码：")]),e._v(" "),i("Input",{staticStyle:{width:"155px","margin-left":"15px"},on:{"on-blur":e.checkVerifyCode},model:{value:e.verifyCode,callback:function(t){e.verifyCode="string"==typeof t?t.trim():t},expression:"verifyCode"}}),e._v(" "),i("i-button",{attrs:{disabled:e.getVerifyLimit},on:{click:e.sendCaptcha}},[e._v(e._s(e.getVerifyBtnText))]),e._v(" "),i("span",{staticClass:"red"},[e._v(e._s(e.verifyCodeErr))])],1),e._v(" "),i("br"),e._v(" "),i("Row",[i("span",{staticClass:"lebalFont"}),e._v(" "),e.getVerifyLimit?e._e():i("span",{staticClass:"getVerifyTipsNotLimit"},[i("Icon",{attrs:{type:"paper-airplane"}}),e._v("请发送验证码")],1),e._v(" "),e.getVerifyLimit?i("span",{staticClass:"getVerifyTipsLimit"},[i("Icon",{attrs:{type:"checkmark-circled"}}),e._v("验证码已发送，请查看")],1):e._e()]),e._v(" "),i("br"),e._v(" "),i("Row",[i("span",{staticClass:"lebalFont"}),e._v(" "),i("i-button",{staticStyle:{width:"160px","margin-left":"15px"},attrs:{type:"warning"},on:{click:e.nextStep}},[e._v("下一步")])],1),e._v(" "),i("br"),e._v(" "),i("br")],1):e._e(),e._v(" "),1==e.currentStep?i("div",[i("Row",[i("span",{staticClass:"lebalFont"},[e._v("输入新电子邮箱：")]),e._v(" "),i("Input",{staticStyle:{width:"250px","margin-left":"15px"},on:{"on-blur":e.checkNewMailNo},model:{value:e.newMailNo,callback:function(t){e.newMailNo="string"==typeof t?t.trim():t},expression:"newMailNo"}}),e._v(" "),i("span",{staticClass:"red"},[e._v(e._s(e.verifyNewMailErr))])],1),e._v(" "),i("br"),e._v(" "),i("Row",[i("span",{staticClass:"lebalFont"},[i("i",{staticClass:"nessaryIcon"},[e._v("*")]),e._v("校验码：")]),e._v(" "),i("Input",{staticStyle:{width:"155px","margin-left":"15px"},on:{"on-blur":e.checkVerifyNewCode},model:{value:e.verifyNewCode,callback:function(t){e.verifyNewCode="string"==typeof t?t.trim():t},expression:"verifyNewCode"}}),e._v(" "),i("i-button",{attrs:{disabled:e.getNewVerifyLimit},on:{click:e.sendNewCaptcha}},[e._v(e._s(e.getNewVerifyBtnText))]),e._v(" "),i("span",{staticClass:"red"},[e._v(e._s(e.verifyNewCodeErr))])],1),e._v(" "),i("br"),e._v(" "),i("Row",[i("span",{staticClass:"lebalFont"}),e._v(" "),e.getNewVerifyLimit?e._e():i("span",{staticClass:"getVerifyTipsNotLimit"},[i("Icon",{attrs:{type:"paper-airplane"}}),e._v("请发送验证码")],1),e._v(" "),e.getNewVerifyLimit?i("span",{staticClass:"getVerifyTipsLimit"},[i("Icon",{attrs:{type:"checkmark-circled"}}),e._v("验证码已发送，请查看")],1):e._e()]),e._v(" "),i("br"),e._v(" "),i("Row",[i("span",{staticClass:"lebalFont"}),e._v(" "),i("i-button",{staticStyle:{width:"160px","margin-left":"15px"},attrs:{type:"warning"},on:{click:e.toStep2}},[e._v("下一步")])],1)],1):e._e(),e._v(" "),2==e.currentStep?i("div",[i("Row",[i("span",{staticClass:"lebalFont"}),e._v(" "),i("span",{staticClass:"getVerifyTipsLimit"},[i("Icon",{attrs:{type:"checkmark-circled"}}),e._v("恭喜您，操作执行成功！")],1)]),e._v(" "),i("br"),e._v(" "),i("Row",[i("span",{staticClass:"lebalFont"}),e._v(" "),i("i-button",{staticStyle:{width:"160px","margin-left":"15px"},attrs:{type:"warning"},on:{click:e.finish}},[e._v("返回")])],1),e._v(" "),i("br")],1):e._e()],1)],1)])},r=[];a._withStripped=!0;var n={render:a,staticRenderFns:r};t.default=n},861:function(e,t,i){"use strict";function a(e){c||i(2572)}Object.defineProperty(t,"__esModule",{value:!0});var r=i(1750),n=i.n(r);for(var s in r)"default"!==s&&function(e){i.d(t,e,function(){return r[e]})}(s);var o=i(2574),l=i.n(o),c=!1,u=i(13),p=a,d=u(n.a,l.a,!1,p,"data-v-1c6b26b2",null);d.options.__file="src/views/trader-manage/information-manage/security-setting/modify-mail.vue",t.default=d.exports},898:function(e,t,i){"use strict";function a(e,t){if(!t)var t="yyyy-MM-DD hh:mm:ss";var i={"M+":e.getMonth()+1,"D+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in i)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?i[a]:("00"+i[a]).substr((""+i[a]).length)));return t}function r(e,t){if(!t)var t="yyyy-MM-dd";(e=Number(e))<1e10&&(e*=1e3);var i=new Date(e),a={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in a)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[r]:("00"+a[r]).substr((""+a[r]).length)));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.formatDate=a,t.timestampToDay=r}});