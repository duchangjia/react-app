webpackJsonp([185],{1686:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(898),r=a(239),l=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default={data:function(){var t=this;return{apiGroup:this.$util.apiConfig.purchaseDelivery.sendManage.mergeCarBillList,query:{deliveryCarBillNo:"",driverName:"",status:"",createStartTime:"",createEndTime:""},columns1:[{type:"selection",minWidth:60,align:"center",fixed:"left"},{title:"序号",type:"index",minWidth:60,fixed:"left"},{title:"拼车单号",key:"deliveryCarBillNo",minWidth:170},{title:"创建时间",key:"createTime",width:100},{title:"总重量",key:"totalWeight",minWidth:90},{title:"总体积",key:"totalVolume",minWidth:90},{title:"总金额",key:"totalPrice",minWidth:120},{title:"车牌号",key:"carPlateNo",minWidth:110},{title:"司机姓名",key:"driverName",minWidth:110},{title:"联系方式",key:"driverContact",minWidth:150},{title:"状态",key:"status",minWidth:80}],entity:[{deliveryCarBillNo:"777777777",createTime:1530496188,totalWeight:4.5,totalVolume:7,totalPrice:4444.55,carPlateNo:"43124",driverName:"老司机",driverContact:"54314514553454",status:"0"}],billDetial:{carPlateNo:"粤A520",carLoad:6.9,carCapacity:78,driverName:"老司机",driverContact:"1368876667888"},columns2:[{title:"序号",key:"index",width:60},{title:"发货单号",key:"orderNo",width:170},{title:"门店",key:"storeName"},{title:"发货仓库",key:"warehouseName",width:170},{title:"预占整件数",key:"carNum"},{title:"预占散个数",key:"eaNum"},{title:"可发货总重量",key:"totalWeight"},{title:"可发货总体积",key:"totalVolume"},{title:"装车顺序",key:"shipSequence"}],pinCheDetailBillList:[],showOrderDetail:!1,pager:{},loading:!1,createDateOptions:{disabledDate:function(e){return e&&e.valueOf()<new Date(t.query.createStartTime)}}}},created:function(){console.log("purchase-send-list created"),this.jumpPageHandle(1)},methods:{closeOrderDetail:function(){this.showOrderDetail=!1},shipSTimeChangeHandle:function(t){this.query.createStartTime=t,this.query.createStartTime>this.query.createEndTime&&(this.query.createEndTime="")},shipETimeChangeHandle:function(t){this.query.createEndTime=t},openOrder:function(t){var e=this;console.log(t),this.loading=!0,this.$util.ajax.post(this.apiGroup.getDetailUrl,l.default.stringify({code:t.deliveryCarBillNo})).then(function(t){if(200==t.status){e.loading=!1,console.log("getted order:"),console.log(t),e.billDetial=t.data;var a=t.data.waybillList;e.pinCheDetailBillList=[];for(var i=e.pinCheDetailBillList,r=0,l=0,o=0,n=0,s=0;s<a.length;s++)i.push({index:s+1,orderNo:a[s].orderNo,storeName:a[s].storeName,warehouseName:a[s].warehouseName,carNum:a[s].carNum,eaNum:a[s].eaNum,totalWeight:a[s].totalWeight,totalVolume:a[s].totalVolume,shipSequence:a[s].shipSequence}),r+=Number(a[s].carNum),l+=Number(a[s].eaNum),o+=Number(a[s].totalWeight),n+=Number(a[s].totalVolume);i.push({index:"合计",carNum:r,eaNum:l,totalWeight:o.toFixed(2),totalVolume:n.toFixed(2)}),e.showOrderDetail=!0}else e.$Modal.error({title:"HTTP请求错误",content:t.statusText})}).catch(function(t){console.log(t),e.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},jumpPageHandle:function(t){var e=this;this.pager.page=t;var a={currentPage:this.pager.page,deliveryCarBillNo:this.query.deliveryCarBillNo,driverName:this.query.driverName,status:this.query.status,createStartTime:this.query.createStartTime,createEndTime:this.query.createEndTime};this.loading=!0,this.$util.ajax.post(this.apiGroup.listUrl,l.default.stringify(a),{headers:{Accept:"text/html;charset=UTF-8"},responseType:"text"}).then(function(t){if(200==t.status){e.loading=!1,console.log("拼车单列表获得数据：",t),e.pager=t.data.result.pager,e.entity=t.data.result.resultList;for(var a=0;a<e.entity.length;a++)e.entity[a].createTime=(0,i.timestampToDay)(e.entity[a].createTime,"yyyy-MM-dd hh:mm:ss"),"0"==e.entity[a].status?e.entity[a].status="待拣配":"10"==e.entity[a].status&&(e.entity[a].status="已拣配")}else e.$Modal.error({title:"HTTP请求错误",content:t.statusText})}).catch(function(t){console.log(t),e.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},lookup:function(){console.log("lookup"),this.jumpPageHandle(1)},canclePinChe:function(){var t=this,e=this.$refs.selection.getSelection();return e.length<1?void this.$Modal.error({title:"选择数据错误",content:"请选择一条数据！"}):e.length>1?void this.$Modal.error({title:"选择数据错误",content:"不能选择多条数据！"}):(console.log("取消拼车单参数：",e),this.loading=!0,console.log(this.apiGroup.getDetailUrl),void this.$util.ajax.post(this.apiGroup.getDetailUrl,l.default.stringify({code:e[0].deliveryCarBillNo})).then(function(a){if(console.log(a),a.status=200){t.loading=!1;for(var i=a.data.waybillList,r=!0,o=0;o<i.length;o++)if(20==i[o].status||30==i[o].status)return r=!1,void t.$Modal.error({title:"取消拼单失败",content:"已出库的订单不能取消拼车！"});r&&(t.loading=!0,t.$util.ajax.post(t.apiGroup.canclePingCheUrl,l.default.stringify({code:e[0].deliveryCarBillNo})).then(function(e){console.log("取消拼车返回数据：",e),t.loading=!1,200==e.status?t.$Modal.success({title:"取消成功!",content:"拼车单取消成功",onOk:function(){t.jumpPageHandle(1)}}):t.$Modal.error({title:"取消拼单失败",content:"取消拼单失败"})}).catch(function(e){t.$Modal.error({title:"取消拼单失败",content:"调用接口失败，请检查网络"})}))}else t.$Modal.error({title:"取消拼单失败",content:a.statusText})}).catch(function(e){t.$Modal.error({title:"取消拼单失败",content:"调用接口失败，请检查网络"})}))}}}},2331:function(t,e,a){var i=a(2332);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(43)("00a53a9b",i,!1,{})},2332:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.cmain[data-v-9956bc1a] {\n  background-color: white;\n  position: relative;\n  /* min-width: 1020px; */\n}\n#inputItem[data-v-9956bc1a] {\n  border-left: 1px dashed #dddee1;\n}\n.qianshouCol .ivu-col[data-v-9956bc1a] {\n  margin: 5px 0px;\n}\n.line[data-v-9956bc1a] {\n  border-bottom: 1px solid #dddee1;\n}\n",""])},2333:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmain"},[a("div",{staticStyle:{padding:"20px 50px"}},[a("Row",{staticClass:"checkForm"},[a("Col",{attrs:{span:"20"}},[a("Row",[a("Col",{attrs:{sm:12,md:8,lg:8}},[a("span",[t._v("拼车单号")]),t._v(" "),a("Input",{staticStyle:{width:"143px","margin-left":"15px"},attrs:{type:"text"},model:{value:t.query.deliveryCarBillNo,callback:function(e){t.$set(t.query,"deliveryCarBillNo","string"==typeof e?e.trim():e)},expression:"query.deliveryCarBillNo"}})],1),t._v(" "),a("Col",{attrs:{sm:24,md:16,lg:16}},[a("span",[t._v("创建时间")]),t._v(" "),a("date-picker",{staticStyle:{width:"143px","margin-left":"15px"},attrs:{value:t.query.createStartTime,format:"yyyy-MM-dd",type:"date",placeholder:"请选择时间"},on:{"on-change":t.shipSTimeChangeHandle}}),t._v(" "),a("i",{staticClass:"demo-icons"},[t._v("-")]),t._v(" "),a("date-picker",{staticStyle:{width:"143px"},attrs:{value:t.query.createEndTime,options:t.createDateOptions,format:"yyyy-MM-dd",type:"date",placeholder:"请选择时间"},on:{"on-change":t.shipETimeChangeHandle}})],1)],1),t._v(" "),a("br"),t._v(" "),a("Row",[a("Col",{attrs:{sm:12,md:10,lg:8}},[a("span",[t._v("司机名称")]),t._v(" "),a("Input",{staticStyle:{width:"143px","margin-left":"15px"},attrs:{type:"text"},model:{value:t.query.driverName,callback:function(e){t.$set(t.query,"driverName","string"==typeof e?e.trim():e)},expression:"query.driverName"}})],1),t._v(" "),a("Col",{attrs:{sm:12,md:10,lg:8}},[a("span",[t._v("状态")]),t._v(" "),a("i-select",{staticStyle:{width:"143px","margin-left":"15px"},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},[a("i-option",{attrs:{value:""}},[t._v("请选择")]),t._v(" "),a("i-option",{attrs:{value:"0"}},[t._v("待拣配")]),t._v(" "),a("i-option",{attrs:{value:"10"}},[t._v("已拣配")])],1)],1)],1)],1),t._v(" "),a("Col",{attrs:{span:"4",id:"inputItem"}},[a("Row",[a("i-button",{staticStyle:{width:"115px",margin:"0 20px"},attrs:{type:"primary"},on:{click:t.lookup}},[t._v("查询")])],1),t._v(" "),a("br"),t._v(" "),a("Row",[a("i-button",{staticStyle:{width:"115px",margin:"0 20px"},attrs:{type:"primary"},on:{click:t.canclePinChe}},[t._v("取消拼车")])],1)],1)],1),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"line"}),t._v(" "),a("br"),t._v(" "),a("Table",{ref:"selection",attrs:{stripe:"",columns:t.columns1,data:t.entity},on:{"on-row-click":t.openOrder}}),t._v(" "),a("Row",{staticStyle:{margin:"10px"},attrs:{type:"flex",justify:"end"}},[a("page",{attrs:{current:t.pager.page,total:t.pager.totalCount,"page-size":t.pager.pageCode,"show-elevator":"","show-total":""},on:{"on-change":t.jumpPageHandle}})],1)],1),t._v(" "),a("modal",{attrs:{width:"1200",title:"拼车单详情"},model:{value:t.showOrderDetail,callback:function(e){t.showOrderDetail=e},expression:"showOrderDetail"}},[a("div",[a("Row",[a("Col",{attrs:{span:"5"}},[a("span",[t._v("车牌号：")]),t._v(" "),a("span",[t._v(t._s(t.billDetial.carPlateNo))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("载重：")]),t._v(" "),a("span",[t._v(t._s(t.billDetial.carLoad))])]),t._v(" "),a("Col",{attrs:{span:"5"}},[a("span",[t._v("容积：")]),t._v(" "),a("span",[t._v(t._s(t.billDetial.carCapacity))])]),t._v(" "),a("Col",{attrs:{span:"5"}},[a("span",[t._v("司机：")]),t._v(" "),a("span",[t._v(t._s(t.billDetial.driverName))])]),t._v(" "),a("Col",{attrs:{span:"5"}},[a("span",[t._v("联系方式：")]),t._v(" "),a("span",[t._v(t._s(t.billDetial.driverContact))])])],1),t._v(" "),a("br"),t._v(" "),a("div",{staticStyle:{"overflow-y":"auto"}},[a("Table",{attrs:{stripe:"",columns:t.columns2,data:t.pinCheDetailBillList}})],1),t._v(" "),a("br")],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{staticStyle:{width:"92px"},attrs:{type:"primary"},on:{click:t.closeOrderDetail}},[t._v("确认")]),t._v(" "),a("i-button",{staticStyle:{width:"92px"},on:{click:t.closeOrderDetail}},[t._v("取消")])],1)]),t._v(" "),t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},r=[];i._withStripped=!0;var l={render:i,staticRenderFns:r};e.default=l},803:function(t,e,a){"use strict";function i(t){c||a(2331)}Object.defineProperty(e,"__esModule",{value:!0});var r=a(1686),l=a.n(r);for(var o in r)"default"!==o&&function(t){a.d(e,t,function(){return r[t]})}(o);var n=a(2333),s=a.n(n),c=!1,d=a(13),u=i,p=d(l.a,s.a,!1,u,"data-v-9956bc1a",null);p.options.__file="src/views/purchase-send/send-manage/merge-car-bill-list/merge-car-bill-list.vue",e.default=p.exports},898:function(t,e,a){"use strict";function i(t,e){if(!e)var e="yyyy-MM-DD hh:mm:ss";var a={"M+":t.getMonth()+1,"D+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in a)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?a[i]:("00"+a[i]).substr((""+a[i]).length)));return e}function r(t,e){if(!e)var e="yyyy-MM-dd";(t=Number(t))<1e10&&(t*=1e3);var a=new Date(t),i={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in i)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[r]:("00"+i[r]).substr((""+i[r]).length)));return e}Object.defineProperty(e,"__esModule",{value:!0}),e.formatDate=i,e.timestampToDay=r}});