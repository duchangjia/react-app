webpackJsonp([186],{1685:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(a(898),a(239)),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default={data:function(){return{apiGroup:this.$util.apiConfig.purchaseDelivery.repertoryManage.repertoryCheck,query:{materialName79:"",materialCode79:"",materialCode69:""},columns1:[{title:"序号",type:"index",minWidth:60,fixed:"left"},{title:"条形码",key:"materialCode69",minWidth:150},{title:"商品名称",key:"materialName79",minWidth:250},{title:"可用整件数",key:"validBoxNum",minWidth:100},{title:"可用散个数",key:"validSingleNum",minWidth:100},{title:"锁定整件数",key:"reservedBoxNum",minWidth:100},{title:"锁定散个数",key:"reservedSingleNum",minWidth:100},{title:"合计整件",key:"totalBoxNum",minWidth:100},{title:"合计散个",key:"totalSingleNum",minWidth:100},{title:"总计数量",key:"totalNum",minWidth:100}],entity:[],columns2:[{title:"仓库编码",key:"warehouseCode",minWidth:180},{title:"仓库名称",key:"warehouseName",minWidth:180},{title:"条形码",key:"materialCode69",minWidth:100},{title:"商品名称",key:"materialName79",minWidth:280},{title:"可用整件",key:"validBoxNum",minWidth:70},{title:"可用散个",key:"validSingleNum",minWidth:70},{title:"锁定整件",key:"reservedBoxNum",minWidth:70},{title:"锁定散个",key:"reservedSingleNum",minWidth:70},{title:"合计整件",key:"totalBoxNum",minWidth:70},{title:"合计散个",key:"totalSingleNum",minWidth:70}],productList:[],showProduceDetail:!1,detail_list:{},pager:{},loading:!1,exportBtnText:"导出",isExportDataLimit:!0,timer:null}},created:function(){var t=this;console.log("purchase-send-list created"),this.timer=setInterval(function(){if(localStorage.repertoryCheckExportDataTimestamp){var e=(new Date).getTime(),a=e-localStorage.repertoryCheckExportDataTimestamp;a<6e4?(t.isExportDataLimit=!0,t.exportBtnText="导出"+Math.ceil((6e4-a)/1e3)+"s"):(t.isExportDataLimit=!1,t.exportBtnText="导出")}else t.isExportDataLimit=!1,t.exportBtnText="导出"},500),this.jumpPageHandle(1)},beforeDestroy:function(){clearInterval(this.timer),console.log("purchase-send-list beforeDestroy")},methods:{closeOrderDetail:function(){this.showProduceDetail=!1},openOrder:function(t){var e=this;console.log(t),this.loading=!0;var a={code:t.materialCode79};this.$util.ajax.post(this.apiGroup.getDetailUrl,r.default.stringify(a)).then(function(t){e.loading=!1,console.log("采购发货单请求返回数据：",t),200==t.status?(e.showProduceDetail=!0,e.productList=t.data):e.$Modal.error({title:"HTTP请求错误",content:t.statusText})}).catch(function(t){console.log(t),e.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},jumpPageHandle:function(t){var e=this;this.pager.page=t,this.loading=!0;var a={currentPage:this.pager.page,materialName79:this.query.materialName79,materialCode79:this.query.materialCode79,materialCode69:this.query.materialCode69};this.$util.ajax.post(this.apiGroup.listUrl,r.default.stringify(a)).then(function(t){e.loading=!1,console.log("采购发货单请求返回数据：",t),200==t.status?(e.pager=t.data.result.pager,e.entity=t.data.result.resultList,e.entity.forEach(function(t){t.totalNum=Number(t.validNum)+Number(t.reservedNum)})):e.$Modal.error({title:"HTTP请求错误",content:t.statusText})}).catch(function(t){console.log(t),e.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},exportDate:function(){var t=this;console.log("exportDate"),this.$Modal.confirm({title:"导出数据提示",content:"是否确认导出？",onOk:function(){console.log("发送导出请求"),localStorage.repertoryCheckExportDataTimestamp=(new Date).getTime(),t.isExportDataLimit=!0;var e={currentPage:t.pager.page,materialName79:t.query.materialName79,materialCode79:t.query.materialCode79,materialCode69:t.query.materialCode69};t.$util.ajax.post(t.apiGroup.exportExcelUrl,r.default.stringify(e),{responseType:"blob"}).then(function(e){if(200==e.status){t.loading=!1,console.log("采购发货单导出请求返回数据：",e);var a=new Blob([e.data],{type:"application/x-xls"}),i=new Date,r="库存明细"+i.getFullYear().toString(),o=(i.getMonth()+1).toString();i.getMonth()+1<10&&(o="0"+(i.getMonth()+1).toString()),r+=o;var n=i.getDate().toString();i.getDate()<10&&(n="0"+i.getDate().toString()),r+=n;var l=i.getHours().toString();i.getHours()<10&&(n="0"+i.getHours().toString()),r+=l;var s=i.getMinutes().toString();i.getMinutes()<10&&(s="0"+i.getMinutes().toString()),r+=s;var u=i.getSeconds().toString();if(i.getSeconds()<10&&(u="0"+i.getSeconds().toString()),r+=u,r+=".xlsx",window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(a,r);else{var c=document.createElement("a");c.href=window.URL.createObjectURL(a),c.download=r,c.click(),window.URL.revokeObjectURL(c.href)}}else t.$Modal.error({title:"HTTP请求错误",content:e.statusText})}).catch(function(e){console.log(e),t.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})}})},lookup:function(){console.log("lookup"),this.jumpPageHandle(1)}}}},2328:function(t,e,a){var i=a(2329);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(43)("25e1d1e3",i,!1,{})},2329:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.cmain[data-v-2e819433] {\r\n  background-color: white;\r\n  position: relative;\r\n  /* min-width: 1020px; */\n}\n.store_detail_list li[data-v-2e819433] {\r\n  display: inline-block;\r\n  margin-right: 45px;\r\n  margin-bottom: 10px;\n}\n#checkForm .ivu-col[data-v-2e819433] {\r\n  margin: 10px 0px;\n}\r\n",""])},2330:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmain"},[a("div",{staticStyle:{padding:"20px 50px"}},[a("Row",{attrs:{id:"checkForm"}},[a("Col",{attrs:{sm:12,md:8,lg:8}},[a("span",[t._v("商品名称")]),t._v(" "),a("Input",{staticStyle:{width:"143px","margin-left":"15px"},attrs:{type:"text"},model:{value:t.query.materialName79,callback:function(e){t.$set(t.query,"materialName79","string"==typeof e?e.trim():e)},expression:"query.materialName79"}})],1),t._v(" "),a("Col",{attrs:{sm:12,md:12,lg:8}},[a("span",[t._v("销售编码")]),t._v(" "),a("Input",{staticStyle:{width:"143px","margin-left":"15px"},attrs:{type:"text"},model:{value:t.query.materialCode79,callback:function(e){t.$set(t.query,"materialCode79","string"==typeof e?e.trim():e)},expression:"query.materialCode79"}})],1),t._v(" "),a("Col",{attrs:{sm:12,md:8,lg:8}},[a("span",[t._v("条形码")]),t._v(" "),a("Input",{staticStyle:{width:"143px","margin-left":"15px"},attrs:{type:"text"},model:{value:t.query.materialCode69,callback:function(e){t.$set(t.query,"materialCode69","string"==typeof e?e.trim():e)},expression:"query.materialCode69"}})],1)],1),t._v(" "),a("br"),t._v(" "),a("Row",{attrs:{type:"flex",justify:"center"}},[a("Col",[a("i-button",{staticStyle:{width:"115px"},attrs:{type:"primary",disabled:t.isExportDataLimit},on:{click:t.exportDate}},[t._v(t._s(t.exportBtnText))]),t._v(" "),a("i-button",{staticStyle:{width:"115px","margin-left":"15px"},attrs:{type:"primary"},on:{click:t.lookup}},[t._v("查询")])],1)],1),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("Table",{attrs:{stripe:"",columns:t.columns1,data:t.entity},on:{"on-row-click":t.openOrder}}),t._v(" "),a("Row",{staticClass:"code-row-bg",staticStyle:{margin:"10px"},attrs:{type:"flex",justify:"end"}},[a("page",{attrs:{current:t.pager.page,total:t.pager.totalCount,"page-size":t.pager.pageCode,"show-elevator":"","show-total":""},on:{"on-change":t.jumpPageHandle}})],1)],1),t._v(" "),a("modal",{attrs:{title:"在库数据反查",width:"1200"},model:{value:t.showProduceDetail,callback:function(e){t.showProduceDetail=e},expression:"showProduceDetail"}},[a("div",[a("div",{staticClass:"tableStandard",staticStyle:{"overflow-y":"auto",height:"300px"}},[a("Table",{attrs:{stripe:"",columns:t.columns2,data:t.productList}})],1)]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{staticStyle:{width:"92px"},attrs:{type:"primary"},on:{click:t.closeOrderDetail}},[t._v("确认")]),t._v(" "),a("i-button",{staticStyle:{width:"92px"},on:{click:t.closeOrderDetail}},[t._v("取消")])],1)]),t._v(" "),t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},r=[];i._withStripped=!0;var o={render:i,staticRenderFns:r};e.default=o},802:function(t,e,a){"use strict";function i(t){u||a(2328)}Object.defineProperty(e,"__esModule",{value:!0});var r=a(1685),o=a.n(r);for(var n in r)"default"!==n&&function(t){a.d(e,t,function(){return r[t]})}(n);var l=a(2330),s=a.n(l),u=!1,c=a(13),d=i,p=c(o.a,s.a,!1,d,"data-v-2e819433",null);p.options.__file="src/views/purchase-send/repertory-manage/repertory-check.vue",e.default=p.exports},898:function(t,e,a){"use strict";function i(t,e){if(!e)var e="yyyy-MM-DD hh:mm:ss";var a={"M+":t.getMonth()+1,"D+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in a)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?a[i]:("00"+a[i]).substr((""+a[i]).length)));return e}function r(t,e){if(!e)var e="yyyy-MM-dd";(t=Number(t))<1e10&&(t*=1e3);var a=new Date(t),i={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in i)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[r]:("00"+i[r]).substr((""+i[r]).length)));return e}Object.defineProperty(e,"__esModule",{value:!0}),e.formatDate=i,e.timestampToDay=r}});