webpackJsonp([191],{1675:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(898),r=a(239),n=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default={data:function(){return{apiGroup:this.$util.apiConfig.purchaseDelivery.baseData.driverManage,exportBtnText:"导出到excel",isExportDataLimit:!0,timer:null,query:{driverName:"",gender:""},driverSelList:[{driverCode:"6666666",contact:"啊啊啊啊啊啊啊啊啊啊啊",driverName:"孙悟空"}],addData:{driverName:"芦苞镇车神",gender:"1",driverLicenseNo:"2222222222222",status:"禁用",contact:"",note:"客官，这只马跑得很快"},reviseData:{id:"",driverName:"芦苞镇车神",gender:"1",driverLicenseNo:"2222222222222",status:"禁用",contact:"",note:"客官，这只马跑得很快"},columns1:[{type:"selection",minWidth:60,align:"center",fixed:"left"},{title:"序号",type:"index",minWidth:60,fixed:"left"},{title:"姓名",key:"driverName",minWidth:100},{title:"性别",key:"gender",minWidth:80},{title:"驾驶证",key:"driverLicenseNo",minWidth:120},{title:"联系方式",key:"contact",minWidth:120},{title:"状态",key:"status",minWidth:100},{title:"备注",key:"note",minWidth:120},{title:"创建人",key:"creator",minWidth:100},{title:"创建时间",key:"createTime",minWidth:100},{title:"修改人",key:"updateUser",minWidth:100},{title:"修改时间",key:"updateTime",minWidth:100}],entity:[{id:1,driverName:"大头",gender:"男",driverLicenseNo:"8888888888",contact:"7897876666",status:"启用",note:"fdafdafaf",creator:"fdfafdsf",createTime:"2018-08-08",updateUser:"liby0068",updateTime:"2018-08-08"},{id:2,driverName:"大头",gender:"男",driverLicenseNo:"8888888888",contact:"7897876666",status:"启用",note:"fdafdafaf",creator:"fdfafdsf",createTime:"2018-08-08",updateUser:"liby0068",updateTime:"2018-08-08"}],showAddForm:!1,showReviseForm:!1,detail_list:{},pager:{},loading:!1}},created:function(){var t=this;console.log("driver-manage created"),this.timer=setInterval(function(){if(localStorage.driverManageExportDataTimestamp){var e=(new Date).getTime(),a=e-localStorage.driverManageExportDataTimestamp;a<6e4?(t.isExportDataLimit=!0,t.exportBtnText="导出"+Math.ceil((6e4-a)/1e3)+"s"):(t.isExportDataLimit=!1,t.exportBtnText="导出到excel")}else t.isExportDataLimit=!1,t.exportBtnText="导出到excel"},500),this.jumpPageHandle(1)},beforeDestroy:function(){clearInterval(this.timer)},methods:{closeAddForm:function(){this.showAddForm=!1},add:function(){var t=this.addData;this.showAddForm=!0,t.gender="1",t.driverLicenseNo="",t.driverName="",t.contact="",t.status="1",t.note=""},isTel:function(t){var e=!0;return/^1[34578]\d{9}$/.test(t)||(e=!1),/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/.test(t)||(e=!1),e},submitAddForm:function(){var t=this,e=/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}(\d|x|X)$/,a=this.addData;if(!e.test(a.driverLicenseNo))return this.$Modal.error({title:"填写错误",content:"请输入正确的驾驶证号码"}),!1;if(console.log("验证成功"),null==a.driverName||void 0==a.driverName||""==a.driverName)return this.$Modal.error({title:"填写错误",content:"司机姓名不能为空!"}),!1;if(null==a.driverLicenseNo||void 0==a.driverLicenseNo||""==a.driverLicenseNo)return this.$Modal.error({title:"填写错误",content:"驾驶证不能为空!"}),!1;if(null==a.contact||void 0==a.contact||""==a.contact)return this.$Modal.error({title:"填写错误",content:"联系电话不能为空!"}),!1;if(!this.isTel(a.contact))return this.$Modal.error({title:"填写错误",content:"联系方式格式不正确!"}),!1;var i={};i.opt="add",i.driverName=a.driverName,i.gender=a.gender,i.driverLicenseNo=a.driverLicenseNo,i.note=a.note,i.contact=a.contact,i.status=a.status,console.log("新增发送参数：",i),this.loading=!0,this.$util.ajax.post(this.apiGroup.saveUrl,n.default.stringify(i)).then(function(e){t.loading=!1,console.log("新增司机请求返回数据：",e),e.data.success?t.$Modal.success({title:"新增司机返回信息",content:e.data.result,onOk:function(){t.showAddForm=!1,t.jumpPageHandle(1)}}):t.$Modal.error({title:"HTTP请求错误",content:e.statusText})}).catch(function(e){console.log(e),t.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},revise:function(){var t=this,e=this.$refs.selection.getSelection();if(1!=e.length)return this.$Modal.error({title:"数据校验错误",content:"请选择一条要修改的记录！"}),!1;var a={};a.id=e[0].id,console.log("获取修改数据发送参数：",a),this.loading=!0,this.$util.ajax.post(this.apiGroup.revDetailUrl,n.default.stringify(a)).then(function(e){t.loading=!1,console.log("修改司机请求返回数据：",e),e.data.success?(t.reviseData=e.data.result,t.showReviseForm=!0):t.$Modal.error({title:"HTTP请求错误",content:e.statusText})}).catch(function(e){console.log(e),t.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},submitReviseForm:function(){var t=this,e=this.reviseData;if(null==e.driverName||void 0==e.driverName||""==e.driverName)return this.$Modal.error({title:"填写错误",content:"司机姓名不能为空!"}),!1;if(null==e.driverLicenseNo||void 0==e.driverLicenseNo||""==e.driverLicenseNo)return this.$Modal.error({title:"填写错误",content:"驾驶证不能为空!"}),!1;if(null==e.contact||void 0==e.contact||""==e.contact)return this.$Modal.error({title:"填写错误",content:"联系电话不能为空!"}),!1;if(!this.isTel(e.contact))return this.$Modal.error({title:"填写错误",content:"联系方式格式不正确!"}),!1;var a={};a.opt="update",a.driverName=e.driverName,a.gender=e.gender,a.driverLicenseNo=e.driverLicenseNo,a.note=e.note,a.contact=e.contact,a.status=e.status,a.id=e.id,console.log("修改发送参数：",a),this.loading=!0,this.$util.ajax.post(this.apiGroup.saveUrl,n.default.stringify(a)).then(function(e){t.loading=!1,console.log("修改司机请求返回数据：",e),e.data.success?t.$Modal.success({title:"修改司机返回信息",content:e.data.result,onOk:function(){t.showReviseForm=!1,t.jumpPageHandle(1)}}):t.$Modal.error({title:"HTTP请求错误",content:e.statusText})}).catch(function(e){console.log(e),t.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},closeReviseForm:function(){this.showReviseForm=!1},exportExcel:function(){var t=this;this.$Modal.confirm({title:"确认导出",content:"是否确认导出？",onOk:function(){localStorage.driverManageExportDataTimestamp=(new Date).getTime(),t.isExportDataLimit=!0;var e={};e.driverName=t.query.driverName,e.gender=t.query.gender,console.log("导出excel请求发送数据",e),t.$util.ajax.post(t.apiGroup.exportExcelUrl,n.default.stringify(e),{responseType:"blob"}).then(function(e){if(200==e.status){t.loading=!1;var a=new Blob([e.data],{type:"application/x-xls"}),i=new Date,r="司机信息"+i.getFullYear().toString(),n=(i.getMonth()+1).toString();i.getMonth()+1<10&&(n="0"+(i.getMonth()+1).toString()),r+=n;var o=i.getDate().toString();i.getDate()<10&&(o="0"+i.getDate().toString()),r+=o;var s=i.getHours().toString();i.getHours()<10&&(o="0"+i.getHours().toString()),r+=s;var l=i.getMinutes().toString();i.getMinutes()<10&&(l="0"+i.getMinutes().toString()),r+=l;var d=i.getSeconds().toString();if(i.getSeconds()<10&&(d="0"+i.getSeconds().toString()),r+=d,r+=".xlsx",window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(a,r);else{var c=document.createElement("a");c.href=window.URL.createObjectURL(a),c.download=r,c.click(),window.URL.revokeObjectURL(c.href)}}else t.$Modal.error({title:"HTTP请求错误",content:e.statusText})}).catch(function(e){console.log(e),t.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})}})},jumpPageHandle:function(t){var e=this;this.pager.page=t;var a={page:this.pager.page,driverName:this.query.driverName,gender:this.query.gender};console.log("查询参数：",a),this.loading=!0,this.$util.ajax.post(this.apiGroup.listUrl,n.default.stringify(a)).then(function(t){e.loading=!1,console.log("司机管理列表请求返回数据：",t),200==t.status?(e.pager=t.data.result.drivers,e.entity=t.data.result.drivers.records,e.entity.forEach(function(t){1==t.gender?t.gender="男":2==t.gender&&(t.gender="女"),1==t.status?t.status="启用":0==t.status&&(t.status="禁用"),Number(t.updateTime)<Number(t.createTime)||null==t.updateTime||void 0==t.updateTime||""==t.updateTime?t.updateTime="------":t.updateTime=(0,i.timestampToDay)(t.updateTime),t.createTime=(0,i.timestampToDay)(t.createTime)})):e.$Modal.error({title:"HTTP请求错误",content:t.statusText})}).catch(function(t){console.log(t),e.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"})})},lookup:function(){console.log("lookup"),this.jumpPageHandle(1)}}}},2292:function(t,e,a){var i=a(2293);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(43)("64c5dbed",i,!1,{})},2293:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.cmain[data-v-4f9edaf7] {\n  background-color: white;\n  position: relative;\n  /* min-width: 1020px; */\n}\n.checkForm .ivu-col[data-v-4f9edaf7] {\n  margin: 10px 0px;\n}\n.qianshouCol .ivu-col[data-v-4f9edaf7] {\n  margin: 5px 0px;\n}\n.line[data-v-4f9edaf7] {\n  border-bottom: 1px solid #dddee1;\n}\nbutton + button[data-v-4f9edaf7] {\n  margin-left: 10px;\n}\n.addform-laber[data-v-4f9edaf7] {\n  width: 90px;\n  display: inline-block;\n  text-align: right;\n}\n",""])},2294:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cmain"},[a("div",{staticStyle:{padding:"20px 50px"}},[a("Row",[a("Col",{attrs:{span:"6"}},[a("span",[t._v("姓名:")]),t._v(" "),a("Input",{staticStyle:{width:"160px","margin-left":"15px"},model:{value:t.query.driverName,callback:function(e){t.$set(t.query,"driverName","string"==typeof e?e.trim():e)},expression:"query.driverName"}})],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("span",[t._v("性别:")]),t._v(" "),a("i-select",{staticStyle:{width:"160px","margin-left":"15px"},model:{value:t.query.gender,callback:function(e){t.$set(t.query,"gender",e)},expression:"query.gender"}},[a("i-option",{attrs:{value:""}},[t._v("请选择性别")]),t._v(" "),a("i-option",{attrs:{value:"1"}},[t._v("男")]),t._v(" "),a("i-option",{attrs:{value:"2"}},[t._v("女")])],1)],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("i-button",{staticStyle:{width:"115px",float:"right"},attrs:{type:"primary",icon:"search"},on:{click:t.lookup}},[t._v("查询")])],1)],1),t._v(" "),a("br"),t._v(" "),a("div",{staticClass:"line"}),t._v(" "),a("br"),t._v(" "),a("Row",{attrs:{type:"flex",justify:"end"}},[a("i-button",{staticStyle:{width:"115px"},attrs:{type:"primary",icon:"plus"},on:{click:t.add}},[t._v("新增")]),t._v(" "),a("i-button",{staticStyle:{width:"115px"},attrs:{type:"warning",icon:"edit"},on:{click:t.revise}},[t._v("修改")]),t._v(" "),a("i-button",{staticStyle:{width:"115px"},attrs:{type:"success",icon:"android-download",disabled:t.isExportDataLimit},on:{click:t.exportExcel}},[t._v(t._s(t.exportBtnText))])],1),t._v(" "),a("br"),t._v(" "),a("Table",{ref:"selection",attrs:{stripe:"",columns:t.columns1,data:t.entity}}),t._v(" "),a("Row",{staticStyle:{margin:"10px"},attrs:{type:"flex",justify:"end"}},[a("page",{attrs:{current:t.pager.page,total:t.pager.totalCount,"page-size":t.pager.pageCode,"show-elevator":"","show-total":""},on:{"on-change":t.jumpPageHandle}})],1)],1),t._v(" "),a("modal",{attrs:{width:"800",title:"新增司机"},model:{value:t.showAddForm,callback:function(e){t.showAddForm=e},expression:"showAddForm"}},[a("div",{staticClass:"addform"},[a("br"),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("姓名:")]),t._v(" "),a("Input",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.addData.driverName,callback:function(e){t.$set(t.addData,"driverName","string"==typeof e?e.trim():e)},expression:"addData.driverName"}})],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("性别:")]),t._v(" "),a("i-select",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.addData.gender,callback:function(e){t.$set(t.addData,"gender",e)},expression:"addData.gender"}},[a("i-option",{attrs:{value:"1"}},[t._v("男")]),t._v(" "),a("i-option",{attrs:{value:"2"}},[t._v("女")])],1)],1)],1),t._v(" "),a("br"),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("驾驶证:")]),t._v(" "),a("Input",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.addData.driverLicenseNo,callback:function(e){t.$set(t.addData,"driverLicenseNo","string"==typeof e?e.trim():e)},expression:"addData.driverLicenseNo"}})],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("联系方式:")]),t._v(" "),a("Input",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.addData.contact,callback:function(e){t.$set(t.addData,"contact","string"==typeof e?e.trim():e)},expression:"addData.contact"}})],1)],1),t._v(" "),a("br"),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("状态:")]),t._v(" "),a("i-select",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.addData.status,callback:function(e){t.$set(t.addData,"status",e)},expression:"addData.status"}},[a("i-option",{attrs:{value:"1"}},[t._v("启用")]),t._v(" "),a("i-option",{attrs:{value:"0"}},[t._v("禁用")])],1)],1)],1),t._v(" "),a("br"),t._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("span",{staticClass:"addform-laber"},[t._v("备注:")]),t._v(" "),a("Input",{staticStyle:{width:"320px","margin-left":"15px"},attrs:{type:"textarea"},model:{value:t.addData.note,callback:function(e){t.$set(t.addData,"note","string"==typeof e?e.trim():e)},expression:"addData.note"}})],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{staticStyle:{width:"92px"},attrs:{type:"primary"},on:{click:t.submitAddForm}},[t._v("保存")]),t._v(" "),a("i-button",{staticStyle:{width:"92px"},on:{click:t.closeAddForm}},[t._v("取消")])],1)]),t._v(" "),a("modal",{attrs:{width:"900",title:"修改司机"},model:{value:t.showReviseForm,callback:function(e){t.showReviseForm=e},expression:"showReviseForm"}},[a("div",{staticClass:"addform"},[a("br"),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("姓名:")]),t._v(" "),a("Input",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.reviseData.driverName,callback:function(e){t.$set(t.reviseData,"driverName","string"==typeof e?e.trim():e)},expression:"reviseData.driverName"}})],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("性别:")]),t._v(" "),a("i-select",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.reviseData.gender,callback:function(e){t.$set(t.reviseData,"gender","string"==typeof e?e.trim():e)},expression:"reviseData.gender"}},[a("i-option",{attrs:{value:1}},[t._v("男")]),t._v(" "),a("i-option",{attrs:{value:2}},[t._v("女")])],1)],1)],1),t._v(" "),a("br"),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("驾驶证:")]),t._v(" "),a("Input",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.reviseData.driverLicenseNo,callback:function(e){t.$set(t.reviseData,"driverLicenseNo","string"==typeof e?e.trim():e)},expression:"reviseData.driverLicenseNo"}})],1),t._v(" "),a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("联系方式:")]),t._v(" "),a("Input",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.reviseData.contact,callback:function(e){t.$set(t.reviseData,"contact","string"==typeof e?e.trim():e)},expression:"reviseData.contact"}})],1)],1),t._v(" "),a("br"),t._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("span",{staticClass:"addform-laber"},[t._v("状态:")]),t._v(" "),a("i-select",{staticStyle:{width:"220px","margin-left":"15px"},model:{value:t.reviseData.status,callback:function(e){t.$set(t.reviseData,"status",e)},expression:"reviseData.status"}},[a("i-option",{attrs:{value:1}},[t._v("启用")]),t._v(" "),a("i-option",{attrs:{value:0}},[t._v("禁用")])],1)],1)],1),t._v(" "),a("br"),t._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("span",{staticClass:"addform-laber"},[t._v("备注:")]),t._v(" "),a("Input",{staticStyle:{width:"320px","margin-left":"15px"},attrs:{type:"textarea"},model:{value:t.reviseData.note,callback:function(e){t.$set(t.reviseData,"note","string"==typeof e?e.trim():e)},expression:"reviseData.note"}})],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("i-button",{staticStyle:{width:"92px"},attrs:{type:"primary"},on:{click:t.submitReviseForm}},[t._v("保存")]),t._v(" "),a("i-button",{staticStyle:{width:"92px"},on:{click:t.closeReviseForm}},[t._v("取消")])],1)]),t._v(" "),t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},r=[];i._withStripped=!0;var n={render:i,staticRenderFns:r};e.default=n},792:function(t,e,a){"use strict";function i(t){d||a(2292)}Object.defineProperty(e,"__esModule",{value:!0});var r=a(1675),n=a.n(r);for(var o in r)"default"!==o&&function(t){a.d(e,t,function(){return r[t]})}(o);var s=a(2294),l=a.n(s),d=!1,c=a(13),v=i,u=c(n.a,l.a,!1,v,"data-v-4f9edaf7",null);u.options.__file="src/views/purchase-send/base-data/driver-manage/driver-manage.vue",e.default=u.exports},898:function(t,e,a){"use strict";function i(t,e){if(!e)var e="yyyy-MM-DD hh:mm:ss";var a={"M+":t.getMonth()+1,"D+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in a)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?a[i]:("00"+a[i]).substr((""+a[i]).length)));return e}function r(t,e){if(!e)var e="yyyy-MM-dd";(t=Number(t))<1e10&&(t*=1e3);var a=new Date(t),i={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in i)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[r]:("00"+i[r]).substr((""+i[r]).length)));return e}Object.defineProperty(e,"__esModule",{value:!0}),e.formatDate=i,e.timestampToDay=r}});