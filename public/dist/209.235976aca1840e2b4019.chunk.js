webpackJsonp([209],{1726:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(38),o=(a(i),n(239)),r=a(o);t.default={data:function(){var e=this;return{deleteModal:!1,totalCount:1,loading:!1,columns:[{title:"序号",align:"center",width:62,render:function(e,t){return"小计"==t.row.xuhao||"总计"==t.row.xuhao?e("div",t.row.xuhao):e("div",t.index+1)}},{title:"开票名称",key:"openTicketName",align:"center",width:120},{title:"门店名称",key:"storeName",align:"center",width:120},{title:"预收单号",key:"advanceNumber",align:"center",width:150,tooltip:!0},{title:"支付方式",key:"payment",align:"center",width:100},{title:"预收金额",align:"center",key:"advanceSum",width:100,render:function(e,t){return e("div",t.row.advanceSum?Number(t.row.advanceSum).toFixed(2):"0.00")}},{title:"剩余可核销金额",align:"center",key:"canVerification",width:100,render:function(e,t){return e("div",t.row.canVerification?Number(t.row.canVerification).toFixed(2):"0.00")}},{title:"收款日期",align:"center",key:"collectionDate",width:110},{title:"业务员",align:"center",key:"salesman",width:100},{title:"备注",ellipsis:!0,align:"center",key:"remark",tooltip:!0,width:100,render:function(e,t){var n="";if(null!==t.row.remark&&void 0!==t.row.remark&&""!==t.row.remark)return n=t.row.remark.length>5?t.row.remark.substring(0,5)+"...":t.row.remark,e("Tooltip",{props:{placement:"top",offset:0,transfer:!0}},[n,e("div",{slot:"content",style:{whiteSpace:"normal",wordBreak:"break-all"}},t.row.remark)])}},{title:"操作员",align:"center",key:"user",width:100,tooltip:!0},{title:"更新时间",align:"center",key:"updateDate",width:110,tooltip:!0},{title:"状态",align:"center",key:"status",width:100,tooltip:!0},{title:"操作",align:"center",key:"handle",fixed:"right",tooltip:!0,width:125,render:function(t,n){return"小计"==n.row.xuhao||"总计"==n.row.xuhao?t("div",""):"未核销"==n.row.status?t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.$router.push({name:"advance-payment-management-view",query:{id:n.row.id}})}}},"修改"),t("Button",{props:{type:"primary",size:"small"},on:{click:function(){e.delId=n.row.id,e.popup(n.row.advanceNumber)}}},"删除")]):t("div",[t("Button",{props:{type:"primary",size:"small"},on:{click:function(){e.$Modal.warning({title:"提示",content:"核销单只允许在未核销状态下修改"})}}},"修改")])}}],data:[],formItem:{payment:[{id:0,name:"现金"},{id:1,name:"银行卡"},{id:2,name:"支付宝"},{id:3,name:"微信"},{id:4,name:"其他"}]},value:{startDate:"",endDate:"",billingName:"",storeName:"",advanceNumber:"",payment:""},page:1,params:{},delId:"",advanceNo:"",receiptBillNo:[]}},mounted:function(){},methods:{getData:function(){var e=this;this.data=[];var t={};t=this.params,t.page=this.page,this.loading=!0,this.$ajax({method:"post",url:this.$util.apiConfig.traderManage.flowManage.advancePaymentManagement.list,data:r.default.stringify(t)}).then(function(t){e.loading=!1,e.totalCount=t.data.pager.totalCount;var n=0,a=0;t.data.pager.records.map(function(t){var i="";i=0==t.status?"未核销":1==t.status?"部分核销":2==t.status?"已核销":"未核销",n+=t.advanceAmmount,a+=t.leftAmmount;var o={id:t.id,storeName:t.storeName,openTicketName:t.openTicketName,advanceNumber:t.advanceNo,payment:t.advanceMethod,advanceSum:t.advanceAmmount,canVerification:t.leftAmmount,collectionDate:e.formatDate(t.advanceTime,"yyyy-MM-DD"),salesman:t.empName,remark:t.memo,user:t.dealerName,updateDate:t.updateTime?e.formatDate(t.updateTime,"yyyy-MM-DD"):"",status:i};e.data.push(o)});var i={xuhao:"小计",advanceSum:n.toFixed(2),canVerification:a.toFixed(2)};e.data.push(i);var o={xuhao:"总计",advanceSum:t.data.sumAdvanceAmmount?t.data.sumAdvanceAmmount.toFixed(2):"0.00",canVerification:t.data.sumLeftAmmount?t.data.sumLeftAmmount.toFixed(2):"0.00"};e.data.push(o)}).catch(function(e){console.log("失败信息：",e)})},changePage:function(e){this.page=e,this.getData()},query:function(){this.page=1,this.params.startTime=this.formatDate(this.value.startDate,"yyyy-MM-DD"),this.params.endTime=this.formatDate(this.value.endDate,"yyyy-MM-DD"),this.params.storeName=this.value.storeName,this.params.advanceNo=this.value.advanceNumber,this.params.advanceMethod=this.value.payment,this.params.openTicketName=this.value.billingName,this.getData()},popup:function(e){var t=this;this.deleteModal=!0;var n={};this.advanceNo=e,n.advanceNo=e,this.$ajax({method:"post",url:this.$util.apiConfig.traderManage.flowManage.advancePaymentManagement.getAdvanceReceiptList,data:n}).then(function(e){t.receiptBillNo=e.data}).catch(function(e){console.log("失败信息：",e)})},ok:function(){var e=this;this.$ajax({method:"post",url:this.$util.apiConfig.traderManage.flowManage.advancePaymentManagement.delData,headers:{"Content-Type":"application/json;charset=UTF-8"},data:this.delId}).then(function(t){t.data.success?(e.$Message.success("预收单删除成功"),e.getData()):e.$Message.error("预收单删除失败")}).catch(function(e){console.log("失败信息：",e)})},formatDate:function(e,t){if(""===e)return"";var n=new Date;if(n.setTime(e),!t)var t="yyyy-MM-DD hh:mm:ss";var a={"M+":n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,"D+":n.getDate()<10?"0"+n.getDate():n.getDate(),"h+":n.getHours()<10?"0"+n.getHours():n.getHours(),"m+":n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes(),"s+":n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in a)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[i]:("00"+a[i]).substr((""+a[i]).length)));return t},newbuild:function(){this.$router.push({name:"advance-payment-management-view",query:{id:"0"}})}},created:function(){this.getData()},components:{}}},2472:function(e,t,n){var a=n(2473);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(43)("622ccf52",a,!1,{})},2473:function(e,t,n){t=e.exports=n(42)(!1),t.push([e.i,"\n.width-100 {\n  width: 100%;\n}\n.lb-left {\n  float: left;\n}\n.lb-right {\n  float: right;\n}\n.lb-center {\n  text-align: center;\n}\n.lb-promotion-main {\n  height: auto;\n  background-color: #fff;\n}\n.lb-promotion-main .lb-promotion-search {\n  border-bottom: 1px dashed #e5e5e5;\n}\n.lb-promotion-main .lb-promotion-search .lb-promotion-row {\n  margin-bottom: 14px;\n}\n.lb-promotion-main .lb-promotion-search .lb-promotion-row .ListName {\n  text-align: right;\n  line-height: 32px;\n  color: #747474;\n  font-size: 12px;\n  margin-right: 8px;\n}\n.promotion-page {\n  margin: 1rem 0 0 0;\n}\n.container {\n  background: #fff;\n  color: #747474;\n  border: 1px solid #E8E8E8;\n  padding: 1% 1% 3%;\n}\n.margin-top-8 {\n  margin-top: 8px;\n}\n.margin-top-10 {\n  margin-top: 10px;\n}\n.margin-top-20 {\n  margin-top: 20px;\n}\n.margin-left-10 {\n  margin-left: 10px;\n}\n.margin-bottom-10 {\n  margin-bottom: 10px;\n}\n.margin-bottom-12 {\n  margin-bottom: 12px;\n}\n.margin-bottom-14 {\n  margin-bottom: 14px;\n}\n.margin-bottom-100 {\n  margin-bottom: 100px;\n}\n.margin-right-10 {\n  margin-right: 10px;\n}\n.padding-left-6 {\n  padding-left: 6px;\n}\n.padding-left-8 {\n  padding-left: 5px;\n}\n.padding-left-10 {\n  padding-left: 10px;\n}\n.padding-left-20 {\n  padding-left: 20px;\n}\n.height-100 {\n  height: 100%;\n}\n.height-120px {\n  height: 100px;\n}\n.height-200px {\n  height: 200px;\n}\n.height-492px {\n  height: 492px;\n}\n.height-460px {\n  height: 460px;\n}\n.line-gray {\n  height: 0;\n  border-bottom: 2px solid #dcdcdc;\n}\n.notwrap {\n  word-break: keep-all;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.padding-left-5 {\n  padding-left: 10px;\n}\n[v-cloak] {\n  display: none;\n}\n.mb--12 {\n  margin-bottom: 12px;\n}\n.mb--14 {\n  margin-bottom: 14px;\n}\n.border-b--dashed {\n  border-bottom: 1px dashed #e5e5e5;\n}\n.pd--20 {\n  padding: 20px;\n}\n.ml--50 {\n  margin-left: 50px;\n}\n.fr {\n  float: right;\n}\n.fl {\n  float: left;\n}\n.bg--white {\n  background: #fff;\n}\n.clearfix:after {\n  content: '';\n  display: block;\n  height: 0;\n  clear: both;\n}\n.text-center {\n  text-align: center;\n}\n.white {\n  background-color: white;\n}\n.select_box {\n  padding: 20px;\n  border-bottom: 1px dashed #E8E8E8;\n}\n.ling_height {\n  padding-top: 15px;\n}\n.text_align_right {\n  text-align: right;\n}\n.text_align_center {\n  text-align: center;\n}\n.operation_box {\n  padding: 10px 20px;\n  text-align: right;\n}\n.page_right {\n  text-align: right;\n  padding: 10px 20px;\n}\n.input_width {\n  width: 120px;\n}\n.search_btn {\n  width: 100px;\n}\n.margin_bottom_0 {\n  margin-bottom: 0;\n}\n.ivu-breadcrumb a {\n  color: #999;\n}\n.ivu-breadcrumb {\n  font-size: 12px;\n}\n.ivu-breadcrumb > span:last-child {\n  color: #426196;\n}\n.box_shadow {\n  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);\n  border-color: #eee;\n}\n.border_bottom_dashed {\n  border-bottom: 1px dashed #E8E8E8;\n}\n.problem_table .ivu-checkbox-wrapper {\n  margin-right: 0px;\n}\n.advance-payment-management {\n  width: 100%;\n  height: 100%;\n  background: #fff;\n  color: #747474;\n  border: 1px solid #E8E8E8;\n  text-align: center;\n  padding: 10px 0;\n}\n.advance-payment-management .head {\n  padding: 20px 0;\n}\n.advance-payment-management .head .head_left {\n  padding: 10px 0;\n  border-right: 1px dashed #E8E8E8;\n}\n.advance-payment-management .head .head_left .payment {\n  width: 50%;\n}\n.advance-payment-management .head .head_left #advanceNumber {\n  width: 50%;\n}\n.advance-payment-management .head .head_left #storeName {\n  width: 50%;\n}\n.advance-payment-management .head .head_left #billingName {\n  width: 50%;\n}\n.advance-payment-management .head .head_left .date {\n  width: 50%;\n}\n.advance-payment-management .head .head_left .hl2 {\n  margin-top: 10px;\n}\n.advance-payment-management .head .head_right .query {\n  margin-bottom: 10px;\n}\n.advance-payment-management .table {\n  margin: 1%;\n}\n.advance-payment-management .page {\n  text-align: right;\n  margin-right: 1%;\n}\n.ivu-table-row-highlight td,\ntr.ivu-table-row-highlight.ivu-table-row-hover td {\n  background: red;\n  color: #fff;\n}\n",""])},2474:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"advance-payment-management"},[n("Row",{staticClass:"head"},[n("Col",{staticClass:"head_left",attrs:{span:"18"}},[n("Row",[n("Col",{attrs:{span:"8"}},[e._v("\n            开始时间 :\n            "),n("DatePicker",{staticClass:"date",attrs:{type:"date"},model:{value:e.value.startDate,callback:function(t){e.$set(e.value,"startDate",t)},expression:"value.startDate"}})],1),e._v(" "),n("Col",{attrs:{span:"8"}},[e._v("\n            截止时间 :\n            "),n("DatePicker",{staticClass:"date",attrs:{type:"date"},model:{value:e.value.endDate,callback:function(t){e.$set(e.value,"endDate",t)},expression:"value.endDate"}})],1),e._v(" "),n("Col",{attrs:{span:"8"}},[n("label",{attrs:{for:"billingName"}},[e._v("开票名称 : ")]),n("Input",{attrs:{id:"billingName"},model:{value:e.value.billingName,callback:function(t){e.$set(e.value,"billingName",t)},expression:"value.billingName"}})],1)],1),e._v(" "),n("Row",{staticClass:"hl2"},[n("Col",{attrs:{span:"8"}},[n("label",{attrs:{for:"storeName"}},[e._v("门店名称 : ")]),n("Input",{attrs:{id:"storeName"},model:{value:e.value.storeName,callback:function(t){e.$set(e.value,"storeName",t)},expression:"value.storeName"}})],1),e._v(" "),n("Col",{attrs:{span:"8"}},[n("label",{attrs:{for:"advanceNumber"}},[e._v("预收单号 : ")]),n("Input",{attrs:{id:"advanceNumber"},model:{value:e.value.advanceNumber,callback:function(t){e.$set(e.value,"advanceNumber",t)},expression:"value.advanceNumber"}})],1),e._v(" "),n("Col",{attrs:{span:"8"}},[e._v("\n            支付方式 :\n            "),n("Select",{staticClass:"payment",attrs:{placeholder:"请选择",clearable:""},model:{value:e.value.payment,callback:function(t){e.$set(e.value,"payment",t)},expression:"value.payment"}},e._l(e.formItem.payment,function(t){return n("Option",{key:t.id,attrs:{value:t.name}},[e._v(e._s(t.name))])}))],1)],1)],1),e._v(" "),n("Col",{staticClass:"head_right",attrs:{span:"6"}},[n("br"),n("Button",{staticClass:"query",on:{click:e.query}},[e._v("查询 ")]),n("br"),e._v(" "),n("Button",{staticClass:"add",on:{click:e.newbuild}},[e._v("增加明细 ")])],1)],1),e._v(" "),n("Table",{staticClass:"table",attrs:{loading:e.loading,columns:e.columns,data:e.data}}),e._v(" "),n("Page",{attrs:{current:e.page,total:e.totalCount,"show-total":"","show-elevator":"","class-name":"page"},on:{"on-change":e.changePage}}),e._v(" "),n("Modal",{attrs:{title:"提示"},on:{"on-ok":e.ok},model:{value:e.deleteModal,callback:function(t){e.deleteModal=t},expression:"deleteModal"}},[n("h5",{directives:[{name:"show",rawName:"v-show",value:e.receiptBillNo.length>0,expression:"receiptBillNo.length>0"}]},[e._v("此预收单被对账单： "),e._l(e.receiptBillNo,function(t){return n("span",{staticStyle:{"margin-left":"6px"}},[e._v(e._s(t.receiptBillNo)+",")])}),e._v(" 引用；")],2),e._v(" "),n("h5",[e._v("确定要删除此预收单吗？")]),e._v(" "),n("h5",{staticStyle:{color:"rgb(169, 169, 169)"}},[e._v("预收单号："+e._s(e.advanceNo))])])],1)},i=[];a._withStripped=!0;var o={render:a,staticRenderFns:i};t.default=o},841:function(e,t,n){"use strict";function a(e){s||n(2472)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1726),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,function(){return i[e]})}(r);var l=n(2474),d=n.n(l),s=!1,m=n(13),c=a,p=m(o.a,d.a,!1,c,null,null);p.options.__file="src/views/trader-manage/flow-manage/advance-payment-management/advance-payment-management.vue",t.default=p.exports}});