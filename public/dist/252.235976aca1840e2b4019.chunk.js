webpackJsonp([252],{1583:function(t,n,e){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=e(239),i=(a(o),e(38));a(i);n.default={data:function(){var t=this;return{totalCount:10,loading:!1,modal1:!1,columns:[{type:"selection",align:"center",width:58,fixed:"left"},{title:"预算项目编号",key:"projectNumber",align:"center",width:110},{title:"促销编码",align:"center",key:"promotionNumber",width:130},{title:"促销名称",align:"center",key:"promotionName",width:130},{title:"促销类型",align:"center",key:"promotiontype",width:90},{title:"开始时间",align:"center",key:"startDate",width:100},{title:"结束时间",align:"center",key:"endDate",width:100},{title:"费用科目",align:"center",key:"costAccount",width:125},{title:"费用科目总金额",align:"center",key:"totalFees",width:120},{title:"建议核销费用",align:"center",key:"suggestCost",width:110},{title:"核销状态",align:"center",key:"status",width:100},{title:"操作",align:"center",key:"handle",width:96,fixed:"right",render:function(n,e){return"未核销"==e.row.status?n("div",[n("Button",{props:{type:"primary",size:"small"},style:{margin:"5px 0"},on:{click:function(){if(t.bh=[],t.bh[0]=e.row.promotionNumber,!((new Date).getTime()>=new Date(e.row.endDate).getTime()))return t.$Message.info("已选项中存在未结束活动"),!1;t.popup()}}},"一键核销"),n("Button",{props:{type:"primary",size:"small"},style:{marginBottom:"5px",width:"64px"},on:{click:function(){t.$router.push({name:"buy-detail-page",query:{promotionCode:e.row.promotionNumber}})}}},"详情")]):n("div",[n("Button",{props:{type:"primary",size:"small"},style:{marginBottom:"5px",width:"64px"},on:{click:function(){t.$router.push({name:"buy-detail-page",query:{promotionCode:e.row.promotionNumber}})}}},"详情")])}}],data:[],modalLoding:!0,columns2:[{type:"index",align:"center",width:50},{title:"账号",key:"account",align:"center",width:100},{title:"公司名称",align:"center",key:"companyName"}],data2:[],formItem:{brand:[{id:"1",name:"贝贝健"},{id:"2",name:"家居"},{id:"3",name:"威王"},{id:"4",name:"超威"},{id:"5",name:"西兰"}],school:[{id:"1",name:"贝贝健"},{id:"2",name:"家居"},{id:"3",name:"威王"},{id:"4",name:"超威"},{id:"5",name:"西兰"}],sort:[{id:"1",name:"贝贝健"},{id:"2",name:"家居"},{id:"3",name:"威王"},{id:"4",name:"超威"},{id:"5",name:"西兰"}],types:[{id:"1",name:"贝贝健"},{id:"2",name:"家居"},{id:"3",name:"威王"},{id:"4",name:"超威"},{id:"5",name:"西兰"}],state:[{id:"1",name:"贝贝健"},{id:"2",name:"家居"},{id:"3",name:"威王"},{id:"4",name:"超威"},{id:"5",name:"西兰"}]},value:{projectNumber:"",promotionNumber:"",promotionName:"",startDate:"",endDate:""},params:{},bh:[],page:1,uid:"",atchApplicationEvent:[]}},mounted:function(){},methods:{initNumber:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"queryArray",a=t.target.value,o=/^[0-9]*$/;console.log(!o.test(a)),o.test(a)?(this[e][n]=a,setTimeout(function(n){return t.target.value=a})):(this[e][n]="",setTimeout(function(n){return t.target.value=""}))},getUid:function(){var t=this;this.$ajax({method:"post",url:this.$util.apiConfig.traderManage.infoManage.dealerInfo.dealerInfoUrl,data:""}).then(function(n){200==n.data.code&&(t.uid=n.data.result.userDTO.uid,t.getData())}).catch(function(t){console.log("失败信息：",t)})},init:function(){var t=this;document.cookie.split("; ").map(function(n){var e=n.split("=");"uid"==e[0]&&(t.uid=e[1])})},getData:function(){var t=this;this.data=[];var n={};n.uid=this.uid,n.promotionInfoDTO={budgetNumber:this.value.projectNumber,beginDate:this.formatDate(this.value.startDate,"yyyy-MM-DD"),endDate:this.formatDate(this.value.endDate,"yyyy-MM-DD"),promotionCode:this.value.promotionNumber,title:this.value.promotionName},n.pager={page:this.page,row:10},this.loading=!0,this.$ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.realTimeVerification.giftGetVerificationTotalData,data:n}).then(function(n){t.loading=!1,t.totalCount=n.data.result.totalCount,n.data.result.records.map(function(n){var e="";1==n.type?e="买赠":2==n.type?e="返利":3==n.type&&(e="特价");var a="";0==n.verificationStatus?a="未核销":1==n.verificationStatus?a="核销中":2==n.verificationStatus&&(a="已核销");var o=void 0;"未核销"!=a&&(o=!0);var i={projectNumber:n.budgetNumber,promotionNumber:n.promotionCode,promotionName:n.title,promotiontype:e,dealerNumber:n.dealerId,startDate:t.formatDate(n.beginDate,"yyyy-MM-DD hh:mm:ss"),endDate:t.formatDate(n.endDate,"yyyy-MM-DD hh:mm:ss"),costAccount:n.budgetarySubjects,totalFees:n.budgetSubjectTotal,suggestCost:n.verificationAmount,status:a,_disabled:o};t.data.push(i)})}).catch(function(t){console.log("失败信息：",t)})},query:function(){this.page=1,this.getData()},changePage:function(t){this.page=t,this.getData()},ok:function(){var t=this;if(!this.params.dealerCode)return this.$Message.info("请先选择支付对象"),void setTimeout(function(){t.modalLoding=!1,t.$nextTick(function(){t.modalLoading=!0,t.modal1=!0})},0);this.$ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.realTimeVerification.giftVerificationApply,data:this.params}).then(function(n){t.$Message.info(n.data.message),200==n.data.code?(t.modal1=!1,t.getData()):t.modal1=!1}).catch(function(t){console.log("失败信息：",t)})},batch:function(){if(this.bh=[],0==this.atchApplicationEvent.length)return void this.$Message.info("请先选择项目");var t=!1;for(var n in this.atchApplicationEvent){if(this.bh.push(this.atchApplicationEvent[n].promotionNumber),Number(this.atchApplicationEvent[n].suggestCost)>Number(this.atchApplicationEvent[n].totalFees))return this.$Message.info("核销费用超过费用科目总金额，请进入详情进行核销"),void(t=!0);if((new Date).getTime()<new Date(this.atchApplicationEvent[n].endDate).getTime()||"未核销"!=this.atchApplicationEvent[n].status)return this.$Message.info("已选项中存在未结束活动"),void(t=!0)}t||this.popup()},selection:function(t){console.log(t),this.atchApplicationEvent=[],this.atchApplicationEvent=t},radio:function(t){var n={};n.dealerCode=1*t.dealerCode,n.dmsAccount=t.account,n.uid=this.uid,n.promotionCodeList=this.bh,this.params=n},formatDate:function(t,n){if(""===t)return"";var e=new Date;if(e.setTime(t),!n)var n="yyyy-MM-DD hh:mm:ss";var a={"M+":e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,"D+":e.getDate()<10?"0"+e.getDate():e.getDate(),"h+":e.getHours()<10?"0"+e.getHours():e.getHours(),"m+":e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),"s+":e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()};/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var o in a)new RegExp("("+o+")").test(n)&&(n=n.replace(RegExp.$1,1===RegExp.$1.length?a[o]:("00"+a[o]).substr((""+a[o]).length)));return n},popup:function(){var t=this;this.modal1=!0,this.data2=[];var n={};n.uid=this.uid,this.$ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.realTimeVerification.giftGetDealerAccountRelList,data:n,transformRequest:[function(t){var n="";for(var e in t)n+=encodeURIComponent(e)+"="+encodeURIComponent(t[e])+"&";return n}],headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(n){n.data.result.map(function(n){var e={dealerCode:n.dealerCode,account:n.dmsAccount,companyName:n.dealerName};t.data2.push(e)}),t.params={}}).catch(function(t){console.log("失败信息：",t)})}},components:{},created:function(){this.getUid()}}},2006:function(t,n,e){var a=e(2007);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e(43)("6c9ac83d",a,!1,{})},2007:function(t,n,e){n=t.exports=e(42)(!1),n.push([t.i,"\n.width-100 {\n  width: 100%;\n}\n.lb-left {\n  float: left;\n}\n.lb-right {\n  float: right;\n}\n.lb-center {\n  text-align: center;\n}\n.lb-promotion-main {\n  height: auto;\n  background-color: #fff;\n}\n.lb-promotion-main .lb-promotion-search {\n  border-bottom: 1px dashed #e5e5e5;\n}\n.lb-promotion-main .lb-promotion-search .lb-promotion-row {\n  margin-bottom: 14px;\n}\n.lb-promotion-main .lb-promotion-search .lb-promotion-row .ListName {\n  text-align: right;\n  line-height: 32px;\n  color: #747474;\n  font-size: 12px;\n  margin-right: 8px;\n}\n.promotion-page {\n  margin: 1rem 0 0 0;\n}\n.container {\n  background: #fff;\n  color: #747474;\n  border: 1px solid #E8E8E8;\n  padding: 1% 1% 3%;\n}\n.margin-top-8 {\n  margin-top: 8px;\n}\n.margin-top-10 {\n  margin-top: 10px;\n}\n.margin-top-20 {\n  margin-top: 20px;\n}\n.margin-left-10 {\n  margin-left: 10px;\n}\n.margin-bottom-10 {\n  margin-bottom: 10px;\n}\n.margin-bottom-12 {\n  margin-bottom: 12px;\n}\n.margin-bottom-14 {\n  margin-bottom: 14px;\n}\n.margin-bottom-100 {\n  margin-bottom: 100px;\n}\n.margin-right-10 {\n  margin-right: 10px;\n}\n.padding-left-6 {\n  padding-left: 6px;\n}\n.padding-left-8 {\n  padding-left: 5px;\n}\n.padding-left-10 {\n  padding-left: 10px;\n}\n.padding-left-20 {\n  padding-left: 20px;\n}\n.height-100 {\n  height: 100%;\n}\n.height-120px {\n  height: 100px;\n}\n.height-200px {\n  height: 200px;\n}\n.height-492px {\n  height: 492px;\n}\n.height-460px {\n  height: 460px;\n}\n.line-gray {\n  height: 0;\n  border-bottom: 2px solid #dcdcdc;\n}\n.notwrap {\n  word-break: keep-all;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.padding-left-5 {\n  padding-left: 10px;\n}\n[v-cloak] {\n  display: none;\n}\n.mb--12 {\n  margin-bottom: 12px;\n}\n.mb--14 {\n  margin-bottom: 14px;\n}\n.border-b--dashed {\n  border-bottom: 1px dashed #e5e5e5;\n}\n.pd--20 {\n  padding: 20px;\n}\n.ml--50 {\n  margin-left: 50px;\n}\n.fr {\n  float: right;\n}\n.fl {\n  float: left;\n}\n.bg--white {\n  background: #fff;\n}\n.clearfix:after {\n  content: '';\n  display: block;\n  height: 0;\n  clear: both;\n}\n.text-center {\n  text-align: center;\n}\n.white {\n  background-color: white;\n}\n.select_box {\n  padding: 20px;\n  border-bottom: 1px dashed #E8E8E8;\n}\n.ling_height {\n  padding-top: 15px;\n}\n.text_align_right {\n  text-align: right;\n}\n.text_align_center {\n  text-align: center;\n}\n.operation_box {\n  padding: 10px 20px;\n  text-align: right;\n}\n.page_right {\n  text-align: right;\n  padding: 10px 20px;\n}\n.input_width {\n  width: 120px;\n}\n.search_btn {\n  width: 100px;\n}\n.margin_bottom_0 {\n  margin-bottom: 0;\n}\n.ivu-breadcrumb a {\n  color: #999;\n}\n.ivu-breadcrumb {\n  font-size: 12px;\n}\n.ivu-breadcrumb > span:last-child {\n  color: #426196;\n}\n.box_shadow {\n  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);\n  border-color: #eee;\n}\n.border_bottom_dashed {\n  border-bottom: 1px dashed #E8E8E8;\n}\n.problem_table .ivu-checkbox-wrapper {\n  margin-right: 0px;\n}\n.buy-present-promotion {\n  width: 100%;\n  height: 100%;\n  background: #fff;\n  color: #747474;\n  border: 1px solid #E8E8E8;\n  text-align: center;\n  padding: 10px 0;\n}\n.buy-present-promotion .head {\n  padding: 20px 0;\n}\n.buy-present-promotion .head .head_left {\n  padding: 10px 0;\n  border-right: 1px dashed #E8E8E8;\n}\n.buy-present-promotion .head .head_left #projectNumber {\n  width: 50%;\n}\n.buy-present-promotion .head .head_left #promotionNumber {\n  width: 55%;\n}\n.buy-present-promotion .head .head_left #promotionName {\n  width: 50%;\n}\n.buy-present-promotion .head .head_left .date {\n  width: 50%;\n}\n.buy-present-promotion .head .head_right .query {\n  margin-bottom: 10px;\n}\n.buy-present-promotion .table {\n  margin: 1%;\n}\n.buy-present-promotion .page {\n  text-align: right;\n  margin-right: 1%;\n}\n.ivu-table-row-highlight td,\ntr.ivu-table-row-highlight.ivu-table-row-hover td {\n  background: red;\n  color: #fff;\n}\n",""])},2008:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"buy-present-promotion"},[e("Row",{staticClass:"head"},[e("Col",{staticClass:"head_left",attrs:{span:"22"}},[e("Row",[e("Col",{attrs:{span:"5"}},[e("label",{attrs:{for:"projectNumber"}},[t._v("预算项目编号 :  ")]),e("Input",{attrs:{value:t.value.projectNumber,clearable:"",id:"projectNumber"},on:{"on-change":function(n){return t.initNumber(n,"projectNumber","value")}}})],1),t._v(" "),e("Col",{attrs:{span:"4"}},[e("label",{attrs:{for:"promotionNumber"}},[t._v("促销编码 :  ")]),e("Input",{attrs:{value:t.value.promotionNumber,clearable:"",id:"promotionNumber"},on:{"on-change":function(n){return t.initNumber(n,"promotionNumber","value")}}})],1),t._v(" "),e("Col",{attrs:{span:"5"}},[e("label",{attrs:{for:"promotionName"}},[t._v("促销名称 :  ")]),e("Input",{attrs:{clearable:"",id:"promotionName"},model:{value:t.value.promotionName,callback:function(n){t.$set(t.value,"promotionName",n)},expression:"value.promotionName"}})],1),t._v(" "),e("Col",{attrs:{span:"5"}},[t._v("\n                    开始时间 :\n                    "),e("DatePicker",{staticClass:"date",attrs:{type:"date"},model:{value:t.value.startDate,callback:function(n){t.$set(t.value,"startDate",n)},expression:"value.startDate"}})],1),t._v(" "),e("Col",{attrs:{span:"5"}},[t._v("\n                    结束时间 :\n                    "),e("DatePicker",{staticClass:"date",attrs:{type:"date"},model:{value:t.value.endDate,callback:function(n){t.$set(t.value,"endDate",n)},expression:"value.endDate"}})],1)],1)],1),t._v(" "),e("Col",{staticClass:"head_right",attrs:{span:"2"}},[e("Button",{staticClass:"query",on:{click:t.query}},[t._v("查询 ")]),e("br"),t._v(" "),e("Button",{staticClass:"batch",on:{click:t.batch}},[t._v("批量申请")])],1)],1),t._v(" "),e("Table",{attrs:{loading:t.loading,columns:t.columns,data:t.data},on:{"on-selection-change":t.selection}}),t._v(" "),e("Page",{attrs:{total:t.totalCount,"show-total":"","show-elevator":"","class-name":"page"},on:{"on-change":t.changePage}}),t._v(" "),e("Modal",{attrs:{title:"请单击行选择入账账号",loading:t.modalLoding,"mask-closable":!1},on:{"on-ok":t.ok},model:{value:t.modal1,callback:function(n){t.modal1=n},expression:"modal1"}},[e("Table",{staticClass:"table2",attrs:{height:"300","highlight-row":"",columns:t.columns2,data:t.data2},on:{"on-row-click":t.radio}})],1)],1)},o=[];a._withStripped=!0;var i={render:a,staticRenderFns:o};n.default=i},701:function(t,n,e){"use strict";function a(t){d||e(2006)}Object.defineProperty(n,"__esModule",{value:!0});var o=e(1583),i=e.n(o);for(var r in o)"default"!==r&&function(t){e.d(n,t,function(){return o[t]})}(r);var l=e(2008),s=e.n(l),d=!1,p=e(13),m=a,u=p(i.a,s.a,!1,m,null,null);u.options.__file="src/views/promotion-manage/war-adviser/real-time-verification/buy-present-promotion/buy-present-promotion.vue",n.default=u.exports}});