webpackJsonp([253],{1582:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(38);!function(t){t&&t.__esModule}(a);e.default={data:function(){return{loading:!1,columns:[{title:"预算项目编号",align:"center",key:"budgetNumber",width:120},{title:"促销编码",align:"center",key:"promotionCode",width:130},{title:"促销名称",align:"center",key:"title",width:100},{title:"促销类型",align:"center",key:"promotionType",width:100},{title:"支付对象",align:"center",key:"dealerCode",width:100},{title:"开始时间",align:"center",key:"beginDate",width:120},{title:"结束时间",align:"center",key:"endDate",width:120},{title:"门店编号",align:"center",key:"storeCode",width:100},{title:"门店名称",align:"center",key:"storeName",width:100},{title:"销售编码",align:"center",key:"spuCode",width:120},{title:"商品名称",align:"center",key:"itemName",width:100},{title:"实际销量",align:"center",key:"sales",width:100},{title:"建议核销费用",align:"center",key:"suggestAmmout",width:120},{title:"已核销金额",align:"center",key:"alreadyAmmout",width:100}],data:[],columns2:[{type:"selection",align:"center",width:60},{title:"预算项目编号",align:"center",key:"budgetNumber",width:120},{title:"促销编码",align:"center",key:"promotionCode",width:120},{title:"促销名称",align:"center",key:"title",width:100},{title:"促销类型",align:"center",key:"promotionType",width:100},{title:"开始时间",align:"center",key:"beginDate",width:120},{title:"结束时间",align:"center",key:"endDate",width:120},{title:"门店编号",align:"center",key:"storeCode",width:110},{title:"门店名称",align:"center",key:"storeName",width:100},{title:"销售编码",align:"center",key:"spuCode",width:100},{title:"商品名称",align:"center",key:"itemName",width:100},{title:"实际销量",align:"center",key:"sales",width:100},{title:"建议核销费用",align:"center",key:"suggestAmmout",width:100},{title:"状态",align:"center",key:"status",width:100}],data2:[],modal1:!1,modalLoding:!0,columns3:[{type:"index",align:"center",width:50},{title:"账号",key:"account",align:"center",width:100},{title:"公司名称",align:"center",key:"companyName"}],data3:[],value:{storeCode:"",storeName:"",spuCode:"",itemName:""},promotionCode:"",totalCount:0,bh:[],VerificationDetailList:[],atchApplicationEvent:[],initalData:[]}},mounted:function(){},methods:{initNumber:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"queryArray",a=t.target.value,i=/^[0-9]*$/;console.log(!i.test(a)),i.test(a)?(this[n][e]=a,setTimeout(function(e){return t.target.value=a})):(this[n][e]="",setTimeout(function(e){return t.target.value=""}))},init:function(){this.promotionCode=this.$route.query.promotionCode},query:function(){this.page=1,this.getData()},changePage:function(t){this.page=t,this.getData()},ok:function(){var t=this;if(!this.params.dealerCode)return this.$Message.info("请先选择支付对象"),void setTimeout(function(){t.modalLoding=!1,t.$nextTick(function(){t.modalLoading=!0,t.modal1=!0})},0);console.log(this.params),this.$ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.realTimeVerification.giftVerificationDetailApply,data:this.params}).then(function(e){console.log(e),t.$Message.info(e.data.message),200==e.data.code?(t.modal1=!1,t.getData()):t.modal1=!1}).catch(function(t){console.log("失败信息：",t)})},batch:function(){if(this.bh=[],this.VerificationDetailList=[],0==this.atchApplicationEvent.length)return void this.$Message.info("请先选择项目");var t=!1,e=[];for(var n in this.atchApplicationEvent){this.bh.push(this.atchApplicationEvent[n].promotionCode);for(var a=0;a<this.data2.length;a++)this.atchApplicationEvent[n].promotionCode==this.data2[a].promotionCode&&e.push(a);if(Number(this.atchApplicationEvent[n].suggestAmmout)>Number(this.atchApplicationEvent[n].totalFees))return this.$Message.info("核销费用超过费用科目总金额，请进入详情进行核销"),void(t=!0);if((new Date).getTime()<new Date(this.atchApplicationEvent[n].endDate).getTime()||"未核销"!=this.atchApplicationEvent[n].status)return this.$Message.info("已选项中存在未结束活动"),void(t=!0)}for(var i=0;i<e.length;i++){var o=this.initalData[e[i]];this.VerificationDetailList.push(o)}t||this.popup()},selection:function(t,e){console.log(t),this.atchApplicationEvent=[],this.atchApplicationEvent=t},radio:function(t){var e={};e.dealerCode=1*t.dealerCode,e.dmsAccount=t.account,e.uid=this.uid,e.promotionCodeList=this.bh,e.promotionVerificationDetailList=this.VerificationDetailList,this.params=e},popup:function(){var t=this;this.modal1=!0,this.data3=[];var e={};e.uid=this.uid,this.$ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.realTimeVerification.giftGetDealerAccountRelList,data:e,transformRequest:[function(t){var e="";for(var n in t)e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n])+"&";return e}],headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){e.data.result.map(function(e){var n={dealerCode:e.dealerCode,account:e.dmsAccount,companyName:e.dealerName};t.data3.push(n)}),t.params={}}).catch(function(t){console.log("失败信息：",t)})},getUserInfo:function(){var t=this,e={};this.$ajax({method:"post",url:this.$util.apiConfig.purchaseDelivery.purchaseManage.helpSellerOrder.helpSellerOrderAdd.warehouse,data:e}).then(function(e){t.uid=e.data.user.uid,t.getData()}).catch(function(t){console.log("失败信息：",t)})},getData:function(t){var e=this;this.data=[];var n={};n.pager={page:1,rows:10},n.uid=this.uid,t?(n.promotionInfoDTO={promotionCode:this.promotionCode},n.promotionVerificationDetailDTO={storeCode:"",storeName:"",spuCode:"",itemName:""}):(n.promotionInfoDTO={promotionCode:this.promotionCode},n.promotionVerificationDetailDTO={storeCode:this.value.storeCode,storeName:this.value.storeName,spuCode:this.value.spuCode,itemName:this.value.itemName}),this.loading=!0,this.$ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.realTimeVerification.giftVerificationDetailDoneList,data:n}).then(function(t){e.loading=!1,e.totalCount=t.data.result.pager.totalCount,t.data.result.pager.records.map(function(t){var n="";1==t.type?n="买赠":2==t.type?n="返利":3==t.type&&(n="特价"),console.log(t),console.log(n);var a={budgetNumber:t.budgetNumber,promotionCode:t.promotionCode,title:t.title,promotionType:n,dealerCode:t.dealerCode,beginDate:e.formatDate(t.beginDate,"yyyy-MM-DD"),endDate:e.formatDate(t.endDate,"yyyy-MM-DD"),storeCode:t.storeCode,storeName:t.storeName,spuCode:t.spuCode,itemName:t.itemName,sales:t.sales,suggestAmmout:t.suggestAmmout,totalFees:t.budgetSubjectTotal,alreadyAmmout:e.menoyToString(t.alreadyAmmout)};e.data.push(a)})}).catch(function(t){console.log("失败信息：",t)}),this.$ajax({method:"post",url:this.$util.apiConfig.promotionManage.warAdviser.realTimeVerification.giftVerificationDetailUnDoneList,data:n}).then(function(t){e.loading=!1,e.totalCount=t.data.result.totalCount,e.initalData=t.data.result.records,console.log(e.initalData),t.data.result.records.map(function(t){var n="";1==t.type?n="买赠":2==t.type?n="返利":3==t.type&&(n="特价");var a="";0==t.status?a="未核销":1==t.status&&(a="已核销");var i={budgetNumber:t.budgetNumber,promotionCode:t.promotionCode,title:t.title,promotionType:n,dealerCode:t.dealerCode,beginDate:e.formatDate(t.beginDate,"yyyy-MM-DD"),endDate:e.formatDate(t.endDate,"yyyy-MM-DD"),storeCode:t.storeCode,storeName:t.storeName,spuCode:t.spuCode,itemName:t.itemName,sales:t.sales,suggestAmmout:t.suggestAmmout,totalFees:t.budgetSubjectTotal,status:a};e.data2.push(i)})}).catch(function(t){console.log("失败信息：",t)})},menoyToString:function(t){if(null==t||t+""=="")return"0.00";var e=String(t);if(-1==String(t).indexOf("."))e+=".00";else if(String(t).indexOf(".")>=0){var n=String(t).indexOf("."),a=String(t).slice(n+1);1==a.length&&(e+="0")}return e},formatDate:function(t,e){if(""===t)return"";var n=new Date;if(n.setTime(t),!e)var e="yyyy-MM-DD hh:mm:ss";var a={"M+":n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,"D+":n.getDate()<10?"0"+n.getDate():n.getDate(),"h+":n.getHours()<10?"0"+n.getHours():n.getHours(),"m+":n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes(),"s+":n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in a)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?a[i]:("00"+a[i]).substr((""+a[i]).length)));return e},show:function(t){this.$Modal.info({title:"详情",content:"促销编码："+this.data2[t].promotionCode+"<br>促销名称："+this.data2[t].title+"<br>促销类型："+this.data2[t].promotionType+"<br>支付对象："+this.data2[t].dealerCode+"<br>开始时间："+this.data2[t].beginDate+"<br>结束时间："+this.data2[t].endDate+"<br>门店编号："+this.data2[t].storeCode+"<br>门店名称："+this.data2[t].storeName+"<br>销售编码："+this.data2[t].spuCode+"<br>商品名称："+this.data2[t].itemName+"<br>实际销量："+this.data2[t].sales+"<br>建议核销费用："+this.data2[t].suggestAmmout+"<br>已核销金额："+this.data2[t].writtenAmount})},remove:function(t){this.data2.splice(t,1)}},components:{},created:function(){this.init(),this.getUserInfo()}}},2003:function(t,e,n){var a=n(2004);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n(43)("6d021768",a,!1,{})},2004:function(t,e,n){e=t.exports=n(42)(!1),e.push([t.i,"\n.width-100 {\n  width: 100%;\n}\n.lb-left {\n  float: left;\n}\n.lb-right {\n  float: right;\n}\n.lb-center {\n  text-align: center;\n}\n.lb-promotion-main {\n  height: auto;\n  background-color: #fff;\n}\n.lb-promotion-main .lb-promotion-search {\n  border-bottom: 1px dashed #e5e5e5;\n}\n.lb-promotion-main .lb-promotion-search .lb-promotion-row {\n  margin-bottom: 14px;\n}\n.lb-promotion-main .lb-promotion-search .lb-promotion-row .ListName {\n  text-align: right;\n  line-height: 32px;\n  color: #747474;\n  font-size: 12px;\n  margin-right: 8px;\n}\n.promotion-page {\n  margin: 1rem 0 0 0;\n}\n.container {\n  background: #fff;\n  color: #747474;\n  border: 1px solid #E8E8E8;\n  padding: 1% 1% 3%;\n}\n.margin-top-8 {\n  margin-top: 8px;\n}\n.margin-top-10 {\n  margin-top: 10px;\n}\n.margin-top-20 {\n  margin-top: 20px;\n}\n.margin-left-10 {\n  margin-left: 10px;\n}\n.margin-bottom-10 {\n  margin-bottom: 10px;\n}\n.margin-bottom-12 {\n  margin-bottom: 12px;\n}\n.margin-bottom-14 {\n  margin-bottom: 14px;\n}\n.margin-bottom-100 {\n  margin-bottom: 100px;\n}\n.margin-right-10 {\n  margin-right: 10px;\n}\n.padding-left-6 {\n  padding-left: 6px;\n}\n.padding-left-8 {\n  padding-left: 5px;\n}\n.padding-left-10 {\n  padding-left: 10px;\n}\n.padding-left-20 {\n  padding-left: 20px;\n}\n.height-100 {\n  height: 100%;\n}\n.height-120px {\n  height: 100px;\n}\n.height-200px {\n  height: 200px;\n}\n.height-492px {\n  height: 492px;\n}\n.height-460px {\n  height: 460px;\n}\n.line-gray {\n  height: 0;\n  border-bottom: 2px solid #dcdcdc;\n}\n.notwrap {\n  word-break: keep-all;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.padding-left-5 {\n  padding-left: 10px;\n}\n[v-cloak] {\n  display: none;\n}\n.mb--12 {\n  margin-bottom: 12px;\n}\n.mb--14 {\n  margin-bottom: 14px;\n}\n.border-b--dashed {\n  border-bottom: 1px dashed #e5e5e5;\n}\n.pd--20 {\n  padding: 20px;\n}\n.ml--50 {\n  margin-left: 50px;\n}\n.fr {\n  float: right;\n}\n.fl {\n  float: left;\n}\n.bg--white {\n  background: #fff;\n}\n.clearfix:after {\n  content: '';\n  display: block;\n  height: 0;\n  clear: both;\n}\n.text-center {\n  text-align: center;\n}\n.white {\n  background-color: white;\n}\n.select_box {\n  padding: 20px;\n  border-bottom: 1px dashed #E8E8E8;\n}\n.ling_height {\n  padding-top: 15px;\n}\n.text_align_right {\n  text-align: right;\n}\n.text_align_center {\n  text-align: center;\n}\n.operation_box {\n  padding: 10px 20px;\n  text-align: right;\n}\n.page_right {\n  text-align: right;\n  padding: 10px 20px;\n}\n.input_width {\n  width: 120px;\n}\n.search_btn {\n  width: 100px;\n}\n.margin_bottom_0 {\n  margin-bottom: 0;\n}\n.ivu-breadcrumb a {\n  color: #999;\n}\n.ivu-breadcrumb {\n  font-size: 12px;\n}\n.ivu-breadcrumb > span:last-child {\n  color: #426196;\n}\n.box_shadow {\n  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);\n  border-color: #eee;\n}\n.border_bottom_dashed {\n  border-bottom: 1px dashed #E8E8E8;\n}\n.problem_table .ivu-checkbox-wrapper {\n  margin-right: 0px;\n}\n.buy-detail-page {\n  width: 100%;\n  height: 100%;\n  background: #fff;\n  color: #747474;\n  border: 1px solid #E8E8E8;\n  text-align: center;\n  padding: 10px 0;\n}\n.buy-detail-page .head {\n  padding: 20px 0;\n  border-bottom: 1px dashed #E8E8E8;\n}\n.buy-detail-page .head .head_left {\n  padding: 10px 0;\n  border-right: 1px dashed #E8E8E8;\n}\n.buy-detail-page .head .head_left #storesNumber {\n  width: 50%;\n}\n.buy-detail-page .head .head_left #storesName {\n  width: 50%;\n}\n.buy-detail-page .head .head_left #productId {\n  width: 50%;\n}\n.buy-detail-page .head .head_left #productName {\n  width: 50%;\n}\n.buy-detail-page .head .head_right .query {\n  margin-bottom: 10px;\n}\n.buy-detail-page .table {\n  margin: 1%;\n}\n.buy-detail-page .page {\n  text-align: right;\n  margin-right: 1%;\n}\n.buy-detail-page .ti {\n  margin-top: 10px;\n}\n",""])},2005:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"buy-detail-page"},[n("Row",{staticClass:"head"},[n("Col",{staticClass:"head_left",attrs:{span:"21"}},[n("Row",[n("Col",{attrs:{span:"6"}},[n("label",{attrs:{for:"storeCode"}},[t._v("门店编号 :  ")]),n("Input",{staticStyle:{width:"120px"},attrs:{value:t.value.storeCode,id:"storeCode"},on:{"on-change":function(e){return t.initNumber(e,"storeCode","value")}}})],1),t._v(" "),n("Col",{attrs:{span:"6"}},[n("label",{attrs:{for:"storeName"}},[t._v("门店名称 :  ")]),n("Input",{staticStyle:{width:"120px"},attrs:{id:"storeName"},model:{value:t.value.storeName,callback:function(e){t.$set(t.value,"storeName",e)},expression:"value.storeName"}})],1),t._v(" "),n("Col",{attrs:{span:"6"}},[n("label",{attrs:{for:"spuCode"}},[t._v("销售编码 :  ")]),n("Input",{staticStyle:{width:"120px"},attrs:{value:t.value.spuCode,id:"spuCode"},on:{"on-change":function(e){return t.initNumber(e,"spuCode","value")}}})],1),t._v(" "),n("Col",{attrs:{span:"6"}},[n("label",{attrs:{for:"itemName"}},[t._v("商品名称 :  ")]),n("Input",{staticStyle:{width:"120px"},attrs:{id:"itemName"},model:{value:t.value.itemName,callback:function(e){t.$set(t.value,"itemName",e)},expression:"value.itemName"}})],1)],1)],1),t._v(" "),n("Col",{staticClass:"head_right",attrs:{span:"3"}},[n("Button",{staticClass:"query",on:{click:t.query}},[t._v("查询")]),n("br")],1)],1),t._v(" "),n("h1",{staticClass:"ti"},[t._v("已申请")]),t._v(" "),n("Table",{staticClass:"table",attrs:{loading:t.loading,columns:t.columns,data:t.data}}),t._v(" "),n("Page",{attrs:{total:t.totalCount,"show-total":"","show-elevator":"","class-name":"page"}}),t._v(" "),n("h1",{staticClass:"ti"},[t._v("未申请")]),t._v(" "),n("Table",{staticClass:"table",attrs:{loading:t.loading,columns:t.columns2,data:t.data2},on:{"on-selection-change":t.selection}}),t._v(" "),n("Page",{attrs:{total:t.totalCount,"show-total":"","show-elevator":"","class-name":"page"}}),t._v(" "),n("Modal",{attrs:{title:"请单击行选择入账账号",loading:t.modalLoding,"mask-closable":!1},on:{"on-ok":t.ok},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[n("Table",{staticClass:"table2",attrs:{height:"300","highlight-row":"",columns:t.columns3,data:t.data3},on:{"on-row-click":t.radio}})],1)],1)},i=[];a._withStripped=!0;var o={render:a,staticRenderFns:i};e.default=o},700:function(t,e,n){"use strict";function a(t){d||n(2003)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1582),o=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);var l=n(2005),s=n.n(l),d=!1,p=n(13),g=a,h=p(o.a,s.a,!1,g,null,null);h.options.__file="src/views/promotion-manage/war-adviser/real-time-verification/buy-present-promotion/buy-detail-page/buy-detail-page.vue",e.default=h.exports}});