webpackJsonp([254],{1580:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(65),n=function(t){return t&&t.__esModule?t:{default:t}}(o);e.default={data:function(){var t=this;return{tableShow:!0,calendar:[],endTimeOptions:{disabledDate:function(e){return e&&e.valueOf()+864e5-1<new Date(t.searchObj.startTime)}},checkedArr:[],columns:[{type:"selection",align:"center",width:58,fixed:"left"},{title:"序号",align:"center",width:70,type:"index"},{title:"促销编码",align:"center",width:150,render:function(e,a){return e("span",{on:{click:function(){t.getDetailById(a.row).then(function(e){if(200!==e.data.code)return void t.$Message.error(e.data.message);e.data.result.disabled=!0,e.data.result.disabledInfo=!0,e.data.result.isDetail=!0,sessionStorage.setItem("marketingSecondKillObject",(0,n.default)(e.data.result)),t.$router.push({name:"second-kill-detail"})}).catch(function(t){console.log("错误信息：",t)})}},style:{cursor:"pointer",color:"#2d8cf0"}},a.row.promotionCode)}},{title:"活动名称",align:"center",key:"title",width:150},{title:"商品名称",align:"center",key:"itemName",width:180},{title:"档期",align:"center",key:"sessionName",width:155},{title:"状态",align:"center",width:80,render:function(t,e){var a="";return 1===e.row.status?a="未生效":2===e.row.status?a="预热中":3===e.row.status?a="生效中":4===e.row.status?a="已售罄":5===e.row.status?a="已失效":6===e.row.status&&(a="已下架"),t("span",{},a)}},{title:"秒杀价",align:"center",key:"promPrice",width:100},{title:"均限购",align:"center",key:"maxBuyCnt",width:100},{title:"起卖数",align:"center",key:"startSellNum",width:100},{title:"总数",align:"center",key:"promStock",width:120},{title:"操作",align:"center",fixed:"right",width:235,render:function(e,a){var o="",s="",r="",i="";return 6===a.row.status?o=e("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){console.log(a),t.$util.ajax({method:"POST",url:t.$util.apiConfig.promotionManage.warProgramme.o2oSecondKill.putOnPromotion,data:{promotionCode:a.row.promotionCode,status:a.row.status,id:a.row.promotionId,sessionId:a.row.sessionId}}).then(function(e){if(200!==e.data.code)return void t.$Message.error(e.data.message);t.$Message.success(e.data.message),t.getPromotionList()})}}},"上架"):3!==a.row.status&&2!==a.row.status&&1!==a.row.status||(o=e("Button",{props:{type:"error",size:"small"},style:{marginRight:"5px"},on:{click:function(){console.log(a),t.$util.ajax({method:"POST",url:t.$util.apiConfig.promotionManage.warProgramme.o2oSecondKill.pullOffPromotion,data:{promotionCode:a.row.promotionCode,status:a.row.status,id:a.row.promotionId,sessionId:a.row.sessionId}}).then(function(e){if(200!==e.data.code)return void t.$Message.error(e.data.message);t.$Message.success(e.data.message),t.getPromotionList()})}}},"下架")),1!==a.row.status&&6!==a.row.status||(s=e("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.getDetailById(a.row).then(function(e){if(200!==e.data.code)return void t.$Message.error(e.data.message);6===a.row.status&&(e.data.result.disabled=!0),e.data.result.edit=!0,sessionStorage.setItem("marketingSecondKillObject",(0,n.default)(e.data.result)),t.$router.push({name:"directional-rule"})}).catch(function(t){console.log("错误信息：",t)})}}},"修改")),6!==a.row.status&&5!==a.row.status&&4!==a.row.status&&(r=e("Button",{props:{type:"ghost",size:"small"},on:{click:function(){t.refreshPromotionCache(a.row)}}},"刷新缓存")),i=e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.getDetailById(a.row).then(function(e){if(200!==e.data.code)return void t.$Message.error(e.data.message);sessionStorage.setItem("marketingSecondKillObject",(0,n.default)({promotionSeckillInfo:e.data.result.promotionSeckillInfo})),t.$router.push({name:"directional-rule"})}).catch(function(t){console.log("错误信息：",t)})}}},"复制"),e("div",[o,s,i,r])}}],dataTotal:0,pageSize:10,pageNum:1,data:[],loading:!1,searchObj:{goodsName:"",activityName:"",currentStatus:null,sessionId:"",promotionCode:""}}},methods:{searchBtn:function(){this.pageNum=1,this.getPromotionList()},pageSizeChange:function(t){this.pageSize=t,this.getPromotionList()},pageNumChange:function(t){this.pageNum=t,this.getPromotionList()},getcalendar:function(){var t=this;this.$util.ajax({method:"POST",url:this.$util.apiConfig.promotionManage.warProgramme.o2oSecondKill.getSessionList,data:{}}).then(function(e){if(200!==e.data.code)return void t.$Message.error({content:e.data.message,duration:3});t.calendar=e.data.result.rows}).catch(function(t){console.log("错误信息：",t)})},getDetailById:function(t){return this.$util.ajax.post(this.$util.apiConfig.promotionManage.warProgramme.o2oSecondKill.queryPromotionInfoDetail,{id:t.promotionId,promotionCode:t.promotionCode})},pageNumChangeCancelChecked:function(){var t=this;this.data.map(function(t){t._disabled=!1}),this.data.map(function(t){t._checked=!0}),setTimeout(function(){t.data.map(function(t){t._checked=!1})}),this.checkedArr=[]},changeStatus:function(t){this.pageNum=1,this.searchObj.currentStatus=t,this.pageNumChangeCancelChecked(),this.getPromotionList()},addBtn:function(){sessionStorage.removeItem("marketingSecondKillObject"),this.$router.push({name:"directional-rule"})},refreshPromotionCache:function(t){var e=this;this.$util.ajax.post(this.$util.apiConfig.promotionManage.warProgramme.o2oSecondKill.refreshPromotionCache,[t.promotionId]).then(function(t){if(200!==t.data.code)return void e.$Message.error(t.data.message);e.$Message.success(t.data.message)}).catch(function(t){console.log("错误信息：",t)})},deleteBtn:function(){var t=this;if(0===this.checkedArr.length)return void this.$Message.warning("请选择想删除的活动");this.$Modal.confirm({title:"提示",content:"你确定要删除选中的活动吗？",onOk:function(){t.$util.ajax.post(t.$util.apiConfig.promotionManage.warProgramme.o2oSecondKill.deletePromotion,t.checkedArr).then(function(e){if(200!==e.data.code)return void t.$Message.error(e.data.message);t.$Message.success(e.data.message),t.getPromotionList()}).catch(function(t){console.log("错误信息：",t)})},onCancel:function(){}})},selectionChange:function(t){var e=this;this.checkedArr=[],t.map(function(t){e.checkedArr.push(t.promotionId)})},getPromotionList:function(){var t=this;this.loading=!0,this.$util.ajax.post(this.$util.apiConfig.promotionManage.warProgramme.o2oSecondKill.getPromotionList,{sessionId:this.searchObj.sessionId,status:this.searchObj.currentStatus,title:this.searchObj.activityName,itemName:this.searchObj.goodsName,promotionCode:this.searchObj.promotionCode,pager:{page:this.pageNum,rows:this.pageSize}}).then(function(e){if(200!==e.data.code)return void t.$Message.error({content:e.data.message,duration:3});t.tableShow=!1,setTimeout(function(){t.tableShow=!0});var a=[],o=!1;e.data.result.rows.map(function(t){t._checked=!1,t._disabled=!1,1!==t.status&&(t._disabled=!0),a.push(t.status)});for(var n=0;n<a.length;n++)if(6===a[n]||3===a[n]||2===a[n]||1===a[n]){o=!0;break}t.columns[t.columns.length-1].width=o?235:77,t.dataTotal=e.data.result.total,t.data=e.data.result.rows,t.loading=!1}).catch(function(e){console.log("错误信息",e),t.$Message.error({content:"服务器异常",duration:3})})}},created:function(){this.getcalendar(),this.getPromotionList()}}},1995:function(t,e,a){var o=a(1996);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a(43)("47a88356",o,!1,{})},1996:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.container .table .tableTop[data-v-757f3e79] {\n  margin: 0 1% 2px;\n}\n.container .table .tableTop .searchGroup .searchTop[data-v-757f3e79] {\n  padding-bottom: 15px;\n  border-bottom: 1px dashed #E8E8E8;\n}\n.container .table .tableTop .searchGroup .searchTop .searchTopItem[data-v-757f3e79] {\n  display: -ms-flexbox;\n  display: flex;\n}\n.container .table .tableTop .searchGroup .searchTop .searchTopItem > label[data-v-757f3e79] {\n  width: 60px;\n}\n.container .table .tableTop .searchGroup .searchTop .searchTopItem > .searchTopcalendar[data-v-757f3e79] {\n  width: 36px;\n}\n.container .table .tableTop .searchGroup .searchTop .searchTopItem > .searchTopInput[data-v-757f3e79] {\n  -ms-flex: 8;\n      flex: 8;\n}\n.container .table .tableTop .searchGroup .searchTop .searchTopItem > .space[data-v-757f3e79] {\n  -ms-flex: 1;\n      flex: 1;\n}\n.container .table .tableTop .searchGroup .searchTop .searchTopLabel[data-v-757f3e79],\n.container .table .tableTop .searchGroup .searchTop .searchTopcalendar[data-v-757f3e79] {\n  color: rgba(0, 0, 0, 0.85);\n  height: 32px;\n  line-height: 32px;\n}\n.container .table .tableTop .searchGroup .searchTop .lastCol[data-v-757f3e79] {\n  float: right;\n}\n.container .table .tableTop .searchGroup .searchTop .lastCol Button[data-v-757f3e79] {\n  margin-right: 10px;\n}\n.container .table .tableTop .searchGroup .searchTop .lastCol Button[data-v-757f3e79]:last-of-type {\n  margin-right: 0;\n}\n.container .table .tableTop .searchGroup .searchBottom[data-v-757f3e79] {\n  height: 40px;\n  line-height: 40px;\n  position: relative;\n  margin-top: 10px;\n}\n.container .table .tableTop .searchGroup .searchBottom .status[data-v-757f3e79] {\n  width: 100%;\n  display: -ms-flexbox;\n  display: flex;\n}\n.container .table .tableTop .searchGroup .searchBottom .status .label[data-v-757f3e79] {\n  color: rgba(0, 0, 0, 0.85);\n  width: 45px;\n}\n.container .table .tableTop .searchGroup .searchBottom .status .ul[data-v-757f3e79] {\n  list-style: none;\n  display: inline-block;\n  -ms-flex: 1;\n      flex: 1;\n}\n.container .table .tableTop .searchGroup .searchBottom .status .ul li[data-v-757f3e79] {\n  display: inline-block;\n  margin: 0 5px;\n  line-height: 14px;\n  padding: 4px 14px;\n  border-radius: 3px;\n  cursor: pointer;\n  border: 1px solid transparent;\n}\n.container .table .tableTop .searchGroup .searchBottom .status .ul li.current[data-v-757f3e79] {\n  background-color: #2d8cf0;\n  border-color: #2d8cf0;\n  color: #fff;\n}\n.container .table .tableTop .searchGroup .searchBottom .button[data-v-757f3e79] {\n  position: absolute;\n  right: 0;\n  top: -1px;\n}\n.container .table .tableTop .searchGroup .searchBottom .button Button[data-v-757f3e79] {\n  margin-right: 10px;\n}\n.container .table .tableTop .searchGroup .searchBottom .button Button[data-v-757f3e79]:last-of-type {\n  margin-right: 0;\n}\n.container .table .tableTop .deleteGroup[data-v-757f3e79] {\n  margin-bottom: 6px;\n}\n.container .table .tableTop .deleteGroup .selectNum[data-v-757f3e79] {\n  line-height: 31px;\n  padding-left: 35px;\n  color: rgba(0, 0, 0, 0.85);\n  position: relative;\n}\n.container .table .tableTop .deleteGroup .selectNum .cancelChecked[data-v-757f3e79] {\n  font-size: 34px;\n  color: rgba(0, 0, 0, 0.85);\n  position: absolute;\n  cursor: pointer;\n  left: 9px;\n  top: -2px;\n}\n.container .table .tableTop .deleteGroup .selectNum .selected .number[data-v-757f3e79] {\n  color: #2d8cf0;\n  display: inline-block;\n  margin: 0 5px;\n}\n.container .table .tableTop .deleteGroup .selectNum .split[data-v-757f3e79] {\n  margin: 0 25px 0 35px;\n  font-size: 18px;\n  color: #DDDEE1;\n}\n.container .table .tableTop .deleteGroup .selectNum .btn[data-v-757f3e79] {\n  margin-right: 10px;\n  color: #495060;\n  padding: 5px 10px 5px 35px;\n  cursor: pointer;\n  position: relative;\n  font-size: 13px;\n}\n.container .table .tableTop .deleteGroup .selectNum .btn[data-v-757f3e79]:hover {\n  color: red;\n}\n.container .table .tableTop .deleteGroup .selectNum .btn:hover .icon[data-v-757f3e79] {\n  color: #f10;\n}\n.container .table .tableTop .deleteGroup .selectNum .btn .icon[data-v-757f3e79] {\n  color: #dedada;\n  font-size: 20px;\n  position: absolute;\n  left: 10px;\n  top: 2px;\n}\n.container .table .page[data-v-757f3e79] {\n  text-align: right;\n  margin-right: 1%;\n  margin-top: 5px;\n  position: relative;\n}\n",""])},1997:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"table"},[a("div",{staticClass:"tableTop"},[a("div",{staticClass:"searchGroup"},[a("Row",{staticClass:"searchTop"},[a("Col",{staticClass:"searchTopItem",attrs:{span:"5"}},[a("label",{staticClass:"searchTopLabel",attrs:{for:"activityName"}},[t._v("活动名称：")]),t._v(" "),a("Input",{staticClass:"searchTopInput",attrs:{id:"activityName"},model:{value:t.searchObj.activityName,callback:function(e){t.$set(t.searchObj,"activityName",e)},expression:"searchObj.activityName"}}),t._v(" "),a("div",{staticClass:"space"})],1),t._v(" "),a("Col",{staticClass:"searchTopItem",attrs:{span:"5"}},[a("label",{staticClass:"searchTopLabel",attrs:{for:"promotionCode"}},[t._v("促销编码：")]),t._v(" "),a("Input",{staticClass:"searchTopInput",attrs:{id:"promotionCode"},model:{value:t.searchObj.promotionCode,callback:function(e){t.$set(t.searchObj,"promotionCode",e)},expression:"searchObj.promotionCode"}}),t._v(" "),a("div",{staticClass:"space"})],1),t._v(" "),a("Col",{staticClass:"searchTopItem",attrs:{span:"5"}},[a("label",{staticClass:"searchTopLabel",attrs:{for:"goodsName"}},[t._v("商品名称：")]),t._v(" "),a("Input",{staticClass:"searchTopInput",attrs:{id:"goodsName"},model:{value:t.searchObj.goodsName,callback:function(e){t.$set(t.searchObj,"goodsName",e)},expression:"searchObj.goodsName"}}),t._v(" "),a("div",{staticClass:"space"})],1),t._v(" "),a("Col",{staticClass:"searchTopItem",attrs:{span:"4"}},[a("label",{staticClass:"searchTopcalendar",attrs:{for:"calendar"}},[t._v("档期：")]),t._v(" "),a("Select",{staticClass:"searchTopInput",attrs:{id:"calendar",clearable:""},model:{value:t.searchObj.sessionId,callback:function(e){t.$set(t.searchObj,"sessionId",e)},expression:"searchObj.sessionId"}},t._l(t.calendar,function(e,o){return a("Option",{key:o,attrs:{value:e.sessionId}},[t._v(t._s(e.sessionName))])})),t._v(" "),a("div",{staticClass:"space"})],1),t._v(" "),a("div",{staticClass:"lastCol"},[a("Button",{attrs:{type:"primary"},on:{click:t.searchBtn}},[t._v("查询")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.addBtn}},[t._v("新增")])],1)],1),t._v(" "),a("div",{staticClass:"searchBottom"},[a("div",{staticClass:"status"},[a("span",{staticClass:"label"},[t._v("状态：")]),t._v(" "),a("ul",{staticClass:"ul"},[a("li",{class:{current:null===t.searchObj.currentStatus},on:{click:function(e){t.changeStatus(null)}}},[t._v("全部")]),t._v(" "),a("li",{class:{current:1===t.searchObj.currentStatus},on:{click:function(e){t.changeStatus(1)}}},[t._v("未生效")]),t._v(" "),a("li",{class:{current:2===t.searchObj.currentStatus},on:{click:function(e){t.changeStatus(2)}}},[t._v("预热中")]),t._v(" "),a("li",{class:{current:3===t.searchObj.currentStatus},on:{click:function(e){t.changeStatus(3)}}},[t._v("生效中")]),t._v(" "),a("li",{class:{current:4===t.searchObj.currentStatus},on:{click:function(e){t.changeStatus(4)}}},[t._v("已售罄")]),t._v(" "),a("li",{class:{current:5===t.searchObj.currentStatus},on:{click:function(e){t.changeStatus(5)}}},[t._v("已失效")]),t._v(" "),a("li",{class:{current:6===t.searchObj.currentStatus},on:{click:function(e){t.changeStatus(6)}}},[t._v("已下架")])])]),t._v(" "),a("div",{staticClass:"button"},[a("Button",{attrs:{type:"error"},on:{click:t.deleteBtn}},[t._v("删除")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.$router.push({name:"auction-calendar"})}}},[t._v("档期列表")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.$router.push({name:"second-kill-cache-release"})}}},[t._v("缓存释放管理")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:function(e){t.$router.push({name:"second-kill-order"})}}},[t._v("订单列表")])],1)])],1)]),t._v(" "),t.tableShow?a("Table",{staticClass:"problem_table",attrs:{stripe:"",columns:t.columns,data:t.data,loading:t.loading},on:{"on-selection-change":t.selectionChange}}):t._e(),t._v(" "),a("Page",{attrs:{total:t.dataTotal,"show-sizer":"","show-total":"","show-elevator":"",current:t.pageNum,"class-name":"page"},on:{"on-change":t.pageNumChange,"on-page-size-change":t.pageSizeChange}})],1)])},n=[];o._withStripped=!0;var s={render:o,staticRenderFns:n};e.default=s},698:function(t,e,a){"use strict";function o(t){l||a(1995)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(1580),s=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);var i=a(1997),c=a.n(i),l=!1,u=a(13),d=o,p=u(s.a,c.a,!1,d,"data-v-757f3e79",null);p.options.__file="src/views/promotion-manage/second-kill/second-kill.vue",e.default=p.exports}});