webpackJsonp([260],{1563:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(241),i=n(s),l=a(242),r=n(l),d=a(146),o=n(d),u=a(239);t.default={data:function(){return{handleExpandID:[],loading:!1,menu:[],editInfo:{},editType:0,disableEdit:!0,selectedMenuItem:{},checkedMenuGroup:[],deleteList:[],apiGroup:this.$util.apiConfig.permissionManage.menu}},computed:{btnGroupDisabled:function(){return!this.selectedMenuItem.name},deleteBtnDisabled:function(){return!(this.deleteList.length>0)},saveBtnDisabled:function(){var e=this.editInfo.name,t=parseInt(this.editInfo.serial);return!e||(!!isNaN(t)||(e.replace(/ /g,"").length<1||t<0))}},created:function(){this.getMenu()},methods:{handleExpand:function(e){var t=e.expand,a=e.id,n=this.handleExpandID.findIndex(function(e){return e==a});t?-1==n?this.handleExpandID.push(e.id):this.handleExpandID:(-1!=n?this.handleExpandID.splice(n,1):this.handleExpandID,this.menu=this.initMenuData(this.menu,a)),console.log(this.menu)},initMenuId:function(e){var t=this.handleExpandID;if(t.length)for(var a=0;a<t.length;a++)this.initMenuList(this.menu,t[a],e)},initMenuList:function(e,t,a){for(var n in e){e[n].id==t&&(a?e[n].expand=a:delete e[n].expand,console.log(e[n]));var s=e[n].children;s&&this.initMenuList(s,t,a)}},initMenuData:function(e,t){var a=this;if(e instanceof Array)return e.map(function(e){return a.initMenuData(e)});var n=(0,o.default)({},e,{title:e.name});return n.id==t?delete n.expand:n.children=this.initMenuData(n.children),n},getMenu:function(){function e(){return t.apply(this,arguments)}var t=(0,r.default)(i.default.mark(function e(){var t,a,n,s,l;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="",a=this,a.loading=!0,e.prev=3,e.next=6,a.$ajax.post(a.apiGroup.refresh);case 6:n=e.sent,s=n.data,s instanceof Object?(l=localStorage.getItem("promotionMode"),2===parseInt(l)&&(s.children=a.$util.sellerModePage(s.children)),a.menu=a.transRes2Menu([s]),a.initMenuId(!0)):t="菜单数据请求失败",e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.error(e.t0),t="菜单数据请求失败";case 15:a.loading=!1,t&&a.$Message.error(t);case 17:case"end":return e.stop()}},e,this,[[3,11]])}));return e}(),transRes2Menu:function(e){var t=this;if(e instanceof Array)return e.map(function(e){return t.transRes2Menu(e)});var a=(0,o.default)({},e,{title:e.name});return a.children.length<0?delete a.children:a.children=this.transRes2Menu(a.children),a},handleSelected:function(){function e(e){return t.apply(this,arguments)}var t=(0,r.default)(i.default.mark(function e(t){var a,n,s,l,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.disableEdit=!0,this.editInfo={name:""},!(t.length<1)){e.next=5;break}return this.selectedMenuItem={},e.abrupt("return");case 5:if(a=t[0],n=a.id,s=a.pId,this.editType=0,this.selectedMenuItem=t[0],0!=n){e.next=12;break}return this.editInfo={name:"root",level:0,system:1,serial:0},e.abrupt("return");case 12:return e.prev=13,e.next=16,this.$ajax.post(this.apiGroup.menuInfo,u.stringify({id:n}));case 16:l=e.sent,r=l.data,r.success?(this.editInfo=(0,o.default)({},r.menuVO,{system:r.menuVO.system?1:0}),this.disableEdit=!1):this.$Message.error(r.msg),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(13),this.$Message.error("修改数据请求失败"),console.error(e.t0);case 25:case"end":return e.stop()}},e,this,[[13,21]])}));return e}(),handleChecked:function(e){this.deleteList=e},handleCreateBtnClick:function(){this.editType=1;var e=this.selectedMenuItem.name.split("-")[0],t=1,a=1;this.editInfo.level&&(t=parseInt(this.editInfo.level)+1),(this.editInfo.system||0==this.editInfo.system)&&(a=this.editInfo.system),this.editInfo.name&&(e=this.editInfo.name),this.editInfo={pId:this.selectedMenuItem.id,parent:e,name:"",level:t,code:"",serial:1,imgPath:"",url:"",system:a}},submitCreate:function(){function e(){return t.apply(this,arguments)}var t=(0,r.default)(i.default.mark(function e(){var t,a,n,s,l,r,d,o,c,p,v,f,h,m,b=this;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.editInfo,a=t.id,n=t.pId,s=t.name,l=t.code,r=t.level,d=t.serial,o=t.system,c=t.imgPath,p=t.url,v="",e.prev=2,e.next=5,this.$ajax.post(this.apiGroup.addMenu,u.stringify({id:a,pId:n,name:s,code:l,level:r,serial:d,imgPath:c,url:p,system:!!o}));case 5:f=e.sent,h=f.data,m=h.msg,h.success?(this.disableEdit=!0,setTimeout(function(e){b.$Modal.success({content:"添加成功",onOk:function(e){return b.getMenu()}})},500)):v=m,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),v="添加请求发送失败",console.error(e.t0);case 15:v&&setTimeout(function(e){return b.$Modal.error({content:v})},500);case 16:case"end":return e.stop()}},e,this,[[2,11]])}));return e}(),submitSave:function(){function e(){return t.apply(this,arguments)}var t=(0,r.default)(i.default.mark(function e(){var t,a,n,s,l,r,d,o,c,p,v,f,h,m,b=this;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.editInfo,a=t.id,n=t.pId,s=t.name,l=t.code,r=t.level,d=t.serial,o=t.system,c=t.imgPath,p=t.url,v="",e.prev=2,e.next=5,this.$ajax.post(this.apiGroup.updateMenu,u.stringify({id:a,pId:n,name:s,code:l,level:r,serial:d,imgPath:c,url:p,system:!!o}));case 5:f=e.sent,h=f.data,m=h.msg,h.success?(this.disableEdit=!0,setTimeout(function(e){b.$Modal.success({content:"保存成功",onOk:function(){b.getMenu()}})},500)):v=m,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),v="保存请求发送失败",console.error(e.t0);case 15:v&&setTimeout(function(e){return b.$Modal.error({content:v})},500);case 16:case"end":return e.stop()}},e,this,[[2,11]])}));return e}()}}},1944:function(e,t,a){var n=a(1945);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(43)("ee98e394",n,!1,{})},1945:function(e,t,a){t=e.exports=a(42)(!1),t.push([e.i,"\n.top-btn-group[data-v-7e3b9db2] {\n  margin-bottom: 10px;\n  padding: 0 20px;\n}\n.tree-container[data-v-7e3b9db2] {\n  border: 1px solid #ddd;\n  margin: 10px;\n  padding: 10px;\n  border-radius: 5px;\n  margin-top: 0;\n}\n.edit .edit-pannel[data-v-7e3b9db2] {\n  margin-left: 20px;\n}\n.edit h3[data-v-7e3b9db2] {\n  margin-bottom: 20px;\n}\n.edit div.row[data-v-7e3b9db2] {\n  margin-bottom: 10px;\n}\n.edit span.label[data-v-7e3b9db2] {\n  width: 80px;\n  text-align: right;\n  line-height: 32px;\n  display: inline-block;\n}\n.edit span.input[data-v-7e3b9db2] {\n  width: auto;\n  display: inline-block;\n}\n.edit .save[data-v-7e3b9db2] {\n  margin-top: 20px;\n  text-align: center;\n}\n.edit [required][data-v-7e3b9db2] {\n  color: red;\n}\n",""])},1946:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Card",[a("Spin",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{size:"large",fix:""}}),e._v(" "),a("Row",{staticClass:"top-btn-group"},[a("Col",[a("Button",{attrs:{type:"success",disabled:e.btnGroupDisabled},on:{click:e.handleCreateBtnClick}},[e._v("添加子菜单")])],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"12"}},[a("div",{staticClass:"tree-container"},[a("Tree",{ref:"menuTree",staticClass:"tree",attrs:{data:e.menu,"show-checkbox":""},on:{"on-select-change":e.handleSelected,"on-toggle-expand":e.handleExpand,"on-check-change":e.handleChecked}})],1)]),e._v(" "),a("Col",{staticClass:"edit",attrs:{span:"12"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.editType,expression:"editType == 0"}],staticClass:"update edit-pannel"},[a("h3",[e._v("修改")]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",{attrs:{required:""}},[e._v("*")]),e._v(" "),a("span",[e._v("菜单名:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text",disabled:e.disableEdit},model:{value:e.editInfo.name,callback:function(t){e.$set(e.editInfo,"name",t)},expression:"editInfo.name"}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",[e._v("级别:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text",value:e.editInfo.level,disabled:!0}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",[e._v("菜单编码:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text",value:e.editInfo.code,disabled:!0}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",{attrs:{required:""}},[e._v("*")]),e._v(" "),a("span",[e._v("序号:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text",disabled:e.disableEdit},model:{value:e.editInfo.serial,callback:function(t){e.$set(e.editInfo,"serial",t)},expression:"editInfo.serial"}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",[e._v("图标地址:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text",disabled:e.disableEdit},model:{value:e.editInfo.imgPath,callback:function(t){e.$set(e.editInfo,"imgPath",t)},expression:"editInfo.imgPath"}})],1)]),e._v(" "),a("div",{staticClass:"row",staticStyle:{display:"flex"}},[a("span",{staticClass:"label",staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end","flex-grow":"0"}},[a("span",[e._v("URL:")])]),e._v(" "),a("span",{staticStyle:{display:"inline-flex","margin-left":"5px","flex-grow":"1"}},[a("Input",{attrs:{type:"textarea",rows:4,disabled:e.disableEdit},model:{value:e.editInfo.url,callback:function(t){e.$set(e.editInfo,"url",t)},expression:"editInfo.url"}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",[e._v("系统菜单:")])]),e._v(" "),a("span",{staticClass:"input"},[a("RadioGroup",{model:{value:e.editInfo.system,callback:function(t){e.$set(e.editInfo,"system",t)},expression:"editInfo.system"}},[a("Radio",{attrs:{label:1,disabled:e.disableEdit}},[e._v("系统")]),e._v(" "),a("Radio",{attrs:{label:0,disabled:e.disableEdit}},[e._v("非系统")])],1)],1)]),e._v(" "),a("div",{staticClass:"row save"},[a("Button",{attrs:{type:"primary",disabled:e.saveBtnDisabled},on:{click:e.submitSave}},[e._v("保存")])],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.editType,expression:"editType == 1"}],staticClass:"update edit-pannel"},[a("h3",[e._v("修改")]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",[e._v("父节点:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text",value:e.editInfo.parent,disabled:!0}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",{attrs:{required:""}},[e._v("*")]),e._v(" "),a("span",[e._v("菜单名:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text"},model:{value:e.editInfo.name,callback:function(t){e.$set(e.editInfo,"name",t)},expression:"editInfo.name"}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",[e._v("级别:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text",value:e.editInfo.level,disabled:!0}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",[e._v("菜单编码:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text",value:e.editInfo.code,disabled:!0}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",{attrs:{required:""}},[e._v("*")]),e._v(" "),a("span",[e._v("序号:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text"},model:{value:e.editInfo.serial,callback:function(t){e.$set(e.editInfo,"serial",t)},expression:"editInfo.serial"}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",[e._v("图标地址:")])]),e._v(" "),a("span",{staticClass:"input"},[a("Input",{attrs:{type:"text"},model:{value:e.editInfo.imgPath,callback:function(t){e.$set(e.editInfo,"imgPath",t)},expression:"editInfo.imgPath"}})],1)]),e._v(" "),a("div",{staticClass:"row",staticStyle:{display:"flex"}},[a("span",{staticClass:"label",staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end","flex-grow":"0"}},[a("span",[e._v("URL:")])]),e._v(" "),a("span",{staticStyle:{display:"inline-flex","margin-left":"5px","flex-grow":"1"}},[a("Input",{attrs:{type:"textarea",rows:4},model:{value:e.editInfo.url,callback:function(t){e.$set(e.editInfo,"url",t)},expression:"editInfo.url"}})],1)]),e._v(" "),a("div",{staticClass:"row"},[a("span",{staticClass:"label"},[a("span",[e._v("系统菜单:")])]),e._v(" "),a("span",{staticClass:"input"},[a("RadioGroup",{model:{value:e.editInfo.system,callback:function(t){e.$set(e.editInfo,"system",t)},expression:"editInfo.system"}},[a("Radio",{attrs:{label:1}},[e._v("系统")]),e._v(" "),a("Radio",{attrs:{label:0}},[e._v("非系统")])],1)],1)]),e._v(" "),a("div",{staticClass:"row save"},[a("Button",{attrs:{type:"primary",disabled:e.saveBtnDisabled},on:{click:e.submitCreate}},[e._v("保存")])],1)])])],1)],1)},s=[];n._withStripped=!0;var i={render:n,staticRenderFns:s};t.default=i},681:function(e,t,a){"use strict";function n(e){o||a(1944)}Object.defineProperty(t,"__esModule",{value:!0});var s=a(1563),i=a.n(s);for(var l in s)"default"!==l&&function(e){a.d(t,e,function(){return s[e]})}(l);var r=a(1946),d=a.n(r),o=!1,u=a(13),c=n,p=u(i.a,d.a,!1,c,"data-v-7e3b9db2",null);p.options.__file="src/views/permission-manage/system-menu.vue",t.default=p.exports}});