webpackJsonp([266],{1450:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(241),o=a(n),i=r(242),u=a(i),l=r(146),c=a(l),s=r(239);t.default={props:{storeCode:"",visible:!1},data:function(){var e=this;return{dialogVisible:!1,total:0,apiGroup:e.$util.apiConfig.traderManage.orderManage,query:{queryItemName:"",queryItem69:"",queryItem79:"",page:1},dataSource:[],dataSourceSelected:[],dataColumns:[{type:"selection",width:60,align:"center"},{title:"商品名称",align:"center",key:"spuName"},{title:"商品类型",align:"center",key:"itemType",render:function(e,t){var r="-";if(t.row.itemType){switch(parseInt(t.row.itemType)){case 1:r="常规装";break;case 2:r="促销装";break;case 3:r="赠品/非单卖品";break;case 4:r="广宣品";break;default:r="-"}}return e("span",r)}},{title:"条形码",align:"center",key:"code69"},{title:"销售编码",align:"center",key:"code79"},{title:"转化系数",align:"center",key:"changeUnitRate"},{title:"原价",align:"center",key:"marketPrice"},{title:"实际价格",align:"center",key:"realMarketPrice",render:function(t,r){return t("Input",{props:{value:r.row.realMarketPrice},class:"realMarketPriceColumModal",on:{"on-keyup":function(t){return e.handleInput(r,t,"realMarketPriceColumModal")}}})}},{title:"CAR数量",align:"center",key:"carNum",render:function(t,r){return t("Input",{props:{value:r.row.carNum},class:"carNumColumnModal",on:{"on-keyup":function(t){return e.handleInput(r,t,"carNumColumnModal")}}})}},{title:"EA数量",align:"center",key:"eaNum",render:function(t,r){return t("Input",{props:{value:r.row.eaNum},class:"eaNumColumnModal",on:{"on-keyup":function(t){return e.handleInput(r,t,"eaNumColumnModal")}}})}}]}},methods:{add:function(){this.returnSelectedGoods()},handleCancel:function(){this.$emit("update:visible",!1)},addAndClose:function(){this.returnSelectedGoods(),this.$emit("update:visible",!1)},returnSelectedGoods:function(){var e=[];this.dataSource.forEach(function(t){if(t._checked){var r=(0,c.default)({},t);delete r._checked,e.push(r)}}),this.$emit("on-selected",e)},search:function(){this.query.page=1,this.queryList()},resetQuery:function(){this.query={queryItemName:"",queryItem69:"",queryItem79:"",page:1},this.queryList()},queryList:function(){function e(){return t.apply(this,arguments)}var t=(0,u.default)(o.default.mark(function e(){var t,r,a,n,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.dataSource=[],this.dataSourceSelected=[],t=[],r=[],e.prev=4,e.next=7,this.$ajax.post(this.apiGroup.orderItemssurUrl+"?number="+Math.random(),s.stringify((0,c.default)({},this.query,{itemStatus:5})));case 7:a=e.sent,n=a.data,200==n.code?(i=n.result.pager,i.records instanceof Array&&(this.dataSource=i.records.map(function(e){r.push(e.code79);var t=isNaN(parseFloat(e.marketPrice))?0:parseFloat(e.marketPrice),a="0.00";e.marketPrice&&null!==e.marketPrice&&!isNaN(e.marketPrice)&&(a=Number(e.marketPrice).toFixed(2));var n=e.inventory,o=e.changeUnitRate,i="0/0";return 0!=n&&0!=o&&(i=Math.floor(n/o)+"/"+n%o),(0,c.default)({},e,{validNum:i,marketPrice:a,realMarketPrice:t.toFixed(2),carNum:0,eaNum:0,promotionType:"",promotionId:"",promotionCode:"",promotionTitle:""})})),i.totalCount&&(this.total=parseInt(i.totalCount))):t.push("商品数据获取失败"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),console.error(e.t0),t.push("商品数据获取失败");case 16:t.length>0&&this.$Message.error(t.join(","));case 17:case"end":return e.stop()}},e,this,[[4,12]])}));return e}(),handleSelectionChange:function(e){this.dataSourceSelected=e;for(var t=0;t<this.dataSource.length;t++)if(this.dataSource[t]._checked=!1,e.length>0)for(var r=0;r<e.length;r++)if(e[r].code79==this.dataSource[t].code79){this.dataSource[t]._checked=!0;break}},handleInput:function(e,t,r){var a=t.target.value,n=e.column.key;a=a.replace(/[^\d.]/g,""),a=a.replace(/^\./g,""),a=a.replace(/\.{2,}/g,"."),a=a.replace(".","$#$").replace(/\./g,"").replace("$#$","."),a=a.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),"carNum"!=n&&"eaNum"!=n||parseInt(a).toString().length!==a.toString().length&&(a=parseInt(a),isNaN(a)&&(a=0)),e.row[n]=a,this.dataSource[e.index]=(0,c.default)({},this.dataSource[e.index],e.row),setTimeout(function(r){return t.target.value=e.row[n]})}},watch:{visible:function(e,t){1==e?(this.dialogVisible=!0,this.resetQuery()):this.dialogVisible=!1}}}},1500:function(e,t,r){var a=r(1501);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(43)("5799d658",a,!1,{})},1501:function(e,t,r){t=e.exports=r(42)(!1),t.push([e.i,"\n.custom-row[data-v-66e70832] {\n  margin-bottom: 15px;\n}\n",""])},1502:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{width:1200,title:"商品选择"},on:{"on-cancel":e.handleCancel},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}},[r("Row",{staticClass:"custom-row",attrs:{gutter:16}},[r("Col",{attrs:{span:"5"}},[r("div",[e._v("商品名称:")]),e._v(" "),r("div",[r("Input",{model:{value:e.query.queryItemName,callback:function(t){e.$set(e.query,"queryItemName",t)},expression:"query.queryItemName"}})],1)]),e._v(" "),r("Col",{attrs:{span:"5"}},[r("div",[e._v("条形码:")]),e._v(" "),r("div",[r("Input",{model:{value:e.query.queryItem69,callback:function(t){e.$set(e.query,"queryItem69",t)},expression:"query.queryItem69"}})],1)]),e._v(" "),r("Col",{attrs:{span:"5"}},[r("div",[e._v("销售编码:")]),e._v(" "),r("div",[r("Input",{model:{value:e.query.queryItem79,callback:function(t){e.$set(e.query,"queryItem79",t)},expression:"query.queryItem79"}})],1)]),e._v(" "),r("Col",{attrs:{span:"5"}},[r("div",[e._v("商品类型:")]),e._v(" "),r("div",[r("Select",{model:{value:e.query.itemType,callback:function(t){e.$set(e.query,"itemType",t)},expression:"query.itemType"}},[r("Option",{attrs:{value:""}},[e._v("请选择")]),e._v(" "),r("Option",{attrs:{value:"1"}},[e._v("常规装")]),e._v(" "),r("Option",{attrs:{value:"2"}},[e._v("促销装")]),e._v(" "),r("Option",{attrs:{value:"3"}},[e._v("赠品/非单卖品")]),e._v(" "),r("Option",{attrs:{value:"4"}},[e._v("广宣品")])],1)],1)]),e._v(" "),r("Col",{attrs:{span:"4"}},[r("div",[e._v(" ")]),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:function(t){e.search()}}},[e._v("查询")])],1)],1),e._v(" "),r("Row",[r("Table",{attrs:{columns:e.dataColumns,data:e.dataSource},on:{"on-selection-change":e.handleSelectionChange}})],1),e._v(" "),r("Row",[r("Page",{staticStyle:{float:"right","margin-top":"20px"},attrs:{"page-size":5,current:e.query.page,total:e.total},on:{"update:current":function(t){e.$set(e.query,"page",t)},"on-change":e.queryList}})],1),e._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:function(t){e.add()}}},[e._v("添加")]),e._v(" "),r("Button",{on:{click:function(t){e.addAndClose()}}},[e._v("添加并关闭")])],1)],1)},n=[];a._withStripped=!0;var o={render:a,staticRenderFns:n};t.default=o},634:function(e,t,r){"use strict";function a(e){c||r(1500)}Object.defineProperty(t,"__esModule",{value:!0});var n=r(1450),o=r.n(n);for(var i in n)"default"!==i&&function(e){r.d(t,e,function(){return n[e]})}(i);var u=r(1502),l=r.n(u),c=!1,s=r(13),d=a,p=s(o.a,l.a,!1,d,"data-v-66e70832",null);p.options.__file="src/views/my-components/modal-selector/return-goods-select-modal.vue",t.default=p.exports}});