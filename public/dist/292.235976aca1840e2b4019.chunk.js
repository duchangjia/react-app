webpackJsonp([292],{1408:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=(n(898),n(38)),i=(o(a),n(239));o(i);e.default={data:function(){return{modalHandel:this.modalShow,file:null,filePath:"",uploading:!1,modalLoading:!0}},props:{modalShow:{type:Boolean,default:!1},getType:{type:Number,default:0}},mounted:function(){},watch:{modalShow:function(t,e){t&&(this.modalHandel=!0)}},methods:{cancel:function(){this.$emit("update:modalShow",!1)},inputFileChange:function(t){this.file=t.target.files[0],this.filePath=t.target.value},selectFile:function(){this.$refs.inputFile.click()},batchUpload:function(){var t=this,e=this;if(""==this.filePath)return void this.$Modal.error({title:"上传文件为空",content:"请选择上传文件",onOk:function(t){setTimeout(function(){e.modalLoading=!1,e.$nextTick(function(){e.modalLoading=!0})},100)}});var n=new FormData;n.append("beginnInventoryFile",this.file),this.uploading=!0;var o="";2==this.getType?o=this.$util.apiConfig.promotionManage.warAdviser.targetConfig.batchUploadForMonth:1==this.getType&&(o=this.$util.apiConfig.promotionManage.warAdviser.targetConfig.batchUploadForYear),this.$ajax({method:"post",url:o,data:n}).then(function(n){if(t.uploading=!1,200==n.data.code)t.$emit("update:modalShow",!1),t.modalHandel=!1,t.$Modal.success({title:"文件上传成功",content:n.data.message,onOk:function(){t.$emit("getlist")}});else if(100==n.data.code){setTimeout(function(){e.modalLoading=!1,e.$nextTick(function(){e.modalLoading=!0})},100);var o="";for(var a in n.data.result)o+='<p style="color:red;margin-bottom:10px">'+n.data.result[a]+"<p>";t.$Modal.error({width:500,title:"文件上传失败",content:o+"<div>"+n.data.message+"</div>"})}else setTimeout(function(){e.modalLoading=!1,e.$nextTick(function(){e.modalLoading=!0})},100),t.$Modal.error({title:"文件上传失败",content:n.data.message})}).catch(function(n){setTimeout(function(){e.modalLoading=!1,e.$nextTick(function(){e.modalLoading=!0})},100),t.uploading=!1,t.$Modal.error({title:"HTTP请求错误",content:"HTTP请求错误"}),console.log("失败信息：",n)})},downloadFile:function(){2==this.getType?window.location.href=this.$util.baseUrl+this.$util.apiConfig.promotionManage.warAdviser.targetConfig.downloadMonthUrl:1==this.getType&&(window.location.href=this.$util.baseUrl+this.$util.apiConfig.promotionManage.warAdviser.targetConfig.downloadYearUrl)}}}},1453:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Modal",{attrs:{title:"上传导入","mask-closable":!1,loading:t.modalLoading},on:{"on-ok":function(e){t.batchUpload()},"on-cancel":function(e){t.cancel()}},model:{value:t.modalHandel,callback:function(e){t.modalHandel=e},expression:"modalHandel"}},[n("div",[n("p",{staticStyle:{color:"red","text-align":"center"}},[t._v("提示：请使用模板导入数据文件，仅支持.xlsx, .xlsm, .xltm, .xlsb, .xlam格式")]),t._v(" "),n("div",{staticStyle:{"padding-top":"20px"}},[n("input",{ref:"inputFile",staticStyle:{display:"none"},attrs:{name:"beginnInventoryFile",type:"file"},on:{change:t.inputFileChange}}),t._v(" "),n("i-button",{staticStyle:{width:"115px"},attrs:{loading:t.uploading,icon:"plus",type:"info"},on:{click:t.selectFile}},[t._v("选择上传文件")]),t._v(" "),""!=t.filePath?n("span",{staticStyle:{"margin-left":"30px"}},[t._v("上传文件路径："+t._s(t.filePath))]):t._e()],1),t._v(" "),n("div",{staticStyle:{"padding-top":"20px"}},[n("i-button",{staticStyle:{width:"115px"},attrs:{icon:"android-download",type:"success"},on:{click:t.downloadFile}},[t._v("下载"),n("span",{domProps:{innerHTML:t._s(2==t.getType?"月":"年")}}),t._v("度模版")])],1)])])],1)},a=[];o._withStripped=!0;var i={render:o,staticRenderFns:a};e.default=i},618:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1408),a=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,function(){return o[t]})}(i);var l=n(1453),r=n.n(l),d=n(13),s=d(a.a,r.a,!1,null,null,null);s.options.__file="src/views/promotion-manage/war-adviser/target-config/components/download.vue",e.default=s.exports},898:function(t,e,n){"use strict";function o(t,e){if(!e)var e="yyyy-MM-DD hh:mm:ss";var n={"M+":t.getMonth()+1,"D+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var o in n)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?n[o]:("00"+n[o]).substr((""+n[o]).length)));return e}function a(t,e){if(!e)var e="yyyy-MM-dd";(t=Number(t))<1e10&&(t*=1e3);var n=new Date(t),o={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in o)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?o[a]:("00"+o[a]).substr((""+o[a]).length)));return e}Object.defineProperty(e,"__esModule",{value:!0}),e.formatDate=o,e.timestampToDay=a}});