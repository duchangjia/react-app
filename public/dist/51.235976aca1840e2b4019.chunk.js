webpackJsonp([51,278],{1630:function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(909),r=n(i),s=o(152),a=n(s),c=o(239),l=(n(c),o(602)),u=n(l);e.default={name:"group-detail",components:{steps:u.default},data:function(){return{stepsObj:{current:2,data:["定向规则","组合配置","促销预览"]},isDisable:!1,promotionInfoDTO:{beginTime:"",endTime:"",channel:"",type:"",scopeType:"1",title:""},promotionScopeDetailDTOList:[],loading:!1,columnsGoods:[{title:"序号",width:80,align:"center",type:"index"},{title:"物料编码",key:"code80",align:"center"},{title:"商品名称",key:"itemName",align:"center"},{title:"价格CAR",key:"marketPrice",align:"center",render:function(t,e){return t("div",e.row.marketPrice?Number(e.row.marketPrice).toFixed(2):"0.00")}},{title:"价格EA",key:"marketPriceEA",align:"center",render:function(t,e){var o=0,n=void 0;return e.row.changeUnitRate&&null!==e.row.changeUnitRate&&(n=e.row.changeUnitRate),(e.row.marketPrice||null!==e.row.marketPrice)&&(o=e.row.marketPrice),n&&o&&(o=(o/n).toFixed(2)),t("div",Number(o).toFixed(2))}},{title:"优惠价(EA)*",key:"discountPrice",align:"center"},{title:"数量(EA)*",key:"num",align:"center"},{title:"终端执行要求",key:"remarks",align:"center",ellipsis:!0,tooltip:!0,width:120,render:function(t,e){var o="";if(null!==e.row.remarks&&void 0!==e.row.remarks&&""!==e.row.remarks)return o=e.row.remarks.length>5?e.row.remarks.substring(0,5)+"...":e.row.remarks,t("Tooltip",{props:{placement:"top",offset:0,transfer:!0}},[o,t("div",{slot:"content",style:{whiteSpace:"normal",wordBreak:"break-all"}},e.row.remarks)])}}],columnsStore:[{title:"序号",width:80,align:"center",type:"index"},{title:"门店类型",key:"storeType",align:"center"},{title:"自定义组",key:"storeGroupName",align:"center"},{title:"门店编码",key:"storeCode",align:"center"},{title:"门店名称",key:"storeName",align:"center"}],columnsStore2:[{title:"序号",width:80,align:"center",type:"index"},{title:"门店类型",key:"storeType",align:"center"},{title:"自定义组",key:"storeGroupName",align:"center"},{title:"门店编码",key:"scopeCode",align:"center"},{title:"门店名称",key:"scopeName",align:"center"}],exclusionDTOList:[],thisTableData:[],btnShow:!1,scopeType:"",storeProp:[],group:[],salesmanDTOS:[]}},methods:{queryData:function(){var t=this;t.isDisable=!0,this.$util.ajax({method:"get",url:t.$util.apiConfig.promotionManage.warProgramme.groupGoods.getDetailUrlNew+"?id="+t.$route.query.id,data:""}).then(function(e){setTimeout(function(){t.isDisable=!1},500),200==e.data.code?(t.promotionInfoDTO=e.data.result.detail,t.promotionInfoDTO.beginTime=t.timestampToTime(e.data.result.detail.beginTime),t.promotionInfoDTO.endTime=t.timestampToTime(e.data.result.detail.endTime),t.thisTableData=e.data.result.detail.groupItems,t.promotionScopeDetailDTOList=e.data.result.detail.groupScopes,t.exclusionDTOList=e.data.result.detail.exclusionDTOList,t.salesmanDTOS=e.data.result.detail.salesmanDTOS,t.scopeType=t.promotionInfoDTO.scopeType,3==t.promotionInfoDTO.scopeType&&(e.data.result.detail.groupScopes.forEach(function(e){t.storeProp.push(e.scopeName),t.group.push(e.storeGroupName)}),t.group=(0,a.default)(new r.default(t.group)),t.storeProp=(0,a.default)(new r.default(t.storeProp)))):t.$Modal.error({title:"提示",content:e.data.message})}).catch(function(e){t.isDisable=!1,console.log("失败信息：",e)})},goBack:function(t){this.$router.go(-1)},timestampToTime:function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},savePromotion:function(){var t=this,e=JSON.parse(sessionStorage.rule);this.createData={marketPrice:e.promotionInfoDTO.marketPrice,groupName:e.promotionInfoDTO.groupName,beginTime:new Date(e.promotionInfoDTO.beginTime).getTime(),endTime:new Date(e.promotionInfoDTO.endTime).getTime(),groupItems:e.promotionInfoDTO.groupItems,scopeType:e.scopeType,id:e.promotionInfoDTO.id,channel:e.promotionInfoDTO.channel,groupScopes:e.promotionScopeDetailDTOList,displayDiscountPrice:e.promotionInfoDTO.displayDiscountPrice?"1":"0",exclusionDTOList:e.exclusionDTOList?e.exclusionDTOList:[],salesmanDTOS:e.salesmanDTOS?e.salesmanDTOS:[],status:e.promotionInfoDTO.status,createTime:e.promotionInfoDTO.createTime,createUser:e.promotionInfoDTO.createUser,dealerId:e.promotionInfoDTO.dealerId,groupCode:e.promotionInfoDTO.groupCode};var o=t.$util.apiConfig.promotionManage.warProgramme.groupGoods.addListNew;e.promotionInfoDTO.id&&(o=t.$util.apiConfig.promotionManage.warProgramme.groupGoods.updateGoodsGroup),t.isDisable=!0,t.$Spin.show(),this.$util.ajax({method:"post",url:o,data:this.createData}).then(function(e){t.$Spin.hide(),"200"==e.data.code?t.$Modal.success({title:"提示",content:"发布成功",onOk:function(){t.$router.push({path:"new-group-goods-list"})}}):(t.isDisable=!1,t.$Modal.error({title:"提示",content:e.data.message}))}).catch(function(e){t.$Spin.hide(),t.isDisable=!1,console.log(e)})}},mounted:function(){if(this.$route.query.id)this.queryData(),this.btnShow=!0;else{var t=this,e=JSON.parse(sessionStorage.rule);t.promotionInfoDTO=e.promotionInfoDTO,t.scopeType=e.scopeType,t.promotionInfoDTO.beginTime=t.timestampToTime(t.promotionInfoDTO.beginTime),t.promotionInfoDTO.endTime=t.timestampToTime(t.promotionInfoDTO.endTime),t.promotionScopeDetailDTOList=e.promotionScopeDetailDTOList,t.exclusionDTOList=e.exclusionDTOList,t.salesmanDTOS=e.salesmanDTOS,t.thisTableData=e.promotionInfoDTO.groupItems,3==t.scopeType&&(e.promotionScopeDetailDTOList.forEach(function(e){t.storeProp.push(e.scopeName),t.group.push(e.storeGroupName)}),t.group=(0,a.default)(new r.default(t.group)),t.storeProp=(0,a.default)(new r.default(t.storeProp)))}}}},2151:function(t,e,o){var n=o(2152);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o(43)("3984e9ee",n,!1,{})},2152:function(t,e,o){e=t.exports=o(42)(!1),e.push([t.i,"\n.ListName[data-v-1cd148e5]{\n    text-align: right;\n    line-height: 46px;\n    color: #747474;\n    font-size: 12px;\n    margin-right: 16px;\n}\n.content[data-v-1cd148e5]{\n    line-height: 46px;\n    color: #747474;\n}\n.but[data-v-1cd148e5]{\n    text-align: center;\n    padding-bottom: 30px;\n    padding-top: 20px;\n}\n",""])},2153:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("steps",{directives:[{name:"show",rawName:"v-show",value:!t.btnShow,expression:"!btnShow"}],attrs:{stepsObj:t.stepsObj}}),t._v(" "),o("div",{staticStyle:{background:"#fff",padding:"20px"}},[o("div",[o("div",[o("p",{staticStyle:{color:"#747474","font-weight":"bold","font-size":"larger"},attrs:{slot:"title"},slot:"title"},[t._v("\n                  组合政策\n              ")]),t._v(" "),o("div",{staticStyle:{overflow:"hidden"}},[o("Col",{attrs:{span:"6"}},[o("Col",{staticClass:"ListName",attrs:{span:"6"}},[t._v("活动名称:")]),t._v(" "),o("Col",{staticClass:"content",attrs:{span:"16"}},[t._v(" "+t._s(t.promotionInfoDTO.groupName)+" ")])],1),t._v(" "),o("Col",{attrs:{span:"6"}},[o("Col",[o("Col",{staticClass:"ListName",attrs:{span:"6"}},[t._v("开始时间:")]),t._v(" "),o("Col",{staticClass:"content",attrs:{span:"16"}},[t._v(" "+t._s(t.promotionInfoDTO.beginTime)+" ")])],1)],1),t._v(" "),o("Col",{attrs:{span:"6"}},[o("Col",[o("Col",{staticClass:"ListName",attrs:{span:"6"}},[t._v("结束时间:")]),t._v(" "),o("Col",{staticClass:"content",attrs:{span:"16"}},[t._v(" "+t._s(t.promotionInfoDTO.endTime))])],1)],1),t._v(" "),o("Col",{attrs:{span:"6"}},[o("Col",{staticClass:"ListName",attrs:{span:"6"}},[t._v("执行平台:")]),t._v(" "),o("Col",{staticClass:"content",attrs:{span:"16"}},[t._v(" "+t._s(t.promotionInfoDTO.channel)+" ")])],1)],1)]),t._v(" "),o("div",[o("p",{staticStyle:{color:"#747474","font-weight":"bold","font-size":"larger"},attrs:{slot:"title"},slot:"title"},[t._v("\n                  组合商品详情\n              ")]),t._v(" "),o("row",{staticStyle:{padding:"20px"}},[o("Table",{attrs:{columns:t.columnsGoods,data:t.thisTableData,loading:t.loading}})],1)],1),t._v(" "),o("div",[o("p",{staticStyle:{color:"#747474","font-weight":"bold","font-size":"larger"},attrs:{slot:"title"},slot:"title"},[t._v("\n                  活动门店\n              ")]),t._v(" "),o("row",{staticStyle:{}},[o("Col",{staticClass:"content",attrs:{span:"10"}},[o("div",[o("span",[t._v("业务员:")]),t._v(" "),t._l(t.salesmanDTOS,function(e){return o("span",{staticStyle:{padding:"0 12px"}},[t._v(" \n                              "+t._s(e.name)+" ")])})],2)])],1),t._v(" "),o("row",{staticStyle:{}},[1==t.scopeType?o("Col",{staticClass:"content",attrs:{span:"10"}},[t._v("全部门店")]):t._e(),t._v(" "),o("Col",{directives:[{name:"show",rawName:"v-show",value:2==t.scopeType,expression:"scopeType == 2"}],staticClass:"content",attrs:{span:"10"}},[t._v("指定门店")]),t._v(" "),3==t.scopeType?o("Col",{staticClass:"content",attrs:{span:"10"}},[o("div",[o("span",[t._v("门店性质:")]),t._v(" "),t._l(t.storeProp,function(e){return o("span",{staticStyle:{padding:"0 12px"}},[t._v(" \n                              "+t._s(e)+" ")])})],2),t._v(" "),o("div",[o("span",[t._v("标签分类:")]),t._v(" "),t._l(t.group,function(e){return o("span",{staticStyle:{padding:"0 12px"}},[t._v(" \n                              "+t._s(e)+" ")])})],2)]):t._e()],1),t._v(" "),2==t.scopeType?o("row",{staticStyle:{padding:"20px"}},[o("Table",{attrs:{columns:t.columnsStore2,data:t.promotionScopeDetailDTOList,loading:t.loading}})],1):t._e(),t._v(" "),1==t.scopeType||3==t.scopeType?o("div",[o("div",{staticClass:"content",attrs:{span:"10"}},[t._v("排除门店")]),t._v(" "),o("row",{staticStyle:{padding:"20px"}},[o("Table",{attrs:{columns:t.columnsStore,data:t.exclusionDTOList,loading:t.loading}})],1)],1):t._e()],1),t._v(" "),o("row",{staticClass:"but"},[o("Button",{directives:[{name:"show",rawName:"v-show",value:t.btnShow,expression:"btnShow"}],on:{click:function(e){t.goBack()}}},[t._v("返 回")]),t._v(" "),o("Button",{directives:[{name:"show",rawName:"v-show",value:!t.btnShow,expression:"!btnShow"}],staticStyle:{"margin-right":"15px"},attrs:{type:"primary",disabled:t.isDisable},on:{click:function(e){t.savePromotion()}}},[t._v("确 认")]),t._v(" "),o("Button",{directives:[{name:"show",rawName:"v-show",value:!t.btnShow,expression:"!btnShow"}],on:{click:function(e){t.goBack()}}},[t._v("取 消")])],1)],1)])],1)},i=[];n._withStripped=!0;var r={render:n,staticRenderFns:i};e.default=r},602:function(t,e,o){"use strict";function n(t){l||o(946)}Object.defineProperty(e,"__esModule",{value:!0});var i=o(930),r=o.n(i);for(var s in i)"default"!==s&&function(t){o.d(e,t,function(){return i[t]})}(s);var a=o(948),c=o.n(a),l=!1,u=o(13),p=n,d=u(r.a,c.a,!1,p,null,null);d.options.__file="src/views/marketing-centre-components/steps.vue",e.default=d.exports},748:function(t,e,o){"use strict";function n(t){l||o(2151)}Object.defineProperty(e,"__esModule",{value:!0});var i=o(1630),r=o.n(i);for(var s in i)"default"!==s&&function(t){o.d(e,t,function(){return i[t]})}(s);var a=o(2153),c=o.n(a),l=!1,u=o(13),p=n,d=u(r.a,c.a,!1,p,"data-v-1cd148e5",null);d.options.__file="src/views/promotion-manage/war-programme/new-group-goods/new-group-goods-detail.vue",e.default=d.exports},897:function(t,e,o){var n=o(44);t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},909:function(t,e,o){t.exports={default:o(910),__esModule:!0}},910:function(t,e,o){o(151),o(75),o(100),o(911),o(917),o(920),o(922),t.exports=o(11).Set},911:function(t,e,o){"use strict";var n=o(912),i=o(897);t.exports=o(913)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(i(this,"Set"),t=0===t?0:t,t)}},n)},912:function(t,e,o){"use strict";var n=o(32).f,i=o(148),r=o(245),s=o(64),a=o(244),c=o(240),l=o(147),u=o(246),p=o(248),d=o(37),f=o(243).fastKey,m=o(897),v=d?"_s":"size",g=function(t,e){var o,n=f(e);if("F"!==n)return t._i[n];for(o=t._f;o;o=o.n)if(o.k==e)return o};t.exports={getConstructor:function(t,e,o,l){var u=t(function(t,n){a(t,u,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=n&&c(n,o,t[l],t)});return r(u.prototype,{clear:function(){for(var t=m(this,e),o=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete o[n.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var o=m(this,e),n=g(o,t);if(n){var i=n.n,r=n.p;delete o._i[n.i],n.r=!0,r&&(r.n=i),i&&(i.p=r),o._f==n&&(o._f=i),o._l==n&&(o._l=r),o[v]--}return!!n},forEach:function(t){m(this,e);for(var o,n=s(t,arguments.length>1?arguments[1]:void 0,3);o=o?o.n:this._f;)for(n(o.v,o.k,this);o&&o.r;)o=o.p},has:function(t){return!!g(m(this,e),t)}}),d&&n(u.prototype,"size",{get:function(){return m(this,e)[v]}}),u},def:function(t,e,o){var n,i,r=g(t,e);return r?r.v=o:(t._l=r={i:i=f(e,!0),k:e,v:o,p:n=t._l,n:void 0,r:!1},t._f||(t._f=r),n&&(n.n=r),t[v]++,"F"!==i&&(t._i[i]=r)),t},getEntry:g,setStrong:function(t,e,o){l(t,e,function(t,o){this._t=m(t,e),this._k=o,this._l=void 0},function(){for(var t=this,e=t._k,o=t._l;o&&o.r;)o=o.p;return t._t&&(t._l=o=o?o.n:t._t._f)?"keys"==e?u(0,o.k):"values"==e?u(0,o.v):u(0,[o.k,o.v]):(t._t=void 0,u(1))},o?"entries":"values",!o,!0),p(e)}}},913:function(t,e,o){"use strict";var n=o(12),i=o(36),r=o(243),s=o(66),a=o(45),c=o(245),l=o(240),u=o(244),p=o(44),d=o(77),f=o(32).f,m=o(914)(0),v=o(37);t.exports=function(t,e,o,g,_,h){var T=n[t],w=T,y=_?"set":"add",D=w&&w.prototype,S={};return v&&"function"==typeof w&&(h||D.forEach&&!s(function(){(new w).entries().next()}))?(w=e(function(e,o){u(e,w,t,"_c"),e._c=new T,void 0!=o&&l(o,_,e[y],e)}),m("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in D&&(!h||"clear"!=t)&&a(w.prototype,t,function(o,n){if(u(this,w,t),!e&&h&&!p(o))return"get"==t&&void 0;var i=this._c[t](0===o?0:o,n);return e?this:i})}),h||f(w.prototype,"size",{get:function(){return this._c.size}})):(w=g.getConstructor(e,t,_,y),c(w.prototype,o),r.NEED=!0),d(w,t),S[t]=w,i(i.G+i.W+i.F,S),h||g.setStrong(w,t,_),w}},914:function(t,e,o){var n=o(64),i=o(149),r=o(98),s=o(99),a=o(915);t.exports=function(t,e){var o=1==t,c=2==t,l=3==t,u=4==t,p=6==t,d=5==t||p,f=e||a;return function(e,a,m){for(var v,g,_=r(e),h=i(_),T=n(a,m,3),w=s(h.length),y=0,D=o?f(e,w):c?f(e,0):void 0;w>y;y++)if((d||y in h)&&(v=h[y],g=T(v,y,_),t))if(o)D[y]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return y;case 2:D.push(v)}else if(u)return!1;return p?-1:l||u?u:D}}},915:function(t,e,o){var n=o(916);t.exports=function(t,e){return new(n(t))(e)}},916:function(t,e,o){var n=o(44),i=o(247),r=o(14)("species");t.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},917:function(t,e,o){var n=o(36);n(n.P+n.R,"Set",{toJSON:o(918)("Set")})},918:function(t,e,o){var n=o(150),i=o(919);t.exports=function(t){return function(){if(n(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},919:function(t,e,o){var n=o(240);t.exports=function(t,e){var o=[];return n(t,!1,o.push,o,e),o}},920:function(t,e,o){o(921)("Set")},921:function(t,e,o){"use strict";var n=o(36);t.exports=function(t){n(n.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},922:function(t,e,o){o(923)("Set")},923:function(t,e,o){"use strict";var n=o(36),i=o(76),r=o(64),s=o(240);t.exports=function(t){n(n.S,t,{from:function(t){var e,o,n,a,c=arguments[1];return i(this),e=void 0!==c,e&&i(c),void 0==t?new this:(o=[],e?(n=0,a=r(c,arguments[2],2),s(t,!1,function(t){o.push(a(t,n++))})):s(t,!1,o.push,o),new this(o))}})}},930:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"steps",props:{stepsObj:{type:Object}}}},946:function(t,e,o){var n=o(947);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o(43)("62877a53",n,!1,{})},947:function(t,e,o){e=t.exports=o(42)(!1),e.push([t.i,"\n.stepBox {\n  padding: 20px;\n  border-bottom: 1px dashed #E8E8E8;\n  margin-bottom: 10px;\n}\n.bgcolor {\n  background-color: white;\n}\n.ivu-steps-item.ivu-steps-status-wait .ivu-steps-title {\n  color: #AAA;\n}\n",""])},948:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"stepBox bgcolor"},[o("Steps",{attrs:{current:t.stepsObj.current,size:"small"}},t._l(t.stepsObj.data,function(t,e){return o("Step",{key:t,attrs:{title:t}})}))],1)},i=[];n._withStripped=!0;var r={render:n,staticRenderFns:i};e.default=r}});