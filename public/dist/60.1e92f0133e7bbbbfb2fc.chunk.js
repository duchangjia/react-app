webpackJsonp([60],{1095:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkDate=t.initDate=t.initMoney=t.initNumber=t.initCode=void 0;var i=r(103),a=function(e,t){return!!e.test(t)};t.initCode=function(e){return a(/^[A-Z|a-z|_|0-9]*$/,e)},t.initNumber=function(e){return a(/^[1-9]\d*$/,e)},t.initMoney=function(e){return a(/^\d+(\.\d{0,2})?$|^\.\d{1,2}$/,e)},t.initDate=function(e){if(e){var t=new Date(e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+((t.getDate()<10?"0"+t.getDate():t.getDate())+" ")+((t.getHours()<10?"0"+t.getHours():t.getHours())+":")+((t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}},t.checkDate=function(e,t,r){return e[t]?e[r]?!(new Date(e[t]).getTime()>=new Date(e[r]).getTime())||(i.Message.warning("开始时间不能大于或者等于结束时间"),!1):(i.Message.warning("结束时间不能为空"),!1):(i.Message.warning("开始时间不能为空"),!1)}},1636:function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a,n=r(102),o=i(n),s=r(152),c=i(s),l=r(101),u=i(l),p=r(909),d=i(p),v=r(241),f=i(v),g=r(242),m=i(g),h=r(239),y=i(h),_=r(1095);t.default={data:function(){var e=this;return{apiGroup:this.$util.apiConfig.promotionManage.warProgramme.newSalePromotion,activityArray:{startTime:"",endTime:"",title:"",scope:"",Array:[],groupArr:[],storeProp:[],status:"",platform:[],salesmanList:[]},platformGroup:["SFA","o2o"],startTime:"",endTime:"",checkAllGroup:[],checkAll1:!1,checkAllStoreProp:[],checkAll:!1,indeterminateStoreProp:!1,static:{storeProp:["A","B","C","D","E","KA"],groupArr:[]},form:{storeCodeLike:"",storeNameLike:"",storeNature:"",customizeGroupId:""},columns1:[{type:"selection",width:58,align:"center"},{title:"序号",type:"index",align:"center"},{title:"门店编号",align:"center",key:"scopeCode"},{title:"门店名称",align:"center",key:"scopeName"},{title:"门店类型",align:"center",key:"storeNature"},{title:"自定义组",align:"center",key:"groupName"}],specialList:[{title:"序号",width:62,align:"center",type:"index"},{title:"物料编码",key:"code80",align:"center"},{title:"商品名称",key:"itemName",align:"center"},{title:"品牌",key:"brandName",align:"center"},{title:"品类",key:"cname",align:"center"},{title:"价格EA",key:"price",align:"center"},{title:"优惠价EA",key:"promotionCode",align:"center",render:function(t,r){var i=e,a=r.index,n=[],o=i.specialDataPage[a].sillLevel.EA;for(var s in o){var c=o[s];n.push(function(e,r){return t("div",{style:{padding:"4px 7px",border:"1px solid #dddee1",margin:"2.5px",borderRadius:"4px"}},r)}(s,c))}return t("div",n)}},{title:"数量",key:"dealerId",align:"center",render:function(t,r){var i=e,a=r.index,n=[],o=i.specialDataPage[a].sillLevel.NUMBER;for(var s in o){var c=o[s];n.push(function(e,r){return t("div",{style:{padding:"4px 7px",border:"1px solid #dddee1",margin:"2.5px",borderRadius:"4px"}},r)}(s,c))}return t("div",n)}}],columns2:[{type:"selection",width:58,align:"center"},{title:"序号",type:"index",align:"center"},{title:"门店编号",align:"center",key:"scopeCode"},{title:"门店名称",align:"center",key:"scopeName"},{title:"门店类型",align:"center",key:"storeNature"},{title:"自定义组",align:"center",key:"groupName"}],tableData:[],except:[],selected:[],scope:"1",selection:[],exceptSelection:[],mode:null,id:"",queryArr:{page:1,rows:5,storeCodeLike:"",storeNameLike:"",storeNature:"",customizeGroupId:""},totalCount:0,startTimeOptions:{disabledDate:function(e){return e&&e.valueOf()<Date.now()-864e5}},endTimeOptions:{disabledDate:function(t){return t&&t.valueOf()-1<new Date(e.activityArray.startTime)}},specialDataPage:[]}},created:function(){function e(){return t.apply(this,arguments)}var t=(0,m.default)(f.default.mark(function e(){var t,r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGroup();case 2:t=e.sent,r=this.$route.query.id;try{200==t.data.code&&(this.static.groupArr=t.data.result,this.getDetails(r))}catch(e){console.error(e),this.$Message.error("网络异常")}case 5:case"end":return e.stop()}},e,this)}));return e}(),mounted:function(){},methods:(a={getGoodsList:function(e){var t=[];return e.length?(e.forEach(function(e){var r={};r.barCode=e.barCode,r.brandId=e.brandId,r.brandName=e.brandName,r.changeUnitRate=e.changeUnitRate,r.cid=e.cid,r.cname=e.cname,r.code79=e.code79,r.dealerId=e.dealerId,r.guidePrice=e.guidePrice,r.itemId=e.itemId,r.itemName=e.itemName,r.marketPrice=e.price,r.planNum=e.planNum,r.price=e.price,r.type=e.type,r.unit=e.unit,r.sillLevel={},r.sillLevel.EA={},r.sillLevel.NUMBER={};for(var i=0;i<e.promotionLevelList.length;i++){var a=e.promotionLevelList[i];r.sillLevel.EA["val"+i]=a.levelMoney,r.sillLevel.NUMBER["val"+i]=a.levelMoney}t.push(r)}),console.log(t),t):t},handleStartTimeChange:function(e){var t=new Date,r=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",i=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",a=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();new Date(e)<t?this.activityArray.startTime=e.split(" ")[0]+" "+r+i+a:this.activityArray.startTime=e,this.activityArray.startTime>this.activityArray.endTime&&(this.activityArray.endTime="")},handleEndTimeChange:function(e){this.activityArray.endTime=e},getGroup:function(){function e(){return t.apply(this,arguments)}var t=(0,m.default)(f.default.mark(function e(){var t;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$util.ajax({method:"post",url:this.$util.apiConfig.traderManage.infoManage.storeManage.getGroup});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)}));return e}(),getDetails:function(){function e(e){return t.apply(this,arguments)}var t=(0,m.default)(f.default.mark(function e(t){var r,i;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return sessionStorage.removeItem("activityArray"),sessionStorage.removeItem("getLevelItem"),sessionStorage.removeItem("getSelectItem"),r={method:"POST",url:this.apiGroup.newGetDetailUrl,data:y.default.stringify({id:t})},e.prev=4,e.next=7,this.$util.ajax(r);case 7:i=e.sent,200==i.data.code?(this.$Message.info(i.data.message),this.reductionData(i)):this.$Message.error(i.data.message),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),this.$Message.error("网络异常"),console.error(e.t0);case 15:case"end":return e.stop()}},e,this,[[4,11]])}));return e}(),reductionData:function(e){var t=e.data.result.detail.promotionInfoNewDTO,r=e.data.result.detail.promotionGoodsNewList,i=e.data.result.detail.promotionScopeDetailNewDTOList,a=e.data.result.detail.promotionStoreScopeExclusionDTOList,n=e.data.result.detail.promotionSalemanScopeDTOList;this.activityArray.title=t.title,this.activityArray.status=t.status,this.activityArray.scope=t.scope.toString(),this.activityArray.platform=t.channel.split(","),this.activityArray.salesmanList=n;var o=this.getGoodsList(r);if(this.specialDataPage=o,this.scope=this.activityArray.scope,3==this.scope&&this.getGroupArr(i),1==this.scope||3==this.scope?this.except=a:this.selected=i,this.except.length){var s=[];this.except.forEach(function(e){var t={};t.groupName=e.storeGroupName,t.scopeCode=e.storeCode,t.scopeId=e.storeId,t.scopeName=e.storeName,t.scopeType=e.storeId,t.storeGroupId=e.storeGroupId,t.storeGroupName=e.storeGroupName,t.storeId=e.storeId,t.storeNature=e.storeType,t.storeType=e.storeType,s.push(t)}),this.except=s}if(this.selected.length){var c=[];this.selected.forEach(function(e){var t={};t.groupName=e.storeGroupName,t.scopeCode=e.scopeCode,t.scopeId=e.storeId,t.scopeName=e.scopeCode,t.scopeType=e.storeId,t.storeGroupId=e.storeGroupId,t.storeGroupName=e.storeGroupName,t.storeId=e.storeId,t.storeNature=e.storeType,t.storeType=e.storeType,c.push(t)}),this.selected=c}this.activityArray.startTime=(0,_.initDate)(t.beginDate),this.activityArray.endTime=(0,_.initDate)(t.endDate)},getGroupArr:function(e){var t=this,r=new d.default,i=new d.default,a=[];e.forEach(function(e){r.add(e.scopeName),i.add(Number(e.storeGroupId));var n=t.static.groupArr.find(function(t){if(t.id==e.storeGroupId&&e.storeGroupId)return t});a.push(n)}),this.checkAllStoreProp=(0,u.default)([],(0,c.default)(r)),this.checkAllGroup=(0,u.default)([],(0,c.default)(i));var n=[];this.checkAllGroup.forEach(function(e){t.static.groupArr.forEach(function(t){t.id==e&&n.push(t)})}),this.static.groupArr=n}},(0,o.default)(a,"getGoodsList",function(e){var t=[];return e.length?(e.forEach(function(e){var r={};r.barCode=e.barCode,r.brandId=e.brandId,r.brandName=e.brandName,r.changeUnitRate=e.changeUnitRate,r.cid=e.cid,r.cname=e.cname,r.code79=e.code79,r.dealerId=e.dealerId,r.guidePrice=e.guidePrice,r.itemId=e.itemId,r.itemName=e.itemName,r.marketPrice=e.price,r.planNum=e.planNum,r.price=e.price,r.type=e.type,r.unit=e.unit,r.sillLevel={},r.sillLevel.EA={},r.sillLevel.NUMBER={};for(var i=0;i<e.promotionLevelList.length;i++){var a=e.promotionLevelList[i];r.sillLevel.EA["val"+i]=a.levelMoney,r.sillLevel.NUMBER["val"+i]=a.levelNum}t.push(r)}),console.log(t),t):t}),(0,o.default)(a,"back",function(){this.jump("new-salePromotion-list","")}),(0,o.default)(a,"jump",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$route.query;this.$router.push({name:e,query:t})}),a)}},2171:function(e,t,r){var i=r(2172);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);r(43)("09679398",i,!1,{})},2172:function(e,t,r){t=e.exports=r(42)(!1),t.push([e.i,"\n.rule-page-head[data-v-3cf50e14] {\n  margin-bottom: 12px;\n  font-size: 14px;\n  font-weight: bold;\n}\n.rule-page-label[data-v-3cf50e14] {\n  text-align: right;\n  line-height: 32px;\n  color: #747474;\n  font-size: 12px;\n  margin-right: 16px;\n}\n.rule-page-label__required[data-v-3cf50e14] {\n  color: red;\n}\n.rule-page .ivu-form-item[data-v-3cf50e14] {\n  width: 20%;\n  float: left;\n}\n.rule-page .ivu-row .ivu-form-item[data-v-3cf50e14] {\n  width: 100%;\n  margin-bottom: 10px;\n}\n.rule-page .but[data-v-3cf50e14] {\n  text-align: center;\n  padding-bottom: 30px;\n  padding-top: 20px;\n}\n.rule-page .mr--20[data-v-3cf50e14] {\n  margin-right: 20px;\n}\n",""])},2173:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"rule-page bg--white pd--20"},[r("p",{staticClass:"rule-page-head"},[e._v("特价政策")]),e._v(" "),r("Row",{staticClass:"mb--12"},[r("Col",{staticClass:"rule-page-label",attrs:{span:2}},[e._v("\n      活动名称"),r("span",{staticClass:"rule-page-label__required"},[e._v("*")])]),e._v(" "),r("Col",{attrs:{span:4}},[r("Input",{attrs:{readonly:""},model:{value:e.activityArray.title,callback:function(t){e.$set(e.activityArray,"title",t)},expression:"activityArray.title"}})],1)],1),e._v(" "),r("Row",{staticClass:"mb--12"},[r("Col",{staticClass:"rule-page-label",attrs:{span:2}},[e._v("\n      开始时间"),r("span",{staticClass:"rule-page-label__required"},[e._v("*")])]),e._v(" "),r("Col",{attrs:{span:4}},[r("DatePicker",{attrs:{type:"datetime",readonly:"",value:e.activityArray.startTime,options:e.startTimeOptions},on:{"on-change":e.handleStartTimeChange}})],1),e._v(" "),r("Col",{staticClass:"rule-page-label",attrs:{span:2}},[e._v("\n      结束时间"),r("span",{staticClass:"rule-page-label__required"},[e._v("*")])]),e._v(" "),r("Col",{attrs:{span:4}},[r("DatePicker",{attrs:{type:"datetime",readonly:"",value:e.activityArray.endTime,options:e.endTimeOptions},on:{"on-change":e.handleEndTimeChange}})],1)],1),e._v(" "),r("p",{staticClass:"rule-page-head"},[e._v("活动范围")]),e._v(" "),r("Row",{staticClass:"mb--12"},[1==e.scope?r("p",{staticStyle:{"margin-left":"17px"}},[e._v("全部门店")]):e._e(),e._v(" "),2==e.scope?r("p",{staticStyle:{"margin-left":"17px"}},[e._v("指定门店")]):e._e(),e._v(" "),3==e.scope?r("p",{staticStyle:{"margin-left":"17px"}},[e._v("指定门店类型")]):e._e()]),e._v(" "),3==e.scope?r("div",[r("Form",{staticClass:"clearfix",attrs:{model:e.form,"label-width":80}},[r("Row",[r("FormItem",{attrs:{label:"门店类型:"}},[r("span",[e._v(e._s(e.checkAllStoreProp.join(" ")))])])],1),e._v(" "),r("Row",[r("FormItem",{attrs:{label:"自定义组:"}},e._l(e.static.groupArr,function(t,i){return r("span",{key:i},[e._v(e._s(t.groupName+" "))])}))],1)],1)],1):e._e(),e._v(" "),r("p",{staticClass:"rule-page-head"},[e._v("平台")]),e._v(" "),r("p",{staticStyle:{margin:"0 0 15px 17px"}},[e._v(e._s(e.activityArray.platform.join(" ")))]),e._v(" "),r("p",{staticClass:"rule-page-head"},[e._v("业务员")]),e._v(" "),r("p",{staticStyle:{margin:"0 0 15px 17px"}},e._l(e.activityArray.salesmanList,function(t){return r("span",{key:t.id,domProps:{textContent:e._s(t.salesmanName+" ")}})})),e._v(" "),r("p",{staticClass:"rule-page-head"},[e._v(e._s((e.scope,"商品列表")))]),e._v(" "),r("Table",{ref:"queryTable",staticClass:"mb--12",attrs:{data:e.specialDataPage,columns:e.specialList}}),e._v(" "),2==e.scope?r("div",[r("p",{staticClass:"rule-page-head"},[e._v("已选门店")]),e._v(" "),r("div",{staticClass:"mb--12"},[r("Button",{attrs:{disabled:!0}},[e._v("删 除")])],1),e._v(" "),r("Table",{ref:"selectedTable",staticClass:"mb--12",attrs:{data:e.selected,columns:e.columns2}})],1):e._e(),e._v(" "),1==e.scope||3==e.scope?r("div",[r("p",{staticClass:"rule-page-head"},[e._v("排除门店")]),e._v(" "),r("div",{staticClass:"mb--12"}),e._v(" "),r("Table",{attrs:{data:e.except,columns:e.columns2}})],1):e._e(),e._v(" "),r("Row",{staticClass:"but"},[r("Button",{on:{click:e.back}},[e._v("返 回")])],1)],1)},a=[];i._withStripped=!0;var n={render:i,staticRenderFns:a};t.default=n},753:function(e,t,r){"use strict";function i(e){l||r(2171)}Object.defineProperty(t,"__esModule",{value:!0});var a=r(1636),n=r.n(a);for(var o in a)"default"!==o&&function(e){r.d(t,e,function(){return a[e]})}(o);var s=r(2173),c=r.n(s),l=!1,u=r(13),p=i,d=u(n.a,c.a,!1,p,"data-v-3cf50e14",null);d.options.__file="src/views/promotion-manage/war-programme/new-sale-promotion/new-salePromotion-detail.vue",t.default=d.exports},897:function(e,t,r){var i=r(44);e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},909:function(e,t,r){e.exports={default:r(910),__esModule:!0}},910:function(e,t,r){r(151),r(75),r(100),r(911),r(917),r(920),r(922),e.exports=r(11).Set},911:function(e,t,r){"use strict";var i=r(912),a=r(897);e.exports=r(913)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return i.def(a(this,"Set"),e=0===e?0:e,e)}},i)},912:function(e,t,r){"use strict";var i=r(32).f,a=r(148),n=r(245),o=r(64),s=r(244),c=r(240),l=r(147),u=r(246),p=r(248),d=r(37),v=r(243).fastKey,f=r(897),g=d?"_s":"size",m=function(e,t){var r,i=v(t);if("F"!==i)return e._i[i];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,l){var u=e(function(e,i){s(e,u,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[g]=0,void 0!=i&&c(i,r,e[l],e)});return n(u.prototype,{clear:function(){for(var e=f(this,t),r=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete r[i.i];e._f=e._l=void 0,e[g]=0},delete:function(e){var r=f(this,t),i=m(r,e);if(i){var a=i.n,n=i.p;delete r._i[i.i],i.r=!0,n&&(n.n=a),a&&(a.p=n),r._f==i&&(r._f=a),r._l==i&&(r._l=n),r[g]--}return!!i},forEach:function(e){f(this,t);for(var r,i=o(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(i(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!m(f(this,t),e)}}),d&&i(u.prototype,"size",{get:function(){return f(this,t)[g]}}),u},def:function(e,t,r){var i,a,n=m(e,t);return n?n.v=r:(e._l=n={i:a=v(t,!0),k:t,v:r,p:i=e._l,n:void 0,r:!1},e._f||(e._f=n),i&&(i.n=n),e[g]++,"F"!==a&&(e._i[a]=n)),e},getEntry:m,setStrong:function(e,t,r){l(e,t,function(e,r){this._t=f(e,t),this._k=r,this._l=void 0},function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?"keys"==t?u(0,r.k):"values"==t?u(0,r.v):u(0,[r.k,r.v]):(e._t=void 0,u(1))},r?"entries":"values",!r,!0),p(t)}}},913:function(e,t,r){"use strict";var i=r(12),a=r(36),n=r(243),o=r(66),s=r(45),c=r(245),l=r(240),u=r(244),p=r(44),d=r(77),v=r(32).f,f=r(914)(0),g=r(37);e.exports=function(e,t,r,m,h,y){var _=i[e],x=_,b=h?"set":"add",w=x&&x.prototype,A={};return g&&"function"==typeof x&&(y||w.forEach&&!o(function(){(new x).entries().next()}))?(x=t(function(t,r){u(t,x,e,"_c"),t._c=new _,void 0!=r&&l(r,h,t[b],t)}),f("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in w&&(!y||"clear"!=e)&&s(x.prototype,e,function(r,i){if(u(this,x,e),!t&&y&&!p(r))return"get"==e&&void 0;var a=this._c[e](0===r?0:r,i);return t?this:a})}),y||v(x.prototype,"size",{get:function(){return this._c.size}})):(x=m.getConstructor(t,e,h,b),c(x.prototype,r),n.NEED=!0),d(x,e),A[e]=x,a(a.G+a.W+a.F,A),y||m.setStrong(x,e,h),x}},914:function(e,t,r){var i=r(64),a=r(149),n=r(98),o=r(99),s=r(915);e.exports=function(e,t){var r=1==e,c=2==e,l=3==e,u=4==e,p=6==e,d=5==e||p,v=t||s;return function(t,s,f){for(var g,m,h=n(t),y=a(h),_=i(s,f,3),x=o(y.length),b=0,w=r?v(t,x):c?v(t,0):void 0;x>b;b++)if((d||b in y)&&(g=y[b],m=_(g,b,h),e))if(r)w[b]=m;else if(m)switch(e){case 3:return!0;case 5:return g;case 6:return b;case 2:w.push(g)}else if(u)return!1;return p?-1:l||u?u:w}}},915:function(e,t,r){var i=r(916);e.exports=function(e,t){return new(i(e))(t)}},916:function(e,t,r){var i=r(44),a=r(247),n=r(14)("species");e.exports=function(e){var t;return a(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!a(t.prototype)||(t=void 0),i(t)&&null===(t=t[n])&&(t=void 0)),void 0===t?Array:t}},917:function(e,t,r){var i=r(36);i(i.P+i.R,"Set",{toJSON:r(918)("Set")})},918:function(e,t,r){var i=r(150),a=r(919);e.exports=function(e){return function(){if(i(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},919:function(e,t,r){var i=r(240);e.exports=function(e,t){var r=[];return i(e,!1,r.push,r,t),r}},920:function(e,t,r){r(921)("Set")},921:function(e,t,r){"use strict";var i=r(36);e.exports=function(e){i(i.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},922:function(e,t,r){r(923)("Set")},923:function(e,t,r){"use strict";var i=r(36),a=r(76),n=r(64),o=r(240);e.exports=function(e){i(i.S,e,{from:function(e){var t,r,i,s,c=arguments[1];return a(this),t=void 0!==c,t&&a(c),void 0==e?new this:(r=[],t?(i=0,s=n(c,arguments[2],2),o(e,!1,function(e){r.push(s(e,i++))})):o(e,!1,r.push,r),new this(r))}})}}});