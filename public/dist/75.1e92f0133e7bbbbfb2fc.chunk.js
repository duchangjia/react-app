webpackJsonp([75,240,278],{1409:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"sillLevelTable",props:{refs:String,columns:Array,data:Array,disabled:{type:Boolean,default:!1},silllevelType:{type:Boolean,default:!1}},data:function(){return{checkAll:!1}},methods:{handleInput:function(e){/^[1-9]\d*$/.test(e.target.value)||(e.target.value="")},handleSelectChange:function(e){this.checkAll&&(this.checkAll=!this.checkAll),this.data.filter(function(e){return 1==e.myCheck}).length==this.data.length&&(this.checkAll=!0),this.$emit("on-checked",e)},handleCheckAll:function(){var e=this;this.data.forEach(function(t){t.myCheck=e.checkAll}),this.$emit("on-checkedAll",this.checkAll)},getSelection:function(){var e=[];for(var t in this.data)1==this.data[t].myCheck&&e.push(parseInt(t));return e},isDisabled:function(e){return!!this.disabled||(e?!this.silllevelType:this.silllevelType)}},watch:{data:function(e,t){}}}},1454:function(e,t,n){var l=n(1455);"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);n(43)("b4a013ce",l,!1,{})},1455:function(e,t,n){t=e.exports=n(42)(!1),t.push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},1456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ivu-table-wrapper"},[n("div",{staticClass:"ivu-table ivu-table-border"},[n("table",{ref:"refs",staticClass:"ivu-table-body sill-level-table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[n("tr",[e._l(e.columns,function(t){return[n("th",{staticClass:"ivu-table-column-center"},[n("div",{staticClass:"ivu-table-cell"},["selection"==t.type?n("Checkbox",{on:{"on-change":e.handleCheckAll},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}}):e._e(),e._v("\n              "+e._s(t.title?t.title:"#")+"\n            ")],1)])]})],2),e._v(" "),e._l(e.data,function(t,l){return[n("tr",[e._l(e.columns,function(i,a){return[0==a?n("td",{attrs:{rowspan:t.promotionLevelList.length}},[n("div",{staticClass:"ivu-table-cell"},["selection"==i.type?n("Checkbox",{on:{"on-change":function(t){e.handleSelectChange(l)}},model:{value:t.myCheck,callback:function(n){e.$set(t,"myCheck",n)},expression:"item.myCheck"}}):e._e(),e._v("\n                "+e._s(l+1)+"\n              ")],1)]):n("td",["input"==i.type?n("div",{staticClass:"ivu-table-cell"},["levelMoney"==i.key?n("Input",{attrs:{disabled:e.isDisabled(),size:"small"},model:{value:t.promotionLevelList[0][i.key],callback:function(n){e.$set(t.promotionLevelList[0],i.key,n)},expression:"item.promotionLevelList[0][cell.key]"}}):"levelNum"==i.key?n("Input",{attrs:{disabled:e.isDisabled(1),size:"small"},on:{"on-keyup":e.handleInput},model:{value:t.promotionLevelList[0][i.key],callback:function(n){e.$set(t.promotionLevelList[0],i.key,n)},expression:"item.promotionLevelList[0][cell.key]"}}):e._e()],1):n("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.promotionLevelList[0][i.key]))])])]})],2),e._v(" "),e._l(t.promotionLevelList.length-1,function(l){return n("tr",[e._l(e.columns,function(i,a){return[0!==a?n("td",["input"==i.type?n("div",{staticClass:"ivu-table-cell"},["levelMoney"==i.key?n("Input",{attrs:{disabled:e.isDisabled(),size:"small"},model:{value:t.promotionLevelList[l][i.key],callback:function(n){e.$set(t.promotionLevelList[l],i.key,n)},expression:"item.promotionLevelList[son][cell.key]"}}):"levelNum"==i.key?n("Input",{attrs:{disabled:e.isDisabled(1),size:"small"},on:{"on-keyup":e.handleInput},model:{value:t.promotionLevelList[l][i.key],callback:function(n){e.$set(t.promotionLevelList[l],i.key,n)},expression:"item.promotionLevelList[son][cell.key]"}}):e._e()],1):n("div",{staticClass:"ivu-table-cell"},[e._v("\n                "+e._s(t.promotionLevelList[l][i.key])+"\n              ")])]):e._e()]})],2)})]})],2)])])},i=[];l._withStripped=!0;var a={render:l,staticRenderFns:i};t.default=a},1629:function(e,t,n){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(65),a=l(i),s=n(619),o=l(s),r=n(602),c=l(r);t.default={components:{sillLevelTable:o.default,steps:c.default},data:function(){return{stepsObj:{current:3,data:["定向规则","主品配置","赠品配置","坎级配置","促销预览"]},silllevelType:!0,tableData:[],tableData1:[],columns1:[{type:"selection",title:"坎级",align:"center"},{title:"商品条码",align:"center",key:"code"},{title:"商品名称",align:"center",key:"itemName"},{title:"金额",align:"center",type:"input",key:"levelMoney"},{title:"数量",align:"center",key:"levelNum",type:"input"}],columns2:[{type:"selection",title:"坎级",align:"center"},{title:"商品编码",align:"center",key:"code"},{title:"商品名称",align:"center",key:"itemName"},{title:"数量",align:"center",key:"levelNum",type:"input"}],main:null,second:null,disabled:!1,disabled1:!1}},mounted:function(){this.getDataFromSession(),this.tableData.length<1&&this.initSillLevel(1),this.mode=this.$route.query.mode},methods:{switchChange:function(){var e=this;this.tableData.forEach(function(t){t.promotionLevelList.forEach(function(t){e.silllevelType?t.levelMoney="":t.levelNum=""})})},getDataFromSession:function(e){var t=window.sessionStorage.copyDetail;t&&(t=JSON.parse(t),"modify"==this.mode&&4==t.promotionInfoNewDTO.status&&(this.disabled1=!0)),window.sessionStorage.mainProduct&&(this.main=JSON.parse(window.sessionStorage.mainProduct),this.second=JSON.parse(window.sessionStorage.secProduct),this.main[0].promotionLevelList&&this.main[0].promotionLevelList.length>0&&(this.silllevelType=1==this.main[0].promotionLevelList[0].levelType),this.tableData=this.formatLevel(this.main),this.tableData1=this.formatLevel(this.second))},formatLevel:function(e){var t=[];if(e.length>0&&e[0].promotionLevelList){for(var n=0,l=e[0].promotionLevelList.length;n<l;n++)!function(n,l){var i=[];e.forEach(function(e){i.push({code:e.barCode,itemName:e.itemName,levelMoney:e.promotionLevelList[n].levelMoney,levelNum:e.promotionLevelList[n].levelNum})}),t.push({promotionLevelList:i})}(n);console.log(e)}else if(e.length>0){var i=[];e.forEach(function(e){i.push({code:e.barCode,itemName:e.itemName,levelMoney:e.levelMoney,levelNum:e.mustNum})}),t.push({promotionLevelList:i})}return t},handleCheckedAll:function(e){this.tableData1.forEach(function(t){t.myCheck=e})},handleCheckedAll1:function(e){this.tableData.forEach(function(t){t.myCheck=e})},handleChecked1:function(e){this.tableData.length>0&&(this.tableData[e].myCheck=!this.tableData[e].myCheck)},handleChecked:function(e){this.tableData1.length>0&&(this.tableData1[e].myCheck=!this.tableData1[e].myCheck)},initSillLevel:function(e){var t=[];this.main.forEach(function(n){t.push({code:n.barCode,itemName:n.itemName,levelMoney:e?"":n.levelMoney,levelNum:e?"":n.mustNum})}),this.tableData.push({myCheck:!1,promotionLevelList:t});var n=[];this.second.forEach(function(t){n.push({code:t.barCode,itemName:t.itemName,levelMoney:e?"":t.levelMoney,levelNum:e?"":t.mustNum})}),this.tableData1.push({myCheck:!1,promotionLevelList:n})},handleDelete:function(){var e=this.getSelection();if(e.length<1)return void this.$Message.error("请选择一条数据");this.tableData=this.tableData.filter(function(t,n){return!e.includes(n)}),this.tableData1=this.tableData1.filter(function(t,n){return!e.includes(n)})},getSelection:function(){return this.$refs.mainSillLevelTable.getSelection()},add:function(){this.initSillLevel(1)},done:function(){var e=this;if(this.tableData.length<1)return void this.$Message.error("请填写坎级");var t=function(t,n,l){for(var i in t)!function(i){t[i].promotionLevelList=[],n.forEach(function(n,a){t[i].promotionLevelList.push({itemName:n.promotionLevelList[i].itemName,levelMoney:n.promotionLevelList[i].levelMoney,levelNum:n.promotionLevelList[i].levelNum,type:l,modulus:a+1,levelType:e.silllevelType?1:2})}),2==l&&(t[i].type=2)}(i)};t(this.main,this.tableData,1),t(this.second,this.tableData1,2),window.sessionStorage.mainProduct=(0,a.default)(this.main),window.sessionStorage.secProduct=(0,a.default)(this.second);var n=this.$route.query;n.isLevel=1,n.silllevelType=this.silllevelType?1:2,this.$router.push({name:"new-buyPromotio-detail",query:n})},back:function(){history.go(-1)}},beforeRouteLeave:function(e,t,n){"new-buyPromotion-secProduct"!=e.name&&"new-buyPromotio-detail"!=e.name&&(window.sessionStorage.removeItem("copyDetail"),window.sessionStorage.removeItem("rule"),window.sessionStorage.removeItem("mainProduct"),window.sessionStorage.removeItem("secProduct")),n()},created:function(){}}},2148:function(e,t,n){var l=n(2149);"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);n(43)("01f5db53",l,!1,{})},2149:function(e,t,n){t=e.exports=n(42)(!1),t.push([e.i,"\n.sillLevel-page-head[data-v-11fbf64a] {\n  margin-bottom: 12px;\n  font-size: 14px;\n  font-weight: bold;\n}\n.sillLevel-page .but[data-v-11fbf64a] {\n  text-align: center;\n  padding-bottom: 30px;\n  padding-top: 20px;\n}\n.sillLevel-page .amount-switch[data-v-11fbf64a] {\n  font-size: 12px;\n  margin-left: 300px;\n}\n.sillLevel-page .sill-level-table .w30[data-v-11fbf64a] {\n  width: 30%;\n}\n.sillLevel-page .sill-level-table .w10[data-v-11fbf64a] {\n  width: 10%;\n}\n",""])},2150:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("steps",{attrs:{stepsObj:e.stepsObj}}),e._v(" "),n("div",{staticClass:"sillLevel-page bg--white pd--20"},[n("Row",{staticClass:"mb--12"},[n("Button",{attrs:{disabled:e.disabled1},on:{click:e.add}},[e._v("添 加")]),e._v(" "),n("Button",{attrs:{disabled:e.disabled1},on:{click:e.handleDelete}},[e._v("删 除")])],1),e._v(" "),n("Row",{staticClass:"mb--12"},[n("p",{staticClass:"mb--12"},[n("span",{staticClass:"sillLevel-page-head"},[e._v("主品坎级")]),e._v(" "),n("span",{staticClass:"amount-switch"},[n("span",[e._v("单位")]),e._v(" "),n("i-switch",{attrs:{size:"large",disabled:e.disabled1},on:{"on-change":e.switchChange},model:{value:e.silllevelType,callback:function(t){e.silllevelType=t},expression:"silllevelType"}},[n("span",{attrs:{slot:"open"},slot:"open"},[e._v("数量")]),e._v(" "),n("span",{attrs:{slot:"close"},slot:"close"},[e._v("金额")])])],1)]),e._v(" "),n("sill-level-table",{ref:"mainSillLevelTable",attrs:{columns:e.columns1,data:e.tableData,silllevelType:e.silllevelType,disabled:e.disabled1},on:{"on-checked":e.handleChecked,"on-checkedAll":e.handleCheckedAll}})],1),e._v(" "),n("Row",[n("p",{staticClass:"mb--12 sillLevel-page-head"},[e._v("赠品坎级")]),e._v(" "),n("sill-level-table",{attrs:{silllevelType:!0,columns:e.columns2,disabled:e.disabled1,data:e.tableData1},on:{"on-checked":e.handleChecked1,"on-checkedAll":e.handleCheckedAll1}})],1),e._v(" "),n("Row",{staticClass:"but"},[n("Button",{attrs:{size:"large"},on:{click:e.back}},[e._v("返 回")]),e._v(" "),n("Button",{staticClass:"mr--20",attrs:{type:"primary",size:"large",disabled:e.disabled},on:{click:e.done}},[e._v("完 成")])],1)],1)],1)},i=[];l._withStripped=!0;var a={render:l,staticRenderFns:i};t.default=a},602:function(e,t,n){"use strict";function l(e){c||n(946)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(930),a=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,function(){return i[e]})}(s);var o=n(948),r=n.n(o),c=!1,u=n(13),d=l,v=u(a.a,r.a,!1,d,null,null);v.options.__file="src/views/marketing-centre-components/steps.vue",t.default=v.exports},619:function(e,t,n){"use strict";function l(e){c||n(1454)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1409),a=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,function(){return i[e]})}(s);var o=n(1456),r=n.n(o),c=!1,u=n(13),d=l,v=u(a.a,r.a,!1,d,null,null);v.options.__file="src/views/promotion-manage/war-programme/new-buy-promotion/components/sill-level-table.vue",t.default=v.exports},747:function(e,t,n){"use strict";function l(e){c||n(2148)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1629),a=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,function(){return i[e]})}(s);var o=n(2150),r=n.n(o),c=!1,u=n(13),d=l,v=u(a.a,r.a,!1,d,"data-v-11fbf64a",null);v.options.__file="src/views/promotion-manage/war-programme/new-buy-promotion/sill-level.vue",t.default=v.exports},930:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"steps",props:{stepsObj:{type:Object}}}},946:function(e,t,n){var l=n(947);"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);n(43)("62877a53",l,!1,{})},947:function(e,t,n){t=e.exports=n(42)(!1),t.push([e.i,"\n.stepBox {\n  padding: 20px;\n  border-bottom: 1px dashed #E8E8E8;\n  margin-bottom: 10px;\n}\n.bgcolor {\n  background-color: white;\n}\n.ivu-steps-item.ivu-steps-status-wait .ivu-steps-title {\n  color: #AAA;\n}\n",""])},948:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stepBox bgcolor"},[n("Steps",{attrs:{current:e.stepsObj.current,size:"small"}},e._l(e.stepsObj.data,function(e,t){return n("Step",{key:e,attrs:{title:e}})}))],1)},i=[];l._withStripped=!0;var a={render:l,staticRenderFns:i};t.default=a}});