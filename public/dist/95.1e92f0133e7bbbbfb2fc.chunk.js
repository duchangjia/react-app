webpackJsonp([95,274],{1733:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(241),o=n(r),s=a(146),i=n(s),l=a(242),u=n(l),c=a(603),d=n(c),m=a(898),p=a(239);e.default={components:{defaultHr:d.default},data:function(){var t=this,e=this;return{query:{startTime:"",endTime:"",storeName:"",costNo:"",status:"",page:1,row:10},moreThanStartDate:{disabledDate:function(t){return t&&t.valueOf()<e.query.startTime}},tableData:[],tableColumns:[{title:"序号",align:"center",width:62,render:function(t,e){return"小计"==e.row.xuhao||"总计"==e.row.xuhao?t("div",e.row.xuhao):t("div",e.index+1)}},{title:"开票名称",align:"center",key:"openTicketName",width:100,render:function(t,e){return t("div",e.row.openTicketName)}},{title:"门店名称",key:"storeName",align:"center",width:100},{title:"费用单号",key:"costNo",align:"center",width:200},{title:"促销编码",key:"promotionCode",align:"center",width:120},{title:"费用项目",align:"center",key:"costItem",width:100},{title:"费用折扣金额",align:"center",key:"costAmmout",width:120,render:function(t,e){return t("div",e.row.costAmmout?Number(e.row.costAmmout).toFixed(2):"0.00")}},{title:"核销日期",align:"center",key:"verificationTime",width:120,render:function(t,e){var a="",n=e.row.verificationTime;return n&&null!==n&&(a=(0,m.formatDate)(new Date(parseInt(n)),"yyyy-MM-DD")),t("span",a)}},{title:"业务员",align:"center",key:"empName",width:100},{title:"状态",align:"center",key:"status",width:120,render:function(t,e){return"小计"==e.row.xuhao||"总计"==e.row.xuhao?t("div",""):t("div",2==e.row.status?"已核销":"未核销")}},{title:"备注",align:"center",ellipsis:!0,key:"memo",width:100,render:function(t,e){var a="";if(null!==e.row.memo&&void 0!==e.row.memo&&""!==e.row.memo)return a=e.row.memo.length>5?e.row.memo.substring(0,5)+"...":e.row.memo,t("Tooltip",{props:{placement:"top",offset:0,transfer:!0}},[a,t("div",{slot:"content",style:{whiteSpace:"normal",wordBreak:"break-all"}},e.row.memo)])}},{title:"操作",fixed:"right",width:130,align:"center",render:function(e,a){var n=[e("Button",{props:{size:"small",disable:!0},style:{marginRight:"5px"},on:{click:function(){t.$Modal.error({title:"提示",content:"只允许在未核销状态下修改"})}}},"修改")];return"小计"==a.row.xuhao||"总计"==a.row.xuhao?e("div",""):(2!=a.row.status&&(n=[e("Button",{props:{type:"primary",size:"small"},attrs:{disabled:""!=a.row.promotionCode&&null!=a.row.promotionCode},style:{marginRight:"5px"},on:{click:function(){t.$router.push({name:"cost-manage-edit",query:{id:a.row.id}})}}},"修改"),e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.deleteCostOrderBtnClick(a.row)}}},"删除")]),e("div",n))}}],total:0,sumCostAmmout:0,loading:!1}},mounted:function(){this.queryData()},computed:{costAmmoutSumUp:function(){var t=0;return this.tableData.map(function(e){e.costAmmout&&null!==e.costAmmout&&(t+=parseFloat(e.costAmmout,10))}),t}},methods:{handleSearchBtnClick:function(){this.query.page=1,this.queryData()},formatDate:m.formatDate,queryData:function(){function t(){return e.apply(this,arguments)}var e=(0,u.default)(o.default.mark(function t(){var e,a,n,r,s,l,u,c=this;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this,a=(0,i.default)({},this.query),a.startTime=a.startTime?(0,m.formatDate)(a.startTime,"yyyy-MM-DD"):"",a.endTime=a.endTime?(0,m.formatDate)(a.endTime,"yyyy-MM-DD"):"",delete a.row;for(n in a)0!==a[n]&&""==a[n]&&delete a[n];return this.tableData=[],t.prev=7,this.loading=!0,t.next=11,this.$ajax.post(e.$util.apiConfig.traderManage.flowManage.costManage.list,p.stringify(a));case 11:r=t.sent,s=r.data,s.pager.records instanceof Array&&(this.tableData=s.pager.records.concat()),l=0;for(u in this.tableData)this.tableData[u].costAmmout||(this.tableData[u].costAmmout=0),l+=Number(this.tableData[u].costAmmout);this.tableData.push({costAmmout:l,xuhao:"小计"}),this.tableData.push({costAmmout:s.sumCostAmmout,xuhao:"总计"}),isNaN(s.pager.totalCount)||(this.total=s.pager.totalCount),isNaN(s.sumCostAmmout)||(this.sumCostAmmout=s.sumCostAmmout),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(7),this.$Message.error("费用单列表获取失败");case 25:setTimeout(function(t){c.loading=!1},500);case 26:case"end":return t.stop()}},t,this,[[7,22]])}));return t}(),deleteCostOrderBtnClick:function(t){var e=this,a=t.id,n=t.costNo;this.$Modal.confirm({title:"删除",content:"确定要删除此费用单吗？费用单号："+(null==n?"未知":n),onOk:function(t){return e.deleteCostOrder(a)}})},deleteCostOrder:function(){function t(t){return e.apply(this,arguments)}var e=(0,u.default)(o.default.mark(function t(e){var a,n,r,s=this;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=this,t.prev=1,t.next=4,this.$ajax({url:a.$util.apiConfig.traderManage.flowManage.costManage.delete,method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},data:e});case 4:n=t.sent,r=n.data,r.success?(this.$Message.success("费用单删除成功"),this.queryData()):setTimeout(function(t){return s.$Modal.error({content:"费用单删除失败"})},500),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error(t.t0),setTimeout(function(t){return s.$Modal.error({content:"费用单删除失败"})},500);case 13:case"end":return t.stop()}},t,this,[[1,9]])}));return t}()}}},2503:function(t,e,a){var n=a(2504);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(43)("19aa8dd5",n,!1,{})},2504:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.search-btn[data-v-1880f118] {\n  float: right;\n  margin-right: 20px;\n}\n.info-pannel[data-v-1880f118] {\n  overflow: hidden;\n  padding: 0 20px;\n}\n.info-pannel .add-new[data-v-1880f118] {\n  margin-bottom: 15px;\n}\n.info-pannel .custom-page[data-v-1880f118] {\n  float: right;\n  margin-top: 15px;\n}\n.custom-table[data-v-1880f118] {\n  width: 100%;\n  text-align: center;\n  line-height: 48px;\n  border: 1px solid #ddd;\n}\n.custom-table th[data-v-1880f118] {\n  color: #666;\n  background-color: #daf1fc;\n  font-weight: normal;\n  font-size: 14px;\n  line-height: 40px;\n}\n.custom-table tr th[data-v-1880f118],\n.custom-table tr td[data-v-1880f118] {\n  border-bottom: 1px solid #ddd;\n  box-sizing: border-box;\n  padding: 0 5px;\n}\n.custom-table tr td[data-v-1880f118] {\n  font-size: 12px;\n}\n.custom-table tbody tr[data-v-1880f118]:nth-of-type(2n) {\n  background: #f5f5f5;\n}\n.custom-table tbody tr:last-of-type td[data-v-1880f118] {\n  border-bottom: none;\n}\n",""])},2505:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",[a("Form",{attrs:{"label-width":80}},[a("Row",[a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"开始时间"}},[a("DatePicker",{attrs:{type:"date",placeholder:"开始时间"},model:{value:t.query.startTime,callback:function(e){t.$set(t.query,"startTime",e)},expression:"query.startTime"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"截止时间"}},[a("DatePicker",{attrs:{type:"date",options:t.moreThanStartDate,placeholder:"截止时间"},model:{value:t.query.endTime,callback:function(e){t.$set(t.query,"endTime",e)},expression:"query.endTime"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"门店名称"}},[a("Input",{model:{value:t.query.storeName,callback:function(e){t.$set(t.query,"storeName",e)},expression:"query.storeName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"费用单号"}},[a("Input",{model:{value:t.query.costNo,callback:function(e){t.$set(t.query,"costNo",e)},expression:"query.costNo"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"状态选择"}},[a("Select",{attrs:{placement:"bottom"},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),a("Option",{attrs:{value:0}},[t._v("未核销")]),t._v(" "),a("Option",{attrs:{value:2}},[t._v("已核销")])],1)],1)],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:function(e){t.handleSearchBtnClick()}}},[t._v("查询")])],1)],1)],1),t._v(" "),a("div",{staticClass:"info-pannel",staticStyle:{position:"relative"}},[a("Spin",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{size:"large",fix:""}}),t._v(" "),a("router-link",{attrs:{to:{name:"cost-manage-edit"},tag:"span"}},[a("Button",{staticClass:"add-new"},[t._v("增加明细")])],1),t._v(" "),a("Row",[a("Table",{attrs:{columns:t.tableColumns,data:t.tableData,loading:t.loading}})],1),t._v(" "),a("Row",{staticClass:"mt20"},[a("Page",{staticStyle:{float:"right"},attrs:{total:t.total,"page-size":10,current:t.query.page,"show-total":"","show-elevator":""},on:{"update:current":function(e){t.$set(t.query,"page",e)},"on-change":t.queryData}})],1)],1)],1)},r=[];n._withStripped=!0;var o={render:n,staticRenderFns:r};e.default=o},603:function(t,e,a){"use strict";function n(t){u||a(964)}Object.defineProperty(e,"__esModule",{value:!0});var r=a(939),o=a.n(r);for(var s in r)"default"!==s&&function(t){a.d(e,t,function(){return r[t]})}(s);var i=a(966),l=a.n(i),u=!1,c=a(13),d=n,m=c(o.a,l.a,!1,d,"data-v-eb39e066",null);m.options.__file="src/views/my-components/default-hr/default-hr.vue",e.default=m.exports},848:function(t,e,a){"use strict";function n(t){u||a(2503)}Object.defineProperty(e,"__esModule",{value:!0});var r=a(1733),o=a.n(r);for(var s in r)"default"!==s&&function(t){a.d(e,t,function(){return r[t]})}(s);var i=a(2505),l=a.n(i),u=!1,c=a(13),d=n,m=c(o.a,l.a,!1,d,"data-v-1880f118",null);m.options.__file="src/views/trader-manage/flow-manage/cost-manage/list.vue",e.default=m.exports},898:function(t,e,a){"use strict";function n(t,e){if(!e)var e="yyyy-MM-DD hh:mm:ss";var a={"M+":t.getMonth()+1,"D+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in a)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return e}function r(t,e){if(!e)var e="yyyy-MM-dd";(t=Number(t))<1e10&&(t*=1e3);var a=new Date(t),n={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in n)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return e}Object.defineProperty(e,"__esModule",{value:!0}),e.formatDate=n,e.timestampToDay=r},939:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={}},964:function(t,e,a){var n=a(965);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(43)("63be8b28",n,!1,{})},965:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.default-hr[data-v-eb39e066] {\n  width: 100%;\n  height: 1px;\n  border: none;\n  border-top: 1px dashed #aaa;\n  margin-bottom: 20px;\n}\n",""])},966:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement;return(t._self._c||e)("hr",{staticClass:"default-hr"})},r=[];n._withStripped=!0;var o={render:n,staticRenderFns:r};e.default=o}});