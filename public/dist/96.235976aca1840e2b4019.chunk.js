webpackJsonp([96,274],{1715:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(241),s=r(n),i=a(146),o=r(i),l=a(242),u=r(l),c=a(603),d=r(c),p=a(898),v=a(239);e.default={components:{DefaultHr:d.default},data:function(){var t=this;return{query:{reqDeliveryCarBillNo:"",startTimeStr:"",endTimeStr:"",pickStatus:"",page:1,row:10},apiGroup:this.$util.apiConfig.stockManage.warehouseOut.pickOrder,total:0,loading:!1,tableData:[],tableColumns:[{title:"序号",width:75,align:"center",render:function(e,a){return e("span",(t.query.page-1)*t.query.row+a.index+1)}},{title:"拼车单号",align:"center",key:"deliveryCarBillNo"},{title:"创建时间",align:"center",key:"createTime"},{title:"总重量",align:"center",key:"totalWeight"},{title:"总体积",align:"center",key:"totalVolume"},{title:"总金额",align:"center",key:"totalPrice"},{title:"车牌号",align:"center",key:"carPlateNo"},{title:"司机姓名",align:"center",key:"driverName"},{title:"联系方式",align:"center",key:"driverContact"},{title:"状态",align:"center",key:"pickStatus"},{title:"操作",align:"center",width:75,render:function(e,a){return[].push(e("Button",{props:{type:"primary",size:"small",disabled:"待拣货"!=a.row.pickStatus},on:{click:function(e){return t.showDetail(a.row)}}},"出库")),e("div","")}}],detailData:[],detailVisible:!1,detailInfo:{},exportLimitText:0,exportLimit:!1,exportLimitTimer:null}},mounted:function(){this.refreshExportLimit(),this.queryData()},beforeDestroy:function(){clearTimeout(this.exportLimitTimer)},methods:{nowDateString:function(){return(0,p.formatDate)(new Date,"yyyy-MM-DD")},refreshExportLimit:function(){var t=this;clearTimeout(this.exportLimitTimer);var e=localStorage["warehouse-out-pick-order-export-timeset-limit"],a=(new Date).getTime();a<=e?(this.exportLimit=!0,this.exportLimitText=Math.ceil((parseInt(e,10)-a)/1e3),this.exportLimitTimer=setTimeout(function(e){return t.refreshExportLimit()},1e3)):this.exportLimit=!1},handleExportBtnClick:function(){var t=this;this.$Modal.confirm({title:"导出",content:"<p>是否确认导出 明细（最大5000记录）</p>",onOk:function(){var e=localStorage["warehouse-out-pick-order-export-timeset-limit"];if(e&&(new Date).getTime()<=e)return void t.$Message.error("时间未解锁");localStorage["warehouse-out-pick-order-export-timeset-limit"]=(new Date).getTime()+6e4,document.getElementById("form-export").method="post",document.getElementById("form-export").action=t.$util.baseUrl+"/orderCenter/pickOrder/export.xls",document.getElementById("form-export").submit(),t.refreshExportLimit()}})},queryData:function(){function t(){return e.apply(this,arguments)}var e=(0,u.default)(s.default.mark(function t(){var e,a,r,n,i;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=(0,o.default)({},this.query),this.tableData=[],this.loading=!0,a="",t.prev=4,t.next=7,this.$ajax.post(this.apiGroup.list,v.stringify(e));case 7:r=t.sent,n=r.data,200==n.code?(i=n.result.pager,i.records instanceof Array&&(this.tableData=i.records),this.total=i.totalCount):this.$Message.error("拣货单列表获取失败"),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),a="捡配单列表获取失败";case 15:a&&this.$Message.error(a),this.loading=!1;case 17:case"end":return t.stop()}},t,this,[[4,12]])}));return t}(),handleQueryBtnClick:function(){this.query.page=1,this.queryData()},handleResetBtnClick:function(){this.query={reqDeliveryCarBillNo:"",startTimeStr:"",endTimeStr:"",pickStatus:"",page:1,row:10},this.queryData()},showDetail:function(){function t(t){return e.apply(this,arguments)}var e=(0,u.default)(s.default.mark(function t(e){var a,r,n,i=this;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.detailVisible=!0,this.detailInfo=e,a="",t.prev=3,t.next=6,this.$ajax(this.apiGroup.outboundDetail,{params:{deliveryCarBillNo:e.deliveryCarBillNo,_:(new Date).getTime()}});case 6:r=t.sent,n=r.data,200==n.code?n.result instanceof Array&&(this.detailData=n.result.map(function(t){var e=(0,o.default)({},t,{time:i.nowDateString()});return e.productList instanceof Array&&e.pickStatus<110&&(e.productList=e.productList.map(function(t){return(0,o.default)({},t,{sendCarNum:t.pickCarNum,sendEaNum:t.pickEaNum})})),e})):a="出库信息获取失败",t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),console.error(t.t0),a="出库信息获取失败";case 15:a&&this.$Message.error(a);case 16:case"end":return t.stop()}},t,this,[[3,11]])}));return t}(),checkNum:function(t,e){var a=e.replace("send","pick"),r=parseInt(t[a]),n=t[e],s=parseInt(n);if(isNaN(s)||s<0||s>r)return void setTimeout(function(a){return t[e]=r});s.toString().length!=n.length&&setTimeout(function(a){return t[e]=s})},outBound:function(){function t(){return e.apply(this,arguments)}var e=(0,u.default)(s.default.mark(function t(){var e,a,r,n,i,o=this;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=[],this.detailData.forEach(function(t){t.productList.forEach(function(t){e.push({num:t.num,orderEntryNo:t.orderEntryNo,orderNo:t.orderNo,sendCarNum:t.sendCarNum,sendEaNum:t.sendEaNum,transformRule:t.transformRule})})}),a={billList:e,deliveryCarBillNo:this.detailInfo.deliveryCarBillNo},r="",t.prev=4,t.next=7,this.$ajax.post(this.apiGroup.comfirmOutbound,a);case 7:if(n=t.sent,i=n.data,!i.success){t.next=14;break}return this.$Modal.success({content:i.message,onOk:function(t){o.detailVisible=!1,o.queryData()}}),t.abrupt("return");case 14:r=i.message;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),console.error(t.t0),r="出库请求发送失败";case 21:r&&this.$Modal.error({content:r});case 22:case"end":return t.stop()}},t,this,[[4,17]])}));return t}()}}},2437:function(t,e,a){var r=a(2438);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(43)("02ae00b8",r,!1,{})},2438:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.query-btn[data-v-11dd1156] {\n  margin-left: 80px;\n  margin-right: 20px;\n}\n.custom-hr[data-v-11dd1156] {\n  margin-top: 15px;\n}\n.custom-page[data-v-11dd1156] {\n  margin-top: 15px;\n  float: right;\n}\n.custom-h3[data-v-11dd1156] {\n  margin: 15px 0;\n}\n.custom-h3[data-v-11dd1156]:first-of-type {\n  margin-top: 0;\n}\n.custom-row[data-v-11dd1156] {\n  margin-bottom: 10px;\n  font-size: 14px;\n}\n.custom-hr[data-v-11dd1156] {\n  margin: 30px 0!important;\n}\n.custom-table[data-v-11dd1156] {\n  width: 100%;\n  text-align: center;\n  line-height: 48px;\n  border: 1px solid #ddd;\n}\n.custom-table th[data-v-11dd1156] {\n  color: #666;\n  background-color: #daf1fc;\n  font-weight: normal;\n  font-size: 14px;\n  line-height: 40px;\n}\n.custom-table tr th[data-v-11dd1156],\n.custom-table tr td[data-v-11dd1156] {\n  border-bottom: 1px solid #ddd;\n  box-sizing: border-box;\n  padding: 0 5px;\n}\n.custom-table tr td[data-v-11dd1156] {\n  font-size: 12px;\n}\n.custom-table tbody tr[data-v-11dd1156]:nth-of-type(2n) {\n  background: #f5f5f5;\n}\n.custom-table tbody tr:last-of-type td[data-v-11dd1156] {\n  border-bottom: none;\n}\n.wd-80[data-v-11dd1156] {\n  width: 80px;\n  text-align: center;\n}\n",""])},2439:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",[a("Form",{attrs:{"label-width":90,id:"form-export"}},[a("input",{staticStyle:{display:"none"},attrs:{type:"text",name:"page"},domProps:{value:t.query.page}}),t._v(" "),a("Row",[a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"拼车单号"}},[a("Input",{attrs:{name:"reqDeliveryCarBillNo",clearable:""},model:{value:t.query.reqDeliveryCarBillNo,callback:function(e){t.$set(t.query,"reqDeliveryCarBillNo",e)},expression:"query.reqDeliveryCarBillNo"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"起始日期"}},[a("DatePicker",{attrs:{value:"query.startTimeStr",name:"startTimeStr"},on:{"on-change":function(e){return t.query.startTimeStr=e}}})],1)],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"终止日期"}},[a("DatePicker",{attrs:{value:"query.endTimeStr",name:"endTimeStr"},on:{"on-change":function(e){return t.query.endTimeStr=e}}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"司机名称"}},[a("Input",{attrs:{name:"driverName",clearable:""},model:{value:t.query.driverName,callback:function(e){t.$set(t.query,"driverName",e)},expression:"query.driverName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"6"}},[a("FormItem",{attrs:{label:"状态"}},[a("Select",{attrs:{name:"pickStatus"},model:{value:t.query.pickStatus,callback:function(e){t.$set(t.query,"pickStatus",e)},expression:"query.pickStatus"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),a("Option",{attrs:{value:100}},[t._v("待拣货")]),t._v(" "),a("Option",{attrs:{value:110}},[t._v("已出库")]),t._v(" "),a("Option",{attrs:{value:120}},[t._v("已取消")])],1)],1)],1)],1),t._v(" "),a("Row",[a("Button",{staticClass:"query-btn",attrs:{type:"primary"},on:{click:t.handleQueryBtnClick}},[t._v("查询")]),t._v(" "),a("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",disabled:t.exportLimit},on:{click:function(e){t.handleExportBtnClick()}}},[a("span",[t._v("导出")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.exportLimit,expression:"exportLimit"}]},[t._v("(禁用"+t._s(t.exportLimitText)+"秒)")])]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.handleResetBtnClick}},[t._v("重置")])],1)],1),t._v(" "),a("DefaultHr",{staticClass:"custom-hr"}),t._v(" "),a("div",[a("Table",{attrs:{data:t.tableData,columns:t.tableColumns,loading:t.loading}})],1),t._v(" "),a("Row",[a("Page",{staticClass:"custom-page",attrs:{"page-size":t.query.row,current:t.query.page,"show-elevator":"","show-total":"",total:t.total},on:{"update:current":function(e){t.$set(t.query,"page",e)},"on-change":t.queryData}})],1),t._v(" "),a("Modal",{attrs:{width:1200,title:"出库 发货单"},model:{value:t.detailVisible,callback:function(e){t.detailVisible=e},expression:"detailVisible"}},[t._l(t.detailData,function(e,r){return a("div",{key:r},[a("Row",{staticClass:"custom-row",attrs:{gutter:16}},[a("Col",{attrs:{span:"4"}},[a("span",[t._v("日期:")]),t._v(" "),a("span",[t._v(t._s(e.time))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("发货单号:")]),t._v(" "),a("span",[t._v(t._s(e.orderNo))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("关联销售单号:")]),t._v(" "),a("span",[t._v(t._s(e.originalOrderNo))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("拼车单号:")]),t._v(" "),a("span",[t._v(t._s(e.deliveryCarBillNo))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("车牌:")]),t._v(" "),a("span",[t._v(t._s(e.carPlateNo))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("司机:")]),t._v(" "),a("span",[t._v(t._s(e.driverName))])])],1),t._v(" "),a("Row",{staticClass:"custom-row",attrs:{gutter:16}},[a("Col",{attrs:{span:"4"}},[a("span",[t._v("联系方式:")]),t._v(" "),a("span",[t._v(t._s(e.driverContact))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("发货仓库:")]),t._v(" "),a("span",[t._v(t._s(e.warehouseCode))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("发货仓库名称:")]),t._v(" "),a("span",[t._v(t._s(e.warehouseName))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("装车顺序:")]),t._v(" "),a("span",[t._v(t._s(e.shipSequence))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("门店:")]),t._v(" "),a("span",[t._v(t._s(e.storeCode))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("门店描述:")]),t._v(" "),a("span",[t._v(t._s(e.storeName))])])],1),t._v(" "),a("Row",{staticClass:"custom-row",attrs:{gutter:16}},[a("Col",{attrs:{span:"4"}},[a("span",[t._v("门店联系方式:")]),t._v(" "),a("span",[t._v(t._s(e.storeContact))])]),t._v(" "),a("Col",{attrs:{span:"4"}},[a("span",[t._v("门店地址:")]),t._v(" "),a("span",[t._v(t._s(e.storeAddress))])])],1),t._v(" "),a("table",{staticClass:"custom-table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[a("thead",[a("tr",[a("th",[t._v("序号")]),t._v(" "),a("th",[t._v("条码")]),t._v(" "),a("th",[t._v("商品描述")]),t._v(" "),a("th",[t._v("应发整件数量(CAR)")]),t._v(" "),a("th",[t._v("应发散个数量(EA)")]),t._v(" "),a("th",[t._v("实发整件数量(CAR)")]),t._v(" "),a("th",[t._v("实发散个数量(EA)")])])]),t._v(" "),a("tbody",t._l(e.productList,function(r,n){return a("tr",{key:n},[a("td",[t._v(t._s(n+1))]),t._v(" "),a("td",[t._v(t._s(r.materialCode69))]),t._v(" "),a("td",[t._v(t._s(r.name))]),t._v(" "),a("td",[t._v(t._s(r.pickCarNum))]),t._v(" "),a("td",[t._v(t._s(r.pickEaNum))]),t._v(" "),a("td",[a("Input",{staticClass:"wd-80",attrs:{disabled:parseInt(e.pickStatus)>=110},on:{"on-change":function(e){t.checkNum(r,"sendCarNum")}},model:{value:r.sendCarNum,callback:function(e){t.$set(r,"sendCarNum",e)},expression:"goods.sendCarNum"}})],1),t._v(" "),a("td",[a("Input",{staticClass:"wd-80",attrs:{disabled:parseInt(e.pickStatus)>=110},on:{"on-change":function(e){t.checkNum(r,"sendEaNum")}},model:{value:r.sendEaNum,callback:function(e){t.$set(r,"sendEaNum",e)},expression:"goods.sendEaNum"}})],1)])}))]),t._v(" "),a("DefaultHr",{directives:[{name:"show",rawName:"v-show",value:r!==t.detailData.length-1,expression:"index!==detailData.length-1"}],staticClass:"custom-hr"})],1)}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.outBound()}}},[t._v("确认出库")]),t._v(" "),a("Button",{on:{click:function(e){t.detailVisible=!1}}},[t._v("关闭")])],1)],2)],1)},n=[];r._withStripped=!0;var s={render:r,staticRenderFns:n};e.default=s},603:function(t,e,a){"use strict";function r(t){u||a(964)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(939),s=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);var o=a(966),l=a.n(o),u=!1,c=a(13),d=r,p=c(s.a,l.a,!1,d,"data-v-eb39e066",null);p.options.__file="src/views/my-components/default-hr/default-hr.vue",e.default=p.exports},830:function(t,e,a){"use strict";function r(t){u||a(2437)}Object.defineProperty(e,"__esModule",{value:!0});var n=a(1715),s=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);var o=a(2439),l=a.n(o),u=!1,c=a(13),d=r,p=c(s.a,l.a,!1,d,"data-v-11dd1156",null);p.options.__file="src/views/stock-manage/warehouse-out/pick-order.vue",e.default=p.exports},898:function(t,e,a){"use strict";function r(t,e){if(!e)var e="yyyy-MM-DD hh:mm:ss";var a={"M+":t.getMonth()+1,"D+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in a)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?a[r]:("00"+a[r]).substr((""+a[r]).length)));return e}function n(t,e){if(!e)var e="yyyy-MM-dd";(t=Number(t))<1e10&&(t*=1e3);var a=new Date(t),r={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in r)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?r[n]:("00"+r[n]).substr((""+r[n]).length)));return e}Object.defineProperty(e,"__esModule",{value:!0}),e.formatDate=r,e.timestampToDay=n},939:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={}},964:function(t,e,a){var r=a(965);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(43)("63be8b28",r,!1,{})},965:function(t,e,a){e=t.exports=a(42)(!1),e.push([t.i,"\n.default-hr[data-v-eb39e066] {\n  width: 100%;\n  height: 1px;\n  border: none;\n  border-top: 1px dashed #aaa;\n  margin-bottom: 20px;\n}\n",""])},966:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){var t=this,e=t.$createElement;return(t._self._c||e)("hr",{staticClass:"default-hr"})},n=[];r._withStripped=!0;var s={render:r,staticRenderFns:n};e.default=s}});